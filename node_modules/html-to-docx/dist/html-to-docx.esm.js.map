{"version":3,"file":"html-to-docx.esm.js","sources":["../node_modules/virtual-dom/vnode/version.js","../node_modules/virtual-dom/vnode/is-vnode.js","../node_modules/virtual-dom/vnode/is-widget.js","../node_modules/virtual-dom/vnode/is-thunk.js","../node_modules/virtual-dom/vnode/is-vhook.js","../node_modules/virtual-dom/vnode/vnode.js","../node_modules/virtual-dom/vnode/vtext.js","../node_modules/virtual-dom/vnode/is-vtext.js","../node_modules/rollup-plugin-node-builtins/src/es6/empty.js","../node_modules/rollup-plugin-node-builtins/src/es6/path.js","../node_modules/inherits/inherits_browser.js","../node_modules/rollup-plugin-node-builtins/src/es6/events.js","../node_modules/queue/index.js","../node_modules/image-size/dist/types/bmp.js","../node_modules/image-size/dist/types/ico.js","../node_modules/image-size/dist/types/cur.js","../node_modules/image-size/dist/types/dds.js","../node_modules/image-size/dist/types/gif.js","../node_modules/image-size/dist/types/icns.js","../node_modules/image-size/dist/types/j2c.js","../node_modules/image-size/dist/types/jp2.js","../node_modules/image-size/dist/readUInt.js","../node_modules/image-size/dist/types/jpg.js","../node_modules/image-size/dist/types/ktx.js","../node_modules/image-size/dist/types/png.js","../node_modules/image-size/dist/types/pnm.js","../node_modules/image-size/dist/types/psd.js","../node_modules/image-size/dist/types/svg.js","../node_modules/image-size/dist/types/tiff.js","../node_modules/image-size/dist/types/webp.js","../node_modules/image-size/dist/types.js","../node_modules/image-size/dist/detector.js","../node_modules/image-size/dist/fs.promises.js","../node_modules/image-size/dist/index.js","../src/helpers/namespaces.js","../src/utils/color-conversion.js","../src/utils/unit-conversion.js","../src/helpers/xml-builder.js","../src/helpers/render-document-file.js","../src/schemas/core.js","../src/schemas/document-rels.js","../src/schemas/rels.js","../src/schemas/font-table.js","../src/schemas/settings.js","../src/schemas/web-settings.js","../node_modules/shortid/lib/random/random-from-seed.js","../node_modules/shortid/lib/alphabet.js","../node_modules/shortid/lib/random/random-byte-browser.js","../node_modules/nanoid/format.browser.js","../node_modules/shortid/lib/generate.js","../node_modules/shortid/lib/build.js","../node_modules/shortid/lib/is-valid.js","../node_modules/shortid/lib/index.js","../node_modules/shortid/index.js","../template/document.template.js","../src/docx-document.js","../src/schemas/content-types.js","../src/schemas/styles.js","../src/schemas/theme.js","../src/schemas/numbering.js","../src/schemas/generic-rels.js","../src/html-to-docx.js","../index.js"],"sourcesContent":["module.exports = \"2\"\n","var version = require(\"./version\")\n\nmodule.exports = isVirtualNode\n\nfunction isVirtualNode(x) {\n    return x && x.type === \"VirtualNode\" && x.version === version\n}\n","module.exports = isWidget\n\nfunction isWidget(w) {\n    return w && w.type === \"Widget\"\n}\n","module.exports = isThunk\r\n\r\nfunction isThunk(t) {\r\n    return t && t.type === \"Thunk\"\r\n}\r\n","module.exports = isHook\n\nfunction isHook(hook) {\n    return hook &&\n      (typeof hook.hook === \"function\" && !hook.hasOwnProperty(\"hook\") ||\n       typeof hook.unhook === \"function\" && !hook.hasOwnProperty(\"unhook\"))\n}\n","var version = require(\"./version\")\nvar isVNode = require(\"./is-vnode\")\nvar isWidget = require(\"./is-widget\")\nvar isThunk = require(\"./is-thunk\")\nvar isVHook = require(\"./is-vhook\")\n\nmodule.exports = VirtualNode\n\nvar noProperties = {}\nvar noChildren = []\n\nfunction VirtualNode(tagName, properties, children, key, namespace) {\n    this.tagName = tagName\n    this.properties = properties || noProperties\n    this.children = children || noChildren\n    this.key = key != null ? String(key) : undefined\n    this.namespace = (typeof namespace === \"string\") ? namespace : null\n\n    var count = (children && children.length) || 0\n    var descendants = 0\n    var hasWidgets = false\n    var hasThunks = false\n    var descendantHooks = false\n    var hooks\n\n    for (var propName in properties) {\n        if (properties.hasOwnProperty(propName)) {\n            var property = properties[propName]\n            if (isVHook(property) && property.unhook) {\n                if (!hooks) {\n                    hooks = {}\n                }\n\n                hooks[propName] = property\n            }\n        }\n    }\n\n    for (var i = 0; i < count; i++) {\n        var child = children[i]\n        if (isVNode(child)) {\n            descendants += child.count || 0\n\n            if (!hasWidgets && child.hasWidgets) {\n                hasWidgets = true\n            }\n\n            if (!hasThunks && child.hasThunks) {\n                hasThunks = true\n            }\n\n            if (!descendantHooks && (child.hooks || child.descendantHooks)) {\n                descendantHooks = true\n            }\n        } else if (!hasWidgets && isWidget(child)) {\n            if (typeof child.destroy === \"function\") {\n                hasWidgets = true\n            }\n        } else if (!hasThunks && isThunk(child)) {\n            hasThunks = true;\n        }\n    }\n\n    this.count = count + descendants\n    this.hasWidgets = hasWidgets\n    this.hasThunks = hasThunks\n    this.hooks = hooks\n    this.descendantHooks = descendantHooks\n}\n\nVirtualNode.prototype.version = version\nVirtualNode.prototype.type = \"VirtualNode\"\n","var version = require(\"./version\")\n\nmodule.exports = VirtualText\n\nfunction VirtualText(text) {\n    this.text = String(text)\n}\n\nVirtualText.prototype.version = version\nVirtualText.prototype.type = \"VirtualText\"\n","var version = require(\"./version\")\n\nmodule.exports = isVirtualText\n\nfunction isVirtualText(x) {\n    return x && x.type === \"VirtualText\" && x.version === version\n}\n","export default {};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// resolves . and .. elements in a path array with directory names there\n// must be no slashes, empty elements, or device names (c:\\) in the array\n// (so also no leading and trailing slashes - it does not distinguish\n// relative and absolute paths)\nfunction normalizeArray(parts, allowAboveRoot) {\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = parts.length - 1; i >= 0; i--) {\n    var last = parts[i];\n    if (last === '.') {\n      parts.splice(i, 1);\n    } else if (last === '..') {\n      parts.splice(i, 1);\n      up++;\n    } else if (up) {\n      parts.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (allowAboveRoot) {\n    for (; up--; up) {\n      parts.unshift('..');\n    }\n  }\n\n  return parts;\n}\n\n// Split a filename into [root, dir, basename, ext], unix version\n// 'root' is just a slash, or nothing.\nvar splitPathRe =\n    /^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/;\nvar splitPath = function(filename) {\n  return splitPathRe.exec(filename).slice(1);\n};\n\n// path.resolve([from ...], to)\n// posix version\nexport function resolve() {\n  var resolvedPath = '',\n      resolvedAbsolute = false;\n\n  for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    var path = (i >= 0) ? arguments[i] : '/';\n\n    // Skip empty and invalid entries\n    if (typeof path !== 'string') {\n      throw new TypeError('Arguments to path.resolve must be strings');\n    } else if (!path) {\n      continue;\n    }\n\n    resolvedPath = path + '/' + resolvedPath;\n    resolvedAbsolute = path.charAt(0) === '/';\n  }\n\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n\n  // Normalize the path\n  resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {\n    return !!p;\n  }), !resolvedAbsolute).join('/');\n\n  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';\n};\n\n// path.normalize(path)\n// posix version\nexport function normalize(path) {\n  var isPathAbsolute = isAbsolute(path),\n      trailingSlash = substr(path, -1) === '/';\n\n  // Normalize the path\n  path = normalizeArray(filter(path.split('/'), function(p) {\n    return !!p;\n  }), !isPathAbsolute).join('/');\n\n  if (!path && !isPathAbsolute) {\n    path = '.';\n  }\n  if (path && trailingSlash) {\n    path += '/';\n  }\n\n  return (isPathAbsolute ? '/' : '') + path;\n};\n\n// posix version\nexport function isAbsolute(path) {\n  return path.charAt(0) === '/';\n}\n\n// posix version\nexport function join() {\n  var paths = Array.prototype.slice.call(arguments, 0);\n  return normalize(filter(paths, function(p, index) {\n    if (typeof p !== 'string') {\n      throw new TypeError('Arguments to path.join must be strings');\n    }\n    return p;\n  }).join('/'));\n}\n\n\n// path.relative(from, to)\n// posix version\nexport function relative(from, to) {\n  from = resolve(from).substr(1);\n  to = resolve(to).substr(1);\n\n  function trim(arr) {\n    var start = 0;\n    for (; start < arr.length; start++) {\n      if (arr[start] !== '') break;\n    }\n\n    var end = arr.length - 1;\n    for (; end >= 0; end--) {\n      if (arr[end] !== '') break;\n    }\n\n    if (start > end) return [];\n    return arr.slice(start, end - start + 1);\n  }\n\n  var fromParts = trim(from.split('/'));\n  var toParts = trim(to.split('/'));\n\n  var length = Math.min(fromParts.length, toParts.length);\n  var samePartsLength = length;\n  for (var i = 0; i < length; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      samePartsLength = i;\n      break;\n    }\n  }\n\n  var outputParts = [];\n  for (var i = samePartsLength; i < fromParts.length; i++) {\n    outputParts.push('..');\n  }\n\n  outputParts = outputParts.concat(toParts.slice(samePartsLength));\n\n  return outputParts.join('/');\n}\n\nexport var sep = '/';\nexport var delimiter = ':';\n\nexport function dirname(path) {\n  var result = splitPath(path),\n      root = result[0],\n      dir = result[1];\n\n  if (!root && !dir) {\n    // No dirname whatsoever\n    return '.';\n  }\n\n  if (dir) {\n    // It has a dirname, strip trailing slash\n    dir = dir.substr(0, dir.length - 1);\n  }\n\n  return root + dir;\n}\n\nexport function basename(path, ext) {\n  var f = splitPath(path)[2];\n  // TODO: make this comparison case-insensitive on windows?\n  if (ext && f.substr(-1 * ext.length) === ext) {\n    f = f.substr(0, f.length - ext.length);\n  }\n  return f;\n}\n\n\nexport function extname(path) {\n  return splitPath(path)[3];\n}\nexport default {\n  extname: extname,\n  basename: basename,\n  dirname: dirname,\n  sep: sep,\n  delimiter: delimiter,\n  relative: relative,\n  join: join,\n  isAbsolute: isAbsolute,\n  normalize: normalize,\n  resolve: resolve\n};\nfunction filter (xs, f) {\n    if (xs.filter) return xs.filter(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        if (f(xs[i], i, xs)) res.push(xs[i]);\n    }\n    return res;\n}\n\n// String.prototype.substr - negative index don't work in IE8\nvar substr = 'ab'.substr(-1) === 'b' ?\n    function (str, start, len) { return str.substr(start, len) } :\n    function (str, start, len) {\n        if (start < 0) start = str.length + start;\n        return str.substr(start, len);\n    }\n;\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      ctor.prototype = Object.create(superCtor.prototype, {\n        constructor: {\n          value: ctor,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      })\n    }\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      var TempCtor = function () {}\n      TempCtor.prototype = superCtor.prototype\n      ctor.prototype = new TempCtor()\n      ctor.prototype.constructor = ctor\n    }\n  }\n}\n","'use strict';\n\nvar domain;\n\n// This constructor is used to store event handlers. Instantiating this is\n// faster than explicitly calling `Object.create(null)` to get a \"clean\" empty\n// object (tested with v8 v4.9).\nfunction EventHandlers() {}\nEventHandlers.prototype = Object.create(null);\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nexport default EventEmitter;\nexport {EventEmitter};\n\n// nodejs oddity\n// require('events') === require('events').EventEmitter\nEventEmitter.EventEmitter = EventEmitter\n\nEventEmitter.usingDomains = false;\n\nEventEmitter.prototype.domain = undefined;\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\nEventEmitter.init = function() {\n  this.domain = null;\n  if (EventEmitter.usingDomains) {\n    // if there is an active domain, then attach to it.\n    if (domain.active && !(this instanceof domain.Domain)) {\n      this.domain = domain.active;\n    }\n  }\n\n  if (!this._events || this._events === Object.getPrototypeOf(this)._events) {\n    this._events = new EventHandlers();\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || isNaN(n))\n    throw new TypeError('\"n\" argument must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\n// These standalone emit* functions are used to optimize calling of event\n// handlers for fast cases because emit() itself often has a variable number of\n// arguments and can be deoptimized because of that. These functions always have\n// the same number of arguments and thus do not get deoptimized, so the code\n// inside them can execute faster.\nfunction emitNone(handler, isFn, self) {\n  if (isFn)\n    handler.call(self);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self);\n  }\n}\nfunction emitOne(handler, isFn, self, arg1) {\n  if (isFn)\n    handler.call(self, arg1);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1);\n  }\n}\nfunction emitTwo(handler, isFn, self, arg1, arg2) {\n  if (isFn)\n    handler.call(self, arg1, arg2);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1, arg2);\n  }\n}\nfunction emitThree(handler, isFn, self, arg1, arg2, arg3) {\n  if (isFn)\n    handler.call(self, arg1, arg2, arg3);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1, arg2, arg3);\n  }\n}\n\nfunction emitMany(handler, isFn, self, args) {\n  if (isFn)\n    handler.apply(self, args);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].apply(self, args);\n  }\n}\n\nEventEmitter.prototype.emit = function emit(type) {\n  var er, handler, len, args, i, events, domain;\n  var needDomainExit = false;\n  var doError = (type === 'error');\n\n  events = this._events;\n  if (events)\n    doError = (doError && events.error == null);\n  else if (!doError)\n    return false;\n\n  domain = this.domain;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    er = arguments[1];\n    if (domain) {\n      if (!er)\n        er = new Error('Uncaught, unspecified \"error\" event');\n      er.domainEmitter = this;\n      er.domain = domain;\n      er.domainThrown = false;\n      domain.emit('error', er);\n    } else if (er instanceof Error) {\n      throw er; // Unhandled 'error' event\n    } else {\n      // At least give some kind of context to the user\n      var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n      err.context = er;\n      throw err;\n    }\n    return false;\n  }\n\n  handler = events[type];\n\n  if (!handler)\n    return false;\n\n  var isFn = typeof handler === 'function';\n  len = arguments.length;\n  switch (len) {\n    // fast cases\n    case 1:\n      emitNone(handler, isFn, this);\n      break;\n    case 2:\n      emitOne(handler, isFn, this, arguments[1]);\n      break;\n    case 3:\n      emitTwo(handler, isFn, this, arguments[1], arguments[2]);\n      break;\n    case 4:\n      emitThree(handler, isFn, this, arguments[1], arguments[2], arguments[3]);\n      break;\n    // slower\n    default:\n      args = new Array(len - 1);\n      for (i = 1; i < len; i++)\n        args[i - 1] = arguments[i];\n      emitMany(handler, isFn, this, args);\n  }\n\n  if (needDomainExit)\n    domain.exit();\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function')\n    throw new TypeError('\"listener\" argument must be a function');\n\n  events = target._events;\n  if (!events) {\n    events = target._events = new EventHandlers();\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (!existing) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] = prepend ? [listener, existing] :\n                                          [existing, listener];\n    } else {\n      // If we've already got an array, just append.\n      if (prepend) {\n        existing.unshift(listener);\n      } else {\n        existing.push(listener);\n      }\n    }\n\n    // Check for listener leak\n    if (!existing.warned) {\n      m = $getMaxListeners(target);\n      if (m && m > 0 && existing.length > m) {\n        existing.warned = true;\n        var w = new Error('Possible EventEmitter memory leak detected. ' +\n                            existing.length + ' ' + type + ' listeners added. ' +\n                            'Use emitter.setMaxListeners() to increase limit');\n        w.name = 'MaxListenersExceededWarning';\n        w.emitter = target;\n        w.type = type;\n        w.count = existing.length;\n        emitWarning(w);\n      }\n    }\n  }\n\n  return target;\n}\nfunction emitWarning(e) {\n  typeof console.warn === 'function' ? console.warn(e) : console.log(e);\n}\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction _onceWrap(target, type, listener) {\n  var fired = false;\n  function g() {\n    target.removeListener(type, g);\n    if (!fired) {\n      fired = true;\n      listener.apply(target, arguments);\n    }\n  }\n  g.listener = listener;\n  return g;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function')\n    throw new TypeError('\"listener\" argument must be a function');\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function')\n        throw new TypeError('\"listener\" argument must be a function');\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function')\n        throw new TypeError('\"listener\" argument must be a function');\n\n      events = this._events;\n      if (!events)\n        return this;\n\n      list = events[type];\n      if (!list)\n        return this;\n\n      if (list === listener || (list.listener && list.listener === listener)) {\n        if (--this._eventsCount === 0)\n          this._events = new EventHandlers();\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length; i-- > 0;) {\n          if (list[i] === listener ||\n              (list[i].listener && list[i].listener === listener)) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (list.length === 1) {\n          list[0] = undefined;\n          if (--this._eventsCount === 0) {\n            this._events = new EventHandlers();\n            return this;\n          } else {\n            delete events[type];\n          }\n        } else {\n          spliceOne(list, position);\n        }\n\n        if (events.removeListener)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events;\n\n      events = this._events;\n      if (!events)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (!events.removeListener) {\n        if (arguments.length === 0) {\n          this._events = new EventHandlers();\n          this._eventsCount = 0;\n        } else if (events[type]) {\n          if (--this._eventsCount === 0)\n            this._events = new EventHandlers();\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        for (var i = 0, key; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = new EventHandlers();\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners) {\n        // LIFO order\n        do {\n          this.removeListener(type, listeners[listeners.length - 1]);\n        } while (listeners[0]);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  var evlistener;\n  var ret;\n  var events = this._events;\n\n  if (!events)\n    ret = [];\n  else {\n    evlistener = events[type];\n    if (!evlistener)\n      ret = [];\n    else if (typeof evlistener === 'function')\n      ret = [evlistener.listener || evlistener];\n    else\n      ret = unwrapListeners(evlistener);\n  }\n\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? Reflect.ownKeys(this._events) : [];\n};\n\n// About 1.5x faster than the two-arg version of Array#splice().\nfunction spliceOne(list, index) {\n  for (var i = index, k = i + 1, n = list.length; k < n; i += 1, k += 1)\n    list[i] = list[k];\n  list.pop();\n}\n\nfunction arrayClone(arr, i) {\n  var copy = new Array(i);\n  while (i--)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","var inherits = require('inherits')\nvar EventEmitter = require('events').EventEmitter\n\nmodule.exports = Queue\nmodule.exports.default = Queue\n\nfunction Queue (options) {\n  if (!(this instanceof Queue)) {\n    return new Queue(options)\n  }\n\n  EventEmitter.call(this)\n  options = options || {}\n  this.concurrency = options.concurrency || Infinity\n  this.timeout = options.timeout || 0\n  this.autostart = options.autostart || false\n  this.results = options.results || null\n  this.pending = 0\n  this.session = 0\n  this.running = false\n  this.jobs = []\n  this.timers = {}\n}\ninherits(Queue, EventEmitter)\n\nvar arrayMethods = [\n  'pop',\n  'shift',\n  'indexOf',\n  'lastIndexOf'\n]\n\narrayMethods.forEach(function (method) {\n  Queue.prototype[method] = function () {\n    return Array.prototype[method].apply(this.jobs, arguments)\n  }\n})\n\nQueue.prototype.slice = function (begin, end) {\n  this.jobs = this.jobs.slice(begin, end)\n  return this\n}\n\nQueue.prototype.reverse = function () {\n  this.jobs.reverse()\n  return this\n}\n\nvar arrayAddMethods = [\n  'push',\n  'unshift',\n  'splice'\n]\n\narrayAddMethods.forEach(function (method) {\n  Queue.prototype[method] = function () {\n    var methodResult = Array.prototype[method].apply(this.jobs, arguments)\n    if (this.autostart) {\n      this.start()\n    }\n    return methodResult\n  }\n})\n\nObject.defineProperty(Queue.prototype, 'length', {\n  get: function () {\n    return this.pending + this.jobs.length\n  }\n})\n\nQueue.prototype.start = function (cb) {\n  if (cb) {\n    callOnErrorOrEnd.call(this, cb)\n  }\n\n  this.running = true\n\n  if (this.pending >= this.concurrency) {\n    return\n  }\n\n  if (this.jobs.length === 0) {\n    if (this.pending === 0) {\n      done.call(this)\n    }\n    return\n  }\n\n  var self = this\n  var job = this.jobs.shift()\n  var once = true\n  var session = this.session\n  var timeoutId = null\n  var didTimeout = false\n  var resultIndex = null\n  var timeout = job.timeout || this.timeout\n\n  function next (err, result) {\n    if (once && self.session === session) {\n      once = false\n      self.pending--\n      if (timeoutId !== null) {\n        delete self.timers[timeoutId]\n        clearTimeout(timeoutId)\n      }\n\n      if (err) {\n        self.emit('error', err, job)\n      } else if (didTimeout === false) {\n        if (resultIndex !== null) {\n          self.results[resultIndex] = Array.prototype.slice.call(arguments, 1)\n        }\n        self.emit('success', result, job)\n      }\n\n      if (self.session === session) {\n        if (self.pending === 0 && self.jobs.length === 0) {\n          done.call(self)\n        } else if (self.running) {\n          self.start()\n        }\n      }\n    }\n  }\n\n  if (timeout) {\n    timeoutId = setTimeout(function () {\n      didTimeout = true\n      if (self.listeners('timeout').length > 0) {\n        self.emit('timeout', next, job)\n      } else {\n        next()\n      }\n    }, timeout)\n    this.timers[timeoutId] = timeoutId\n  }\n\n  if (this.results) {\n    resultIndex = this.results.length\n    this.results[resultIndex] = null\n  }\n\n  this.pending++\n  self.emit('start', job)\n  var promise = job(next)\n  if (promise && promise.then && typeof promise.then === 'function') {\n    promise.then(function (result) {\n      return next(null, result)\n    }).catch(function (err) {\n      return next(err || true)\n    })\n  }\n\n  if (this.running && this.jobs.length > 0) {\n    this.start()\n  }\n}\n\nQueue.prototype.stop = function () {\n  this.running = false\n}\n\nQueue.prototype.end = function (err) {\n  clearTimers.call(this)\n  this.jobs.length = 0\n  this.pending = 0\n  done.call(this, err)\n}\n\nfunction clearTimers () {\n  for (var key in this.timers) {\n    var timeoutId = this.timers[key]\n    delete this.timers[key]\n    clearTimeout(timeoutId)\n  }\n}\n\nfunction callOnErrorOrEnd (cb) {\n  var self = this\n  this.on('error', onerror)\n  this.on('end', onend)\n\n  function onerror (err) { self.end(err) }\n  function onend (err) {\n    self.removeListener('error', onerror)\n    self.removeListener('end', onend)\n    cb(err, this.results)\n  }\n}\n\nfunction done (err) {\n  this.session++\n  this.running = false\n  this.emit('end', err)\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BMP = {\n    validate(buffer) {\n        return ('BM' === buffer.toString('ascii', 0, 2));\n    },\n    calculate(buffer) {\n        return {\n            height: Math.abs(buffer.readInt32LE(22)),\n            width: buffer.readUInt32LE(18)\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst TYPE_ICON = 1;\n/**\n * ICON Header\n *\n * | Offset | Size | Purpose |\n * | 0\t    | 2    | Reserved. Must always be 0.  |\n * | 2      | 2    | Image type: 1 for icon (.ICO) image, 2 for cursor (.CUR) image. Other values are invalid. |\n * | 4      | 2    | Number of images in the file. |\n *\n */\nconst SIZE_HEADER = 2 + 2 + 2; // 6\n/**\n * Image Entry\n *\n * | Offset | Size | Purpose |\n * | 0\t    | 1    | Image width in pixels. Can be any number between 0 and 255. Value 0 means width is 256 pixels. |\n * | 1      | 1    | Image height in pixels. Can be any number between 0 and 255. Value 0 means height is 256 pixels. |\n * | 2      | 1    | Number of colors in the color palette. Should be 0 if the image does not use a color palette. |\n * | 3      | 1    | Reserved. Should be 0. |\n * | 4      | 2    | ICO format: Color planes. Should be 0 or 1. |\n * |        |      | CUR format: The horizontal coordinates of the hotspot in number of pixels from the left. |\n * | 6      | 2    | ICO format: Bits per pixel. |\n * |        |      | CUR format: The vertical coordinates of the hotspot in number of pixels from the top. |\n * | 8      | 4    | The size of the image's data in bytes |\n * | 12     | 4    | The offset of BMP or PNG data from the beginning of the ICO/CUR file |\n *\n */\nconst SIZE_IMAGE_ENTRY = 1 + 1 + 1 + 1 + 2 + 2 + 4 + 4; // 16\nfunction getSizeFromOffset(buffer, offset) {\n    const value = buffer.readUInt8(offset);\n    return value === 0 ? 256 : value;\n}\nfunction getImageSize(buffer, imageIndex) {\n    const offset = SIZE_HEADER + (imageIndex * SIZE_IMAGE_ENTRY);\n    return {\n        height: getSizeFromOffset(buffer, offset + 1),\n        width: getSizeFromOffset(buffer, offset)\n    };\n}\nexports.ICO = {\n    validate(buffer) {\n        if (buffer.readUInt16LE(0) !== 0) {\n            return false;\n        }\n        return buffer.readUInt16LE(2) === TYPE_ICON;\n    },\n    calculate(buffer) {\n        const nbImages = buffer.readUInt16LE(4);\n        const imageSize = getImageSize(buffer, 0);\n        if (nbImages === 1) {\n            return imageSize;\n        }\n        const imgs = [imageSize];\n        for (let imageIndex = 1; imageIndex < nbImages; imageIndex += 1) {\n            imgs.push(getImageSize(buffer, imageIndex));\n        }\n        const result = {\n            height: imageSize.height,\n            images: imgs,\n            width: imageSize.width\n        };\n        return result;\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst ico_1 = require(\"./ico\");\nconst TYPE_CURSOR = 2;\nexports.CUR = {\n    validate(buffer) {\n        if (buffer.readUInt16LE(0) !== 0) {\n            return false;\n        }\n        return buffer.readUInt16LE(2) === TYPE_CURSOR;\n    },\n    calculate(buffer) {\n        return ico_1.ICO.calculate(buffer);\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DDS = {\n    validate(buffer) {\n        return buffer.readUInt32LE(0) === 0x20534444;\n    },\n    calculate(buffer) {\n        return {\n            height: buffer.readUInt32LE(12),\n            width: buffer.readUInt32LE(16)\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst gifRegexp = /^GIF8[79]a/;\nexports.GIF = {\n    validate(buffer) {\n        const signature = buffer.toString('ascii', 0, 6);\n        return (gifRegexp.test(signature));\n    },\n    calculate(buffer) {\n        return {\n            height: buffer.readUInt16LE(8),\n            width: buffer.readUInt16LE(6)\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * ICNS Header\n *\n * | Offset | Size | Purpose                                                |\n * | 0\t    | 4    | Magic literal, must be \"icns\" (0x69, 0x63, 0x6e, 0x73) |\n * | 4      | 4    | Length of file, in bytes, msb first.                   |\n *\n */\nconst SIZE_HEADER = 4 + 4; // 8\nconst FILE_LENGTH_OFFSET = 4; // MSB => BIG ENDIAN\n/**\n * Image Entry\n *\n * | Offset | Size | Purpose                                                          |\n * | 0\t    | 4    | Icon type, see OSType below.                                     |\n * | 4      | 4    | Length of data, in bytes (including type and length), msb first. |\n * | 8      | n    | Icon data                                                        |\n */\nconst ENTRY_LENGTH_OFFSET = 4; // MSB => BIG ENDIAN\n/* tslint:disable:object-literal-sort-keys */\nconst ICON_TYPE_SIZE = {\n    ICON: 32,\n    'ICN#': 32,\n    // m => 16 x 16\n    'icm#': 16,\n    icm4: 16,\n    icm8: 16,\n    // s => 16 x 16\n    'ics#': 16,\n    ics4: 16,\n    ics8: 16,\n    is32: 16,\n    s8mk: 16,\n    icp4: 16,\n    // l => 32 x 32\n    icl4: 32,\n    icl8: 32,\n    il32: 32,\n    l8mk: 32,\n    icp5: 32,\n    ic11: 32,\n    // h => 48 x 48\n    ich4: 48,\n    ich8: 48,\n    ih32: 48,\n    h8mk: 48,\n    // . => 64 x 64\n    icp6: 64,\n    ic12: 32,\n    // t => 128 x 128\n    it32: 128,\n    t8mk: 128,\n    ic07: 128,\n    // . => 256 x 256\n    ic08: 256,\n    ic13: 256,\n    // . => 512 x 512\n    ic09: 512,\n    ic14: 512,\n    // . => 1024 x 1024\n    ic10: 1024,\n};\n/* tslint:enable:object-literal-sort-keys */\nfunction readImageHeader(buffer, imageOffset) {\n    const imageLengthOffset = imageOffset + ENTRY_LENGTH_OFFSET;\n    return [\n        buffer.toString('ascii', imageOffset, imageLengthOffset),\n        buffer.readUInt32BE(imageLengthOffset)\n    ];\n}\nfunction getImageSize(type) {\n    const size = ICON_TYPE_SIZE[type];\n    return { width: size, height: size, type };\n}\nexports.ICNS = {\n    validate(buffer) {\n        return ('icns' === buffer.toString('ascii', 0, 4));\n    },\n    calculate(buffer) {\n        const bufferLength = buffer.length;\n        const fileLength = buffer.readUInt32BE(FILE_LENGTH_OFFSET);\n        let imageOffset = SIZE_HEADER;\n        let imageHeader = readImageHeader(buffer, imageOffset);\n        let imageSize = getImageSize(imageHeader[0]);\n        imageOffset += imageHeader[1];\n        if (imageOffset === fileLength) {\n            return imageSize;\n        }\n        const result = {\n            height: imageSize.height,\n            images: [imageSize],\n            width: imageSize.width\n        };\n        while (imageOffset < fileLength && imageOffset < bufferLength) {\n            imageHeader = readImageHeader(buffer, imageOffset);\n            imageSize = getImageSize(imageHeader[0]);\n            imageOffset += imageHeader[1];\n            result.images.push(imageSize);\n        }\n        return result;\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.J2C = {\n    validate(buffer) {\n        // TODO: this doesn't seem right. SIZ marker doesnt have to be right after the SOC\n        return buffer.toString('hex', 0, 4) === 'ff4fff51';\n    },\n    calculate(buffer) {\n        return {\n            height: buffer.readUInt32BE(12),\n            width: buffer.readUInt32BE(8),\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst BoxTypes = {\n    ftyp: '66747970',\n    ihdr: '69686472',\n    jp2h: '6a703268',\n    jp__: '6a502020',\n    rreq: '72726571',\n    xml_: '786d6c20'\n};\nconst calculateRREQLength = (box) => {\n    const unit = box.readUInt8(0);\n    let offset = 1 + (2 * unit);\n    const numStdFlags = box.readUInt16BE(offset);\n    const flagsLength = numStdFlags * (2 + unit);\n    offset = offset + 2 + flagsLength;\n    const numVendorFeatures = box.readUInt16BE(offset);\n    const featuresLength = numVendorFeatures * (16 + unit);\n    return offset + 2 + featuresLength;\n};\nconst parseIHDR = (box) => {\n    return {\n        height: box.readUInt32BE(4),\n        width: box.readUInt32BE(8),\n    };\n};\nexports.JP2 = {\n    validate(buffer) {\n        const signature = buffer.toString('hex', 4, 8);\n        const signatureLength = buffer.readUInt32BE(0);\n        if (signature !== BoxTypes.jp__ || signatureLength < 1) {\n            return false;\n        }\n        const ftypeBoxStart = signatureLength + 4;\n        const ftypBoxLength = buffer.readUInt32BE(signatureLength);\n        const ftypBox = buffer.slice(ftypeBoxStart, ftypeBoxStart + ftypBoxLength);\n        return ftypBox.toString('hex', 0, 4) === BoxTypes.ftyp;\n    },\n    calculate(buffer) {\n        const signatureLength = buffer.readUInt32BE(0);\n        const ftypBoxLength = buffer.readUInt16BE(signatureLength + 2);\n        let offset = signatureLength + 4 + ftypBoxLength;\n        const nextBoxType = buffer.toString('hex', offset, offset + 4);\n        switch (nextBoxType) {\n            case BoxTypes.rreq:\n                // WHAT ARE THESE 4 BYTES?????\n                const MAGIC = 4;\n                offset = offset + 4 + MAGIC + calculateRREQLength(buffer.slice(offset + 4));\n                return parseIHDR(buffer.slice(offset + 8, offset + 24));\n            case BoxTypes.jp2h:\n                return parseIHDR(buffer.slice(offset + 8, offset + 24));\n            default:\n                throw new TypeError('Unsupported header found: ' + buffer.toString('ascii', offset, offset + 4));\n        }\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// Abstract reading multi-byte unsigned integers\nfunction readUInt(buffer, bits, offset, isBigEndian) {\n    offset = offset || 0;\n    const endian = isBigEndian ? 'BE' : 'LE';\n    const methodName = ('readUInt' + bits + endian);\n    const method = buffer[methodName];\n    return method.call(buffer, offset);\n}\nexports.readUInt = readUInt;\n","\"use strict\";\n// NOTE: we only support baseline and progressive JPGs here\n// due to the structure of the loader class, we only get a buffer\n// with a maximum size of 4096 bytes. so if the SOF marker is outside\n// if this range we can't detect the file size correctly.\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst readUInt_1 = require(\"../readUInt\");\nconst EXIF_MARKER = '45786966';\nconst APP1_DATA_SIZE_BYTES = 2;\nconst EXIF_HEADER_BYTES = 6;\nconst TIFF_BYTE_ALIGN_BYTES = 2;\nconst BIG_ENDIAN_BYTE_ALIGN = '4d4d';\nconst LITTLE_ENDIAN_BYTE_ALIGN = '4949';\n// Each entry is exactly 12 bytes\nconst IDF_ENTRY_BYTES = 12;\nconst NUM_DIRECTORY_ENTRIES_BYTES = 2;\nfunction isEXIF(buffer) {\n    return (buffer.toString('hex', 2, 6) === EXIF_MARKER);\n}\nfunction extractSize(buffer, index) {\n    return {\n        height: buffer.readUInt16BE(index),\n        width: buffer.readUInt16BE(index + 2)\n    };\n}\nfunction validateExifBlock(buffer, index) {\n    // Skip APP1 Data Size\n    const exifBlock = buffer.slice(APP1_DATA_SIZE_BYTES, index);\n    // Consider byte alignment\n    const byteAlign = exifBlock.toString('hex', EXIF_HEADER_BYTES, EXIF_HEADER_BYTES + TIFF_BYTE_ALIGN_BYTES);\n    // Ignore Empty EXIF. Validate byte alignment\n    const isBigEndian = byteAlign === BIG_ENDIAN_BYTE_ALIGN;\n    const isLittleEndian = byteAlign === LITTLE_ENDIAN_BYTE_ALIGN;\n    if (isBigEndian || isLittleEndian) {\n        return extractOrientation(exifBlock, isBigEndian);\n    }\n}\nfunction extractOrientation(exifBlock, isBigEndian) {\n    // TODO: assert that this contains 0x002A\n    // let STATIC_MOTOROLA_TIFF_HEADER_BYTES = 2\n    // let TIFF_IMAGE_FILE_DIRECTORY_BYTES = 4\n    // TODO: derive from TIFF_IMAGE_FILE_DIRECTORY_BYTES\n    const idfOffset = 8;\n    // IDF osset works from right after the header bytes\n    // (so the offset includes the tiff byte align)\n    const offset = EXIF_HEADER_BYTES + idfOffset;\n    const idfDirectoryEntries = readUInt_1.readUInt(exifBlock, 16, offset, isBigEndian);\n    for (let directoryEntryNumber = 0; directoryEntryNumber < idfDirectoryEntries; directoryEntryNumber++) {\n        const start = offset + NUM_DIRECTORY_ENTRIES_BYTES + (directoryEntryNumber * IDF_ENTRY_BYTES);\n        const end = start + IDF_ENTRY_BYTES;\n        // Skip on corrupt EXIF blocks\n        if (start > exifBlock.length) {\n            return;\n        }\n        const block = exifBlock.slice(start, end);\n        const tagNumber = readUInt_1.readUInt(block, 16, 0, isBigEndian);\n        // 0x0112 (decimal: 274) is the `orientation` tag ID\n        if (tagNumber === 274) {\n            const dataFormat = readUInt_1.readUInt(block, 16, 2, isBigEndian);\n            if (dataFormat !== 3) {\n                return;\n            }\n            // unsinged int has 2 bytes per component\n            // if there would more than 4 bytes in total it's a pointer\n            const numberOfComponents = readUInt_1.readUInt(block, 32, 4, isBigEndian);\n            if (numberOfComponents !== 1) {\n                return;\n            }\n            return readUInt_1.readUInt(block, 16, 8, isBigEndian);\n        }\n    }\n}\nfunction validateBuffer(buffer, index) {\n    // index should be within buffer limits\n    if (index > buffer.length) {\n        throw new TypeError('Corrupt JPG, exceeded buffer limits');\n    }\n    // Every JPEG block must begin with a 0xFF\n    if (buffer[index] !== 0xFF) {\n        throw new TypeError('Invalid JPG, marker table corrupted');\n    }\n}\nexports.JPG = {\n    validate(buffer) {\n        const SOIMarker = buffer.toString('hex', 0, 2);\n        return ('ffd8' === SOIMarker);\n    },\n    calculate(buffer) {\n        // Skip 4 chars, they are for signature\n        buffer = buffer.slice(4);\n        let orientation;\n        let next;\n        while (buffer.length) {\n            // read length of the next block\n            const i = buffer.readUInt16BE(0);\n            if (isEXIF(buffer)) {\n                orientation = validateExifBlock(buffer, i);\n            }\n            // ensure correct format\n            validateBuffer(buffer, i);\n            // 0xFFC0 is baseline standard(SOF)\n            // 0xFFC1 is baseline optimized(SOF)\n            // 0xFFC2 is progressive(SOF2)\n            next = buffer[i + 1];\n            if (next === 0xC0 || next === 0xC1 || next === 0xC2) {\n                const size = extractSize(buffer, i + 5);\n                // TODO: is orientation=0 a valid answer here?\n                if (!orientation) {\n                    return size;\n                }\n                return {\n                    height: size.height,\n                    orientation,\n                    width: size.width\n                };\n            }\n            // move to the next block\n            buffer = buffer.slice(i + 2);\n        }\n        throw new TypeError('Invalid JPG, no size found');\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst SIGNATURE = 'KTX 11';\nexports.KTX = {\n    validate(buffer) {\n        return SIGNATURE === buffer.toString('ascii', 1, 7);\n    },\n    calculate(buffer) {\n        return {\n            height: buffer.readUInt32LE(40),\n            width: buffer.readUInt32LE(36),\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst pngSignature = 'PNG\\r\\n\\x1a\\n';\nconst pngImageHeaderChunkName = 'IHDR';\n// Used to detect \"fried\" png's: http://www.jongware.com/pngdefry.html\nconst pngFriedChunkName = 'CgBI';\nexports.PNG = {\n    validate(buffer) {\n        if (pngSignature === buffer.toString('ascii', 1, 8)) {\n            let chunkName = buffer.toString('ascii', 12, 16);\n            if (chunkName === pngFriedChunkName) {\n                chunkName = buffer.toString('ascii', 28, 32);\n            }\n            if (chunkName !== pngImageHeaderChunkName) {\n                throw new TypeError('Invalid PNG');\n            }\n            return true;\n        }\n        return false;\n    },\n    calculate(buffer) {\n        if (buffer.toString('ascii', 12, 16) === pngFriedChunkName) {\n            return {\n                height: buffer.readUInt32BE(36),\n                width: buffer.readUInt32BE(32)\n            };\n        }\n        return {\n            height: buffer.readUInt32BE(20),\n            width: buffer.readUInt32BE(16)\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst PNMTypes = {\n    P1: 'pbm/ascii',\n    P2: 'pgm/ascii',\n    P3: 'ppm/ascii',\n    P4: 'pbm',\n    P5: 'pgm',\n    P6: 'ppm',\n    P7: 'pam',\n    PF: 'pfm'\n};\nconst Signatures = Object.keys(PNMTypes);\nconst handlers = {\n    default: (lines) => {\n        let dimensions = [];\n        while (lines.length > 0) {\n            const line = lines.shift();\n            if (line[0] === '#') {\n                continue;\n            }\n            dimensions = line.split(' ');\n            break;\n        }\n        if (dimensions.length === 2) {\n            return {\n                height: parseInt(dimensions[1], 10),\n                width: parseInt(dimensions[0], 10),\n            };\n        }\n        else {\n            throw new TypeError('Invalid PNM');\n        }\n    },\n    pam: (lines) => {\n        const size = {};\n        while (lines.length > 0) {\n            const line = lines.shift();\n            if (line.length > 16 || line.charCodeAt(0) > 128) {\n                continue;\n            }\n            const [key, value] = line.split(' ');\n            if (key && value) {\n                size[key.toLowerCase()] = parseInt(value, 10);\n            }\n            if (size.height && size.width) {\n                break;\n            }\n        }\n        if (size.height && size.width) {\n            return {\n                height: size.height,\n                width: size.width\n            };\n        }\n        else {\n            throw new TypeError('Invalid PAM');\n        }\n    }\n};\nexports.PNM = {\n    validate(buffer) {\n        const signature = buffer.toString('ascii', 0, 2);\n        return Signatures.includes(signature);\n    },\n    calculate(buffer) {\n        const signature = buffer.toString('ascii', 0, 2);\n        const type = PNMTypes[signature];\n        // TODO: this probably generates garbage. move to a stream based parser\n        const lines = buffer.toString('ascii', 3).split(/[\\r\\n]+/);\n        const handler = handlers[type] || handlers.default;\n        return handler(lines);\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PSD = {\n    validate(buffer) {\n        return ('8BPS' === buffer.toString('ascii', 0, 4));\n    },\n    calculate(buffer) {\n        return {\n            height: buffer.readUInt32BE(14),\n            width: buffer.readUInt32BE(18)\n        };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst svgReg = /<svg\\s([^>\"']|\"[^\"]*\"|'[^']*')*>/;\nconst extractorRegExps = {\n    height: /\\sheight=(['\"])([^%]+?)\\1/,\n    root: svgReg,\n    viewbox: /\\sviewBox=(['\"])(.+?)\\1/,\n    width: /\\swidth=(['\"])([^%]+?)\\1/,\n};\nconst INCH_CM = 2.54;\nconst units = {\n    cm: 96 / INCH_CM,\n    em: 16,\n    ex: 8,\n    m: 96 / INCH_CM * 100,\n    mm: 96 / INCH_CM / 10,\n    pc: 96 / 72 / 12,\n    pt: 96 / 72,\n};\nfunction parseLength(len) {\n    const m = /([0-9.]+)([a-z]*)/.exec(len);\n    if (!m) {\n        return undefined;\n    }\n    return Math.round(parseFloat(m[1]) * (units[m[2]] || 1));\n}\nfunction parseViewbox(viewbox) {\n    const bounds = viewbox.split(' ');\n    return {\n        height: parseLength(bounds[3]),\n        width: parseLength(bounds[2])\n    };\n}\nfunction parseAttributes(root) {\n    const width = root.match(extractorRegExps.width);\n    const height = root.match(extractorRegExps.height);\n    const viewbox = root.match(extractorRegExps.viewbox);\n    return {\n        height: height && parseLength(height[2]),\n        viewbox: viewbox && parseViewbox(viewbox[2]),\n        width: width && parseLength(width[2]),\n    };\n}\nfunction calculateByDimensions(attrs) {\n    return {\n        height: attrs.height,\n        width: attrs.width,\n    };\n}\nfunction calculateByViewbox(attrs, viewbox) {\n    const ratio = viewbox.width / viewbox.height;\n    if (attrs.width) {\n        return {\n            height: Math.floor(attrs.width / ratio),\n            width: attrs.width,\n        };\n    }\n    if (attrs.height) {\n        return {\n            height: attrs.height,\n            width: Math.floor(attrs.height * ratio),\n        };\n    }\n    return {\n        height: viewbox.height,\n        width: viewbox.width,\n    };\n}\nexports.SVG = {\n    validate(buffer) {\n        const str = String(buffer);\n        return svgReg.test(str);\n    },\n    calculate(buffer) {\n        const root = buffer.toString('utf8').match(extractorRegExps.root);\n        if (root) {\n            const attrs = parseAttributes(root[0]);\n            if (attrs.width && attrs.height) {\n                return calculateByDimensions(attrs);\n            }\n            if (attrs.viewbox) {\n                return calculateByViewbox(attrs, attrs.viewbox);\n            }\n        }\n        throw new TypeError('Invalid SVG');\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// based on http://www.compix.com/fileformattif.htm\n// TO-DO: support big-endian as well\nconst fs = require(\"fs\");\nconst readUInt_1 = require(\"../readUInt\");\n// Read IFD (image-file-directory) into a buffer\nfunction readIFD(buffer, filepath, isBigEndian) {\n    const ifdOffset = readUInt_1.readUInt(buffer, 32, 4, isBigEndian);\n    // read only till the end of the file\n    let bufferSize = 1024;\n    const fileSize = fs.statSync(filepath).size;\n    if (ifdOffset + bufferSize > fileSize) {\n        bufferSize = fileSize - ifdOffset - 10;\n    }\n    // populate the buffer\n    const endBuffer = Buffer.alloc(bufferSize);\n    const descriptor = fs.openSync(filepath, 'r');\n    fs.readSync(descriptor, endBuffer, 0, bufferSize, ifdOffset);\n    return endBuffer.slice(2);\n}\n// TIFF values seem to be messed up on Big-Endian, this helps\nfunction readValue(buffer, isBigEndian) {\n    const low = readUInt_1.readUInt(buffer, 16, 8, isBigEndian);\n    const high = readUInt_1.readUInt(buffer, 16, 10, isBigEndian);\n    return (high << 16) + low;\n}\n// move to the next tag\nfunction nextTag(buffer) {\n    if (buffer.length > 24) {\n        return buffer.slice(12);\n    }\n}\n// Extract IFD tags from TIFF metadata\nfunction extractTags(buffer, isBigEndian) {\n    const tags = {};\n    let temp = buffer;\n    while (temp && temp.length) {\n        const code = readUInt_1.readUInt(temp, 16, 0, isBigEndian);\n        const type = readUInt_1.readUInt(temp, 16, 2, isBigEndian);\n        const length = readUInt_1.readUInt(temp, 32, 4, isBigEndian);\n        // 0 means end of IFD\n        if (code === 0) {\n            break;\n        }\n        else {\n            // 256 is width, 257 is height\n            // if (code === 256 || code === 257) {\n            if (length === 1 && (type === 3 || type === 4)) {\n                tags[code] = readValue(temp, isBigEndian);\n            }\n            // move to the next tag\n            temp = nextTag(temp);\n        }\n    }\n    return tags;\n}\n// Test if the TIFF is Big Endian or Little Endian\nfunction determineEndianness(buffer) {\n    const signature = buffer.toString('ascii', 0, 2);\n    if ('II' === signature) {\n        return 'LE';\n    }\n    else if ('MM' === signature) {\n        return 'BE';\n    }\n}\nconst signatures = [\n    // '492049', // currently not supported\n    '49492a00',\n    '4d4d002a',\n];\nexports.TIFF = {\n    validate(buffer) {\n        return signatures.includes(buffer.toString('hex', 0, 4));\n    },\n    calculate(buffer, filepath) {\n        if (!filepath) {\n            throw new TypeError('Tiff doesn\\'t support buffer');\n        }\n        // Determine BE/LE\n        const isBigEndian = determineEndianness(buffer) === 'BE';\n        // read the IFD\n        const ifdBuffer = readIFD(buffer, filepath, isBigEndian);\n        // extract the tags from the IFD\n        const tags = extractTags(ifdBuffer, isBigEndian);\n        const width = tags[256];\n        const height = tags[257];\n        if (!width || !height) {\n            throw new TypeError('Invalid Tiff. Missing tags');\n        }\n        return { height, width };\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction calculateExtended(buffer) {\n    return {\n        height: 1 + buffer.readUIntLE(7, 3),\n        width: 1 + buffer.readUIntLE(4, 3)\n    };\n}\nfunction calculateLossless(buffer) {\n    return {\n        height: 1 + (((buffer[4] & 0xF) << 10) | (buffer[3] << 2) | ((buffer[2] & 0xC0) >> 6)),\n        width: 1 + (((buffer[2] & 0x3F) << 8) | buffer[1])\n    };\n}\nfunction calculateLossy(buffer) {\n    // `& 0x3fff` returns the last 14 bits\n    // TO-DO: include webp scaling in the calculations\n    return {\n        height: buffer.readInt16LE(8) & 0x3fff,\n        width: buffer.readInt16LE(6) & 0x3fff\n    };\n}\nexports.WEBP = {\n    validate(buffer) {\n        const riffHeader = 'RIFF' === buffer.toString('ascii', 0, 4);\n        const webpHeader = 'WEBP' === buffer.toString('ascii', 8, 12);\n        const vp8Header = 'VP8' === buffer.toString('ascii', 12, 15);\n        return (riffHeader && webpHeader && vp8Header);\n    },\n    calculate(buffer) {\n        const chunkHeader = buffer.toString('ascii', 12, 16);\n        buffer = buffer.slice(20, 30);\n        // Extended webp stream signature\n        if (chunkHeader === 'VP8X') {\n            const extendedHeader = buffer[0];\n            const validStart = (extendedHeader & 0xc0) === 0;\n            const validEnd = (extendedHeader & 0x01) === 0;\n            if (validStart && validEnd) {\n                return calculateExtended(buffer);\n            }\n            else {\n                // TODO: breaking change\n                throw new TypeError('Invalid WebP');\n            }\n        }\n        // Lossless webp stream signature\n        if (chunkHeader === 'VP8 ' && buffer[0] !== 0x2f) {\n            return calculateLossy(buffer);\n        }\n        // Lossy webp stream signature\n        const signature = buffer.toString('hex', 3, 6);\n        if (chunkHeader === 'VP8L' && signature !== '9d012a') {\n            return calculateLossless(buffer);\n        }\n        throw new TypeError('Invalid WebP');\n    }\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst bmp_1 = require(\"./types/bmp\");\nconst cur_1 = require(\"./types/cur\");\nconst dds_1 = require(\"./types/dds\");\nconst gif_1 = require(\"./types/gif\");\nconst icns_1 = require(\"./types/icns\");\nconst ico_1 = require(\"./types/ico\");\nconst j2c_1 = require(\"./types/j2c\");\nconst jp2_1 = require(\"./types/jp2\");\nconst jpg_1 = require(\"./types/jpg\");\nconst ktx_1 = require(\"./types/ktx\");\nconst png_1 = require(\"./types/png\");\nconst pnm_1 = require(\"./types/pnm\");\nconst psd_1 = require(\"./types/psd\");\nconst svg_1 = require(\"./types/svg\");\nconst tiff_1 = require(\"./types/tiff\");\nconst webp_1 = require(\"./types/webp\");\nexports.typeHandlers = {\n    bmp: bmp_1.BMP,\n    cur: cur_1.CUR,\n    dds: dds_1.DDS,\n    gif: gif_1.GIF,\n    icns: icns_1.ICNS,\n    ico: ico_1.ICO,\n    j2c: j2c_1.J2C,\n    jp2: jp2_1.JP2,\n    jpg: jpg_1.JPG,\n    ktx: ktx_1.KTX,\n    png: png_1.PNG,\n    pnm: pnm_1.PNM,\n    psd: psd_1.PSD,\n    svg: svg_1.SVG,\n    tiff: tiff_1.TIFF,\n    webp: webp_1.WEBP,\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst types_1 = require(\"./types\");\nconst keys = Object.keys(types_1.typeHandlers);\n// This map helps avoid validating for every single image type\nconst firstBytes = {\n    0x38: 'psd',\n    0x42: 'bmp',\n    0x44: 'dds',\n    0x47: 'gif',\n    0x49: 'tiff',\n    0x4d: 'tiff',\n    0x52: 'webp',\n    0x69: 'icns',\n    0x89: 'png',\n    0xff: 'jpg'\n};\nfunction detector(buffer) {\n    const byte = buffer[0];\n    if (byte in firstBytes) {\n        const type = firstBytes[byte];\n        if (types_1.typeHandlers[type].validate(buffer)) {\n            return type;\n        }\n    }\n    const finder = (key) => types_1.typeHandlers[key].validate(buffer);\n    return keys.find(finder);\n}\nexports.detector = detector;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst fs = require(\"fs\");\n// fs.promises polyfill for node 8.x\nif (!('promises' in fs)) {\n    class FileHandle {\n        constructor(fd) {\n            this.fd = fd;\n        }\n        stat() {\n            return new Promise((resolve, reject) => {\n                fs.fstat(this.fd, (err, stats) => {\n                    if (err) {\n                        reject(err);\n                    }\n                    else {\n                        resolve(stats);\n                    }\n                });\n            });\n        }\n        read(buffer, offset, length, position) {\n            return new Promise((resolve, reject) => {\n                fs.read(this.fd, buffer, offset, length, position, (err) => {\n                    if (err) {\n                        reject(err);\n                    }\n                    else {\n                        resolve();\n                    }\n                });\n            });\n        }\n        close() {\n            return new Promise((resolve, reject) => {\n                fs.close(this.fd, (err) => {\n                    if (err) {\n                        reject(err);\n                    }\n                    else {\n                        resolve();\n                    }\n                });\n            });\n        }\n    }\n    Object.defineProperty(fs, 'promises', {\n        value: {\n            open: (filepath, flags) => (new Promise((resolve, reject) => {\n                fs.open(filepath, flags, (err, fd) => {\n                    if (err) {\n                        reject(err);\n                    }\n                    else {\n                        resolve(new FileHandle(fd));\n                    }\n                });\n            })),\n        },\n        writable: false\n    });\n}\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst fs = require(\"fs\");\nconst path = require(\"path\");\nconst queue_1 = require(\"queue\");\nconst types_1 = require(\"./types\");\nconst detector_1 = require(\"./detector\");\nrequire(\"./fs.promises\");\n// Maximum buffer size, with a default of 512 kilobytes.\n// TO-DO: make this adaptive based on the initial signature of the image\nconst MaxBufferSize = 512 * 1024;\n// This queue is for async `fs` operations, to avoid reaching file-descriptor limits\nconst queue = new queue_1.default({ concurrency: 100, autostart: true });\n/**\n * Return size information based on a buffer\n *\n * @param {Buffer} buffer\n * @param {String} filepath\n * @returns {Object}\n */\nfunction lookup(buffer, filepath) {\n    // detect the file type.. don't rely on the extension\n    const type = detector_1.detector(buffer);\n    // find an appropriate handler for this file type\n    if (type && type in types_1.typeHandlers) {\n        const size = types_1.typeHandlers[type].calculate(buffer, filepath);\n        if (size !== undefined) {\n            size.type = type;\n            return size;\n        }\n    }\n    // throw up, if we don't understand the file\n    throw new TypeError('unsupported file type: ' + type + ' (file: ' + filepath + ')');\n}\n/**\n * Reads a file into a buffer.\n * @param {String} filepath\n * @returns {Promise<Buffer>}\n */\nfunction asyncFileToBuffer(filepath) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const handle = yield fs.promises.open(filepath, 'r');\n        const { size } = yield handle.stat();\n        if (size <= 0) {\n            throw new Error('Empty file');\n        }\n        const bufferSize = Math.min(size, MaxBufferSize);\n        const buffer = Buffer.alloc(bufferSize);\n        yield handle.read(buffer, 0, bufferSize, 0);\n        yield handle.close();\n        return buffer;\n    });\n}\n/**\n * Synchronously reads a file into a buffer, blocking the nodejs process.\n *\n * @param {String} filepath\n * @returns {Buffer}\n */\nfunction syncFileToBuffer(filepath) {\n    // read from the file, synchronously\n    const descriptor = fs.openSync(filepath, 'r');\n    const size = fs.fstatSync(descriptor).size;\n    const bufferSize = Math.min(size, MaxBufferSize);\n    const buffer = Buffer.alloc(bufferSize);\n    fs.readSync(descriptor, buffer, 0, bufferSize, 0);\n    fs.closeSync(descriptor);\n    return buffer;\n}\nmodule.exports = exports = imageSize; // backwards compatibility\n/**\n * @param {Buffer|string} input - buffer or relative/absolute path of the image file\n * @param {Function=} [callback] - optional function for async detection\n */\nfunction imageSize(input, callback) {\n    // Handle buffer input\n    if (Buffer.isBuffer(input)) {\n        return lookup(input);\n    }\n    // input should be a string at this point\n    if (typeof input !== 'string') {\n        throw new TypeError('invalid invocation');\n    }\n    // resolve the file path\n    const filepath = path.resolve(input);\n    if (typeof callback === 'function') {\n        queue.push(() => asyncFileToBuffer(filepath)\n            .then((buffer) => process.nextTick(callback, null, lookup(buffer, filepath)))\n            .catch(callback));\n    }\n    else {\n        const buffer = syncFileToBuffer(filepath);\n        return lookup(buffer, filepath);\n    }\n}\nexports.imageSize = imageSize;\nexports.setConcurrency = (c) => { queue.concurrency = c; };\nexports.types = Object.keys(types_1.typeHandlers);\n","const namespaces = {\n  a: 'http://schemas.openxmlformats.org/drawingml/2006/main',\n  b: 'http://schemas.openxmlformats.org/officeDocument/2006/bibliography',\n  cdr: 'http://schemas.openxmlformats.org/drawingml/2006/chartDrawing',\n  dc: 'http://purl.org/dc/elements/1.1/',\n  dcmitype: 'http://purl.org/dc/dcmitype/',\n  dcterms: 'http://purl.org/dc/terms/',\n  o: 'urn:schemas-microsoft-com:office:office',\n  pic: 'http://schemas.openxmlformats.org/drawingml/2006/picture',\n  r: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n  v: 'urn:schemas-microsoft-com:vml',\n  ve: 'http://schemas.openxmlformats.org/markup-compatibility/2006',\n  vt: 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n  w: 'http://schemas.openxmlformats.org/wordprocessingml/2006/main',\n  w10: 'urn:schemas-microsoft-com:office:word',\n  wp: 'http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing',\n  wne: 'http://schemas.microsoft.com/office/word/2006/wordml',\n  xsd: 'http://www.w3.org/2001/XMLSchema',\n  xsi: 'http://www.w3.org/2001/XMLSchema-instance',\n  numbering: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering',\n  hyperlinks: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink',\n  images: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image',\n  styles: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles',\n  headers: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/header',\n  footers: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer',\n  themes: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\n  coreProperties: 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties',\n  officeDocumentRelation:\n    'http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument',\n  corePropertiesRelation:\n    'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties',\n  settingsRelation: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings',\n  webSettingsRelation:\n    'http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings',\n  sl: 'http://schemas.openxmlformats.org/schemaLibrary/2006/main',\n};\n\nexport default namespaces;\n","/* eslint-disable no-param-reassign */\n\nexport const rgbRegex = /rgb\\((\\d+),\\s*([\\d.]+),\\s*([\\d.]+)\\)/i;\nexport const hslRegex = /hsl\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%\\)/i;\nexport const hexRegex = /#([0-9A-F]{6})/i;\nexport const hex3Regex = /#([0-9A-F])([0-9A-F])([0-9A-F])/i;\n\n// eslint-disable-next-line import/prefer-default-export\nexport const rgbToHex = (red, green, blue) => {\n  const hexColorCode = [red, green, blue]\n    .map((x) => {\n      // eslint-disable-next-line radix, no-param-reassign\n      x = parseInt(x).toString(16);\n      return x.length === 1 ? `0${x}` : x;\n    })\n    .join('');\n\n  return hexColorCode;\n};\n\nexport const hslToHex = (hue, saturation, luminosity) => {\n  hue /= 360;\n  saturation /= 100;\n  luminosity /= 100;\n  // eslint-disable-next-line one-var\n  let red, green, blue;\n  if (saturation === 0) {\n    // eslint-disable-next-line no-multi-assign\n    red = green = blue = luminosity; // achromatic\n  } else {\n    const hue2rgb = (p, q, t) => {\n      if (t < 0) t += 1;\n      if (t > 1) t -= 1;\n      if (t < 1 / 6) return p + (q - p) * 6 * t;\n      if (t < 1 / 2) return q;\n      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n      return p;\n    };\n    const q =\n      luminosity < 0.5\n        ? luminosity * (1 + saturation)\n        : luminosity + saturation - luminosity * saturation;\n    const p = 2 * luminosity - q;\n    red = hue2rgb(p, q, hue + 1 / 3);\n    green = hue2rgb(p, q, hue);\n    blue = hue2rgb(p, q, hue - 1 / 3);\n  }\n  return [red, green, blue]\n    .map((x) => {\n      const hex = Math.round(x * 255).toString(16);\n      return hex.length === 1 ? `0${hex}` : hex;\n    })\n    .join('');\n};\n\nexport const hex3ToHex = (red, green, blue) => {\n  const hexColorCode = [red, green, blue].map((x) => `${x}${x}`).join('');\n\n  return hexColorCode;\n};\n","export const pixelRegex = /([\\d.]+)px/i;\nexport const percentageRegex = /([\\d.]+)%/i;\nexport const pointRegex = /(\\d+)pt/i;\nexport const cmRegex = /([\\d.]+)cm/i;\nexport const inchRegex = /([\\d.]+)in/i;\n\nexport const pixelToEMU = (pixelValue) => {\n  return Math.round(pixelValue * 9525);\n};\n\nexport const EMUToPixel = (EMUValue) => {\n  return Math.round(EMUValue / 9525);\n};\n\nexport const TWIPToEMU = (TWIPValue) => {\n  return Math.round(TWIPValue * 635);\n};\n\nexport const EMUToTWIP = (EMUValue) => {\n  return Math.round(EMUValue / 635);\n};\n\nexport const pointToTWIP = (pointValue) => {\n  return Math.round(pointValue * 20);\n};\n\nexport const TWIPToPoint = (TWIPValue) => {\n  return Math.round(TWIPValue / 20);\n};\n\nexport const pointToHIP = (pointValue) => {\n  return Math.round(pointValue * 2);\n};\n\nexport const HIPToPoint = (HIPValue) => {\n  return Math.round(HIPValue / 2);\n};\n\nexport const HIPToTWIP = (HIPValue) => {\n  return Math.round(HIPValue * 10);\n};\n\nexport const TWIPToHIP = (TWIPValue) => {\n  return Math.round(TWIPValue / 10);\n};\n\nexport const pixelToTWIP = (pixelValue) => {\n  return EMUToTWIP(pixelToEMU(pixelValue));\n};\n\nexport const TWIPToPixel = (TWIPValue) => {\n  return EMUToPixel(TWIPToEMU(TWIPValue));\n};\n\nexport const pixelToHIP = (pixelValue) => {\n  return TWIPToHIP(EMUToTWIP(pixelToEMU(pixelValue)));\n};\n\nexport const HIPToPixel = (HIPValue) => {\n  return EMUToPixel(TWIPToEMU(HIPToTWIP(HIPValue)));\n};\n\nexport const inchToPoint = (inchValue) => {\n  return Math.round(inchValue * 72);\n};\n\nexport const inchToTWIP = (inchValue) => {\n  return pointToTWIP(inchToPoint(inchValue));\n};\n\nexport const cmToInch = (cmValue) => {\n  return cmValue * 0.3937008;\n};\n\nexport const cmToTWIP = (cmValue) => {\n  return inchToTWIP(cmToInch(cmValue));\n};\n\nexport const pixelToPoint = (pixelValue) => {\n  return HIPToPoint(pixelToHIP(pixelValue));\n};\n\nexport const pointToPixel = (pointValue) => {\n  return HIPToPixel(pointToHIP(pointValue));\n};\n\nexport const EIPToPoint = (EIPValue) => {\n  return Math.round(EIPValue / 8);\n};\n\nexport const pointToEIP = (PointValue) => {\n  return Math.round(PointValue * 8);\n};\n\nexport const pixelToEIP = (pixelValue) => {\n  return pointToEIP(pixelToPoint(pixelValue));\n};\n\nexport const EIPToPixel = (EIPValue) => {\n  return pointToPixel(EIPToPoint(EIPValue));\n};\n","/* eslint-disable radix */\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-case-declarations */\n/* eslint-disable no-plusplus */\n/* eslint-disable no-else-return */\nimport { fragment } from 'xmlbuilder2';\nimport { VText } from 'virtual-dom';\nimport isVNode from 'virtual-dom/vnode/is-vnode';\nimport isVText from 'virtual-dom/vnode/is-vtext';\nimport colorNames from 'color-name';\n\n// eslint-disable-next-line import/no-named-default\nimport { default as namespaces } from './namespaces';\nimport {\n  rgbToHex,\n  hslToHex,\n  hslRegex,\n  rgbRegex,\n  hexRegex,\n  hex3Regex,\n  hex3ToHex,\n} from '../utils/color-conversion';\nimport {\n  pixelToEMU,\n  pixelRegex,\n  TWIPToEMU,\n  percentageRegex,\n  pointRegex,\n  pointToHIP,\n  HIPToTWIP,\n  pointToTWIP,\n  pixelToHIP,\n  pixelToTWIP,\n  pixelToEIP,\n  pointToEIP,\n} from '../utils/unit-conversion';\n// FIXME: remove the cyclic dependency\n// eslint-disable-next-line import/no-cycle\nimport { buildImage } from './render-document-file';\n\n// eslint-disable-next-line consistent-return\nconst fixupColorCode = (colorCodeString) => {\n  if (Object.prototype.hasOwnProperty.call(colorNames, colorCodeString.toLowerCase())) {\n    const [red, green, blue] = colorNames[colorCodeString.toLowerCase()];\n\n    return rgbToHex(red, green, blue);\n  } else if (rgbRegex.test(colorCodeString)) {\n    const matchedParts = colorCodeString.match(rgbRegex);\n    const red = matchedParts[1];\n    const green = matchedParts[2];\n    const blue = matchedParts[3];\n\n    return rgbToHex(red, green, blue);\n  } else if (hslRegex.test(colorCodeString)) {\n    const matchedParts = colorCodeString.match(hslRegex);\n    const hue = matchedParts[1];\n    const saturation = matchedParts[2];\n    const luminosity = matchedParts[3];\n\n    return hslToHex(hue, saturation, luminosity);\n  } else if (hexRegex.test(colorCodeString)) {\n    const matchedParts = colorCodeString.match(hexRegex);\n\n    return matchedParts[1];\n  } else if (hex3Regex.test(colorCodeString)) {\n    const matchedParts = colorCodeString.match(hex3Regex);\n    const red = matchedParts[1];\n    const green = matchedParts[2];\n    const blue = matchedParts[3];\n\n    return hex3ToHex(red, green, blue);\n  } else {\n    return '000000';\n  }\n};\n\nconst buildRunFontFragment = (fontName = 'Times New Roman') => {\n  const runFontFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'rFonts')\n    .att('@w', 'ascii', fontName)\n    .att('@w', 'hAnsi', fontName)\n    .up();\n\n  return runFontFragment;\n};\n\nconst buildRunStyleFragment = (type = 'Hyperlink') => {\n  const runStyleFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'rStyle')\n    .att('@w', 'val', type)\n    .up();\n\n  return runStyleFragment;\n};\n\nconst buildTableRowHeight = (tableRowHeight) => {\n  const tableRowHeightFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'trHeight')\n    .att('@w', 'val', tableRowHeight)\n    .att('@w', 'hRule', 'atLeast')\n    .up();\n\n  return tableRowHeightFragment;\n};\n\nconst buildVerticalAlignment = (verticalAlignment) => {\n  if (verticalAlignment.toLowerCase() === 'middle') {\n    verticalAlignment = 'center';\n  }\n\n  const verticalAlignmentFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'vAlign')\n    .att('@w', 'val', verticalAlignment)\n    .up();\n\n  return verticalAlignmentFragment;\n};\n\nconst buildVerticalMerge = (verticalMerge = 'continue') => {\n  const verticalMergeFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'vMerge')\n    .att('@w', 'val', verticalMerge)\n    .up();\n\n  return verticalMergeFragment;\n};\n\nconst buildColor = (colorCode) => {\n  const colorFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'color')\n    .att('@w', 'val', colorCode)\n    .up();\n\n  return colorFragment;\n};\n\nconst buildFontSize = (fontSize) => {\n  const fontSizeFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'sz')\n    .att('@w', 'val', fontSize)\n    .up();\n\n  return fontSizeFragment;\n};\n\nconst buildShading = (colorCode) => {\n  const shadingFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'shd')\n    .att('@w', 'val', 'clear')\n    .att('@w', 'fill', colorCode)\n    .up();\n\n  return shadingFragment;\n};\n\nconst buildHighlight = (color = 'yellow') => {\n  const highlightFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'highlight')\n    .att('@w', 'val', color)\n    .up();\n\n  return highlightFragment;\n};\n\nconst buildVertAlign = (type = 'baseline') => {\n  const vertAlignFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'vertAlign')\n    .att('@w', 'val', type)\n    .up();\n\n  return vertAlignFragment;\n};\n\nconst buildStrike = () => {\n  const strikeFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'strike')\n    .att('@w', 'val', true)\n    .up();\n\n  return strikeFragment;\n};\n\nconst buildBold = () => {\n  const boldFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'b')\n    .up();\n\n  return boldFragment;\n};\n\nconst buildItalics = () => {\n  const italicsFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'i')\n    .up();\n\n  return italicsFragment;\n};\n\nconst buildUnderline = (type = 'single') => {\n  const underlineFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'u')\n    .att('@w', 'val', type)\n    .up();\n\n  return underlineFragment;\n};\n\nconst buildLineBreak = (type = 'textWrapping') => {\n  const lineBreakFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'br')\n    .att('@w', 'type', type)\n    .up();\n\n  return lineBreakFragment;\n};\n\nconst buildBorder = (\n  borderSide = 'top',\n  borderSize = 0,\n  borderSpacing = 0,\n  borderColor = fixupColorCode('black'),\n  borderStroke = 'single'\n) => {\n  const borderFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', borderSide)\n    .att('@w', 'val', borderStroke)\n    .att('@w', 'sz', borderSize)\n    .att('@w', 'space', borderSpacing)\n    .att('@w', 'color', borderColor)\n    .up();\n\n  return borderFragment;\n};\n\nconst buildTextElement = (text) => {\n  const textFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 't')\n    .att('@xml', 'space', 'preserve')\n    .txt(text)\n    .up();\n\n  return textFragment;\n};\n\nconst buildRunProperties = (attributes) => {\n  const runPropertiesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'rPr');\n  if (attributes && attributes.constructor === Object) {\n    Object.keys(attributes).forEach((key) => {\n      // eslint-disable-next-line default-case\n      switch (key) {\n        case 'strong':\n          const boldFragment = buildBold();\n          runPropertiesFragment.import(boldFragment);\n          break;\n        case 'i':\n          const italicsFragment = buildItalics();\n          runPropertiesFragment.import(italicsFragment);\n          break;\n        case 'u':\n          const underlineFragment = buildUnderline();\n          runPropertiesFragment.import(underlineFragment);\n          break;\n        case 'color':\n          const colorFragment = buildColor(attributes[key]);\n          runPropertiesFragment.import(colorFragment);\n          break;\n        case 'backgroundColor':\n          const shadingFragment = buildShading(attributes[key]);\n          runPropertiesFragment.import(shadingFragment);\n          break;\n        case 'fontSize':\n          const fontSizeFragment = buildFontSize(attributes[key]);\n          runPropertiesFragment.import(fontSizeFragment);\n          break;\n        case 'hyperlink':\n          const hyperlinkStyleFragment = buildRunStyleFragment('Hyperlink');\n          runPropertiesFragment.import(hyperlinkStyleFragment);\n          break;\n        case 'highlightColor':\n          const highlightFragment = buildHighlight(attributes[key]);\n          runPropertiesFragment.import(highlightFragment);\n          break;\n        case 'font':\n          const runFontFragment = buildRunFontFragment('Courier');\n          runPropertiesFragment.import(runFontFragment);\n          break;\n      }\n    });\n  }\n  runPropertiesFragment.up();\n\n  return runPropertiesFragment;\n};\n\n// eslint-disable-next-line consistent-return\nconst buildTextFormatting = (vNode) => {\n  // eslint-disable-next-line default-case\n  switch (vNode.tagName) {\n    case 'strong':\n    case 'b': {\n      const boldFragment = buildBold();\n      return boldFragment;\n    }\n    case 'em':\n    case 'i': {\n      const italicsFragment = buildItalics();\n      return italicsFragment;\n    }\n    case 'ins':\n    case 'u': {\n      const underlineFragment = buildUnderline();\n      return underlineFragment;\n    }\n    case 'strike':\n    case 'del':\n    case 's': {\n      const strikeFragment = buildStrike();\n      return strikeFragment;\n    }\n    case 'sub': {\n      const subscriptFragment = buildVertAlign('subscript');\n      return subscriptFragment;\n    }\n    case 'sup': {\n      const superscriptFragment = buildVertAlign('superscript');\n      return superscriptFragment;\n    }\n    case 'mark': {\n      const highlightFragment = buildHighlight();\n      return highlightFragment;\n    }\n    case 'code': {\n      const highlightFragment = buildHighlight('lightGray');\n      return highlightFragment;\n    }\n    case 'pre': {\n      const runFontFragment = buildRunFontFragment('Courier');\n      return runFontFragment;\n    }\n  }\n};\n\nconst buildRun = (vNode, attributes) => {\n  const runFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'r');\n  const runPropertiesFragment = buildRunProperties(attributes);\n\n  if (\n    isVNode(vNode) &&\n    [\n      'span',\n      'strong',\n      'b',\n      'em',\n      'i',\n      'u',\n      'ins',\n      'strike',\n      'del',\n      's',\n      'sub',\n      'sup',\n      'mark',\n      'blockquote',\n      'code',\n      'pre',\n    ].includes(vNode.tagName)\n  ) {\n    const textArray = [];\n\n    let vNodes = [vNode];\n    while (vNodes.length) {\n      const tempVNode = vNodes.shift();\n      if (isVText(tempVNode)) {\n        textArray.push(tempVNode.text);\n      }\n      if (\n        isVNode(tempVNode) &&\n        [\n          'strong',\n          'b',\n          'em',\n          'i',\n          'u',\n          'ins',\n          'strike',\n          'del',\n          's',\n          'sub',\n          'sup',\n          'mark',\n          'code',\n          'pre',\n        ].includes(tempVNode.tagName)\n      ) {\n        const formattingFragment = buildTextFormatting(tempVNode);\n        runPropertiesFragment.import(formattingFragment);\n      }\n\n      if (tempVNode.children && tempVNode.children.length) {\n        vNodes = tempVNode.children.slice().concat(vNodes);\n      }\n    }\n    if (textArray.length) {\n      const combinedString = textArray.join('');\n      // eslint-disable-next-line no-param-reassign\n      vNode = new VText(combinedString);\n    }\n  }\n\n  runFragment.import(runPropertiesFragment);\n  if (isVText(vNode)) {\n    const textFragment = buildTextElement(vNode.text);\n    runFragment.import(textFragment);\n  } else if (attributes && attributes.type === 'picture') {\n    const { type, inlineOrAnchored, ...otherAttributes } = attributes;\n    // eslint-disable-next-line no-use-before-define\n    const imageFragment = buildDrawing(inlineOrAnchored, type, otherAttributes);\n    runFragment.import(imageFragment);\n  } else if (isVNode(vNode) && vNode.tagName === 'br') {\n    const lineBreakFragment = buildLineBreak();\n    runFragment.import(lineBreakFragment);\n  }\n  runFragment.up();\n\n  return runFragment;\n};\n\n// eslint-disable-next-line consistent-return\nconst fixupLineHeight = (lineHeight, fontSize) => {\n  // FIXME: If line height is anything other than a number\n  // eslint-disable-next-line no-restricted-globals\n  if (!isNaN(lineHeight)) {\n    if (fontSize) {\n      const actualLineHeight = +lineHeight * fontSize;\n\n      return HIPToTWIP(actualLineHeight);\n    } else {\n      // 240 TWIP or 12 point is default line height\n      return +lineHeight * 240;\n    }\n  } else {\n    // 240 TWIP or 12 point is default line height\n    return 240;\n  }\n};\n\n// eslint-disable-next-line consistent-return\nconst fixupFontSize = (fontSizeString) => {\n  if (pointRegex.test(fontSizeString)) {\n    const matchedParts = fontSizeString.match(pointRegex);\n    // convert point to half point\n    return pointToHIP(matchedParts[1]);\n  } else if (pixelRegex.test(fontSizeString)) {\n    const matchedParts = fontSizeString.match(pixelRegex);\n    // convert pixels to half point\n    return pixelToHIP(matchedParts[1]);\n  }\n};\n\n// eslint-disable-next-line consistent-return\nconst fixupRowHeight = (rowHeightString) => {\n  if (pointRegex.test(rowHeightString)) {\n    const matchedParts = rowHeightString.match(pointRegex);\n    // convert point to half point\n    return pointToTWIP(matchedParts[1]);\n  } else if (pixelRegex.test(rowHeightString)) {\n    const matchedParts = rowHeightString.match(pixelRegex);\n    // convert pixels to half point\n    return pixelToTWIP(matchedParts[1]);\n  }\n};\n\nconst buildRunOrRuns = (vNode, attributes) => {\n  if (isVNode(vNode) && vNode.tagName === 'span') {\n    const runFragments = [];\n\n    for (let index = 0; index < vNode.children.length; index++) {\n      const childVNode = vNode.children[index];\n      const modifiedAttributes = { ...attributes };\n      if (isVNode(vNode) && vNode.properties && vNode.properties.style) {\n        if (\n          vNode.properties.style.color &&\n          !['transparent', 'auto'].includes(vNode.properties.style.color)\n        ) {\n          modifiedAttributes.color = fixupColorCode(vNode.properties.style.color);\n        }\n        if (\n          vNode.properties.style['background-color'] &&\n          !['transparent', 'auto'].includes(vNode.properties.style['background-color'])\n        ) {\n          modifiedAttributes.backgroundColor = fixupColorCode(\n            vNode.properties.style['background-color']\n          );\n        }\n        if (vNode.properties.style['font-size']) {\n          modifiedAttributes.fontSize = fixupFontSize(vNode.properties.style['font-size']);\n        }\n      }\n      runFragments.push(buildRun(childVNode, modifiedAttributes));\n    }\n\n    return runFragments;\n  } else {\n    const runFragment = buildRun(vNode, attributes);\n\n    return runFragment;\n  }\n};\n\nconst buildRunOrHyperLink = (vNode, attributes, docxDocumentInstance) => {\n  if (isVNode(vNode) && vNode.tagName === 'a') {\n    const relationshipId = docxDocumentInstance.createDocumentRelationships(\n      docxDocumentInstance.relationshipFilename,\n      'hyperlink',\n      vNode.properties && vNode.properties.href ? vNode.properties.href : ''\n    );\n    const hyperlinkFragment = fragment({\n      namespaceAlias: { w: namespaces.w, r: namespaces.r },\n    })\n      .ele('@w', 'hyperlink')\n      .att('@r', 'id', `rId${relationshipId}`);\n\n    const modifiedAttributes = { ...attributes };\n    modifiedAttributes.hyperlink = true;\n\n    const runFragments = buildRunOrRuns(vNode.children[0], modifiedAttributes);\n    if (Array.isArray(runFragments)) {\n      for (let index = 0; index < runFragments.length; index++) {\n        const runFragment = runFragments[index];\n\n        hyperlinkFragment.import(runFragment);\n      }\n    } else {\n      hyperlinkFragment.import(runFragments);\n    }\n    hyperlinkFragment.up();\n\n    return hyperlinkFragment;\n  }\n  const runFragments = buildRunOrRuns(vNode, attributes);\n\n  return runFragments;\n};\n\nconst buildNumberingProperties = (levelId, numberingId) => {\n  const numberingPropertiesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'numPr')\n    .ele('@w', 'ilvl')\n    .att('@w', 'val', String(levelId))\n    .up()\n    .ele('@w', 'numId')\n    .att('@w', 'val', String(numberingId))\n    .up()\n    .up();\n\n  return numberingPropertiesFragment;\n};\n\nconst buildNumberingInstances = () => {\n  const numberingInstancesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'num')\n    .ele('@w', 'abstractNumId')\n    .up()\n    .up();\n\n  return numberingInstancesFragment;\n};\n\nconst buildSpacing = (lineSpacing, beforeSpacing, afterSpacing) => {\n  const spacingFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'spacing');\n\n  if (lineSpacing) {\n    spacingFragment.att('@w', 'line', lineSpacing);\n  }\n  if (beforeSpacing) {\n    spacingFragment.att('@w', 'before', beforeSpacing);\n  }\n  if (afterSpacing) {\n    spacingFragment.att('@w', 'after', afterSpacing);\n  }\n\n  spacingFragment.att('@w', 'lineRule', 'exact').up();\n\n  return spacingFragment;\n};\n\nconst buildIndentation = (left = 720) => {\n  const indentationFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'ind')\n    .att('@w', 'left', left)\n    .up();\n\n  return indentationFragment;\n};\n\nconst buildPStyle = (style = 'Normal') => {\n  const pStyleFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'pStyle')\n    .att('@w', 'val', style)\n    .up();\n\n  return pStyleFragment;\n};\n\nconst buildHorizontalAlignment = (horizontalAlignment) => {\n  if (horizontalAlignment === 'justify') {\n    horizontalAlignment = 'both';\n  }\n  const horizontalAlignmentFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'jc')\n    .att('@w', 'val', horizontalAlignment)\n    .up();\n\n  return horizontalAlignmentFragment;\n};\n\nconst buildParagraphBorder = () => {\n  const paragraphBorderFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'pBdr');\n  const bordersObject = {\n    top: {\n      size: 0,\n      spacing: 3,\n      color: 'FFFFFF',\n    },\n    left: {\n      size: 0,\n      spacing: 3,\n      color: 'FFFFFF',\n    },\n    bottom: {\n      size: 0,\n      spacing: 3,\n      color: 'FFFFFF',\n    },\n    right: {\n      size: 0,\n      spacing: 3,\n      color: 'FFFFFF',\n    },\n  };\n\n  Object.keys(bordersObject).forEach((borderName) => {\n    if (bordersObject[borderName]) {\n      const { size, spacing, color } = bordersObject[borderName];\n\n      const borderFragment = buildBorder(borderName, size, spacing, color);\n      paragraphBorderFragment.import(borderFragment);\n    }\n  });\n\n  paragraphBorderFragment.up();\n\n  return paragraphBorderFragment;\n};\n\nconst buildParagraphProperties = (attributes) => {\n  const paragraphPropertiesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'pPr');\n  if (attributes && attributes.constructor === Object) {\n    Object.keys(attributes).forEach((key) => {\n      // eslint-disable-next-line default-case\n      switch (key) {\n        case 'numbering':\n          const { levelId, numberingId } = attributes[key];\n          const numberingPropertiesFragment = buildNumberingProperties(levelId, numberingId);\n          paragraphPropertiesFragment.import(numberingPropertiesFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.numbering;\n          break;\n        case 'textAlign':\n          const horizontalAlignmentFragment = buildHorizontalAlignment(attributes[key]);\n          paragraphPropertiesFragment.import(horizontalAlignmentFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.textAlign;\n          break;\n        case 'backgroundColor':\n          // Add shading to Paragraph Properties only if display is block\n          // Essentially if background color needs to be across the row\n          if (attributes.display === 'block') {\n            const shadingFragment = buildShading(attributes[key]);\n            paragraphPropertiesFragment.import(shadingFragment);\n            // FIXME: Inner padding in case of shaded paragraphs.\n            const paragraphBorderFragment = buildParagraphBorder();\n            paragraphPropertiesFragment.import(paragraphBorderFragment);\n            // Delete used property\n            // eslint-disable-next-line no-param-reassign\n            delete attributes.backgroundColor;\n          }\n          break;\n        case 'paragraphStyle':\n          const pStyleFragment = buildPStyle(attributes.paragraphStyle);\n          paragraphPropertiesFragment.import(pStyleFragment);\n          delete attributes.paragraphStyle;\n          break;\n        case 'indentation':\n          const indentationFragment = buildIndentation(attributes[key].left);\n          paragraphPropertiesFragment.import(indentationFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.indentation;\n          break;\n      }\n    });\n\n    const spacingFragment = buildSpacing(\n      attributes.lineHeight,\n      attributes.beforeSpacing,\n      attributes.afterSpacing\n    );\n    // Delete used properties\n    // eslint-disable-next-line no-param-reassign\n    delete attributes.lineHeight;\n    // eslint-disable-next-line no-param-reassign\n    delete attributes.beforeSpacing;\n    // eslint-disable-next-line no-param-reassign\n    delete attributes.afterSpacing;\n\n    paragraphPropertiesFragment.import(spacingFragment);\n  }\n  paragraphPropertiesFragment.up();\n\n  return paragraphPropertiesFragment;\n};\n\nconst computeImageDimensions = (vNode, attributes) => {\n  const { maximumWidth, originalWidth, originalHeight } = attributes;\n  const aspectRatio = originalWidth / originalHeight;\n  const maximumWidthInEMU = TWIPToEMU(maximumWidth);\n  let originalWidthInEMU = pixelToEMU(originalWidth);\n  let originalHeightInEMU = pixelToEMU(originalHeight);\n  if (originalWidthInEMU > maximumWidthInEMU) {\n    originalWidthInEMU = maximumWidthInEMU;\n    originalHeightInEMU = Math.round(originalWidthInEMU / aspectRatio);\n  }\n  let modifiedHeight;\n  let modifiedWidth;\n\n  if (vNode.properties && vNode.properties.style) {\n    if (vNode.properties.style.width) {\n      if (vNode.properties.style.width !== 'auto') {\n        if (pixelRegex.test(vNode.properties.style.width)) {\n          modifiedWidth = pixelToEMU(vNode.properties.style.width.match(pixelRegex)[1]);\n        } else if (percentageRegex.test(vNode.properties.style.width)) {\n          const percentageValue = vNode.properties.style.width.match(percentageRegex)[1];\n\n          modifiedWidth = Math.round((percentageValue / 100) * originalWidthInEMU);\n        }\n      } else {\n        // eslint-disable-next-line no-lonely-if\n        if (vNode.properties.style.height && vNode.properties.style.height === 'auto') {\n          modifiedWidth = originalWidthInEMU;\n          modifiedHeight = originalHeightInEMU;\n        }\n      }\n    }\n    if (vNode.properties.style.height) {\n      if (vNode.properties.style.height !== 'auto') {\n        if (pixelRegex.test(vNode.properties.style.height)) {\n          modifiedHeight = pixelToEMU(vNode.properties.style.height.match(pixelRegex)[1]);\n        } else if (percentageRegex.test(vNode.properties.style.height)) {\n          const percentageValue = vNode.properties.style.width.match(percentageRegex)[1];\n\n          modifiedHeight = Math.round((percentageValue / 100) * originalHeightInEMU);\n          if (!modifiedWidth) {\n            modifiedWidth = Math.round(modifiedHeight * aspectRatio);\n          }\n        }\n      } else {\n        // eslint-disable-next-line no-lonely-if\n        if (modifiedWidth) {\n          if (!modifiedHeight) {\n            modifiedHeight = Math.round(modifiedWidth / aspectRatio);\n          }\n        } else {\n          modifiedHeight = originalHeightInEMU;\n          modifiedWidth = originalWidthInEMU;\n        }\n      }\n    }\n    if (modifiedWidth && !modifiedHeight) {\n      modifiedHeight = Math.round(modifiedWidth / aspectRatio);\n    } else if (modifiedHeight && !modifiedWidth) {\n      modifiedWidth = Math.round(modifiedHeight * aspectRatio);\n    }\n  } else {\n    modifiedWidth = originalWidthInEMU;\n    modifiedHeight = originalHeightInEMU;\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  attributes.width = modifiedWidth;\n  // eslint-disable-next-line no-param-reassign\n  attributes.height = modifiedHeight;\n};\n\nconst buildParagraph = (vNode, attributes, docxDocumentInstance) => {\n  const paragraphFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'p');\n  const modifiedAttributes = { ...attributes };\n  if (isVNode(vNode) && vNode.properties && vNode.properties.style) {\n    if (\n      vNode.properties.style.color &&\n      !['transparent', 'auto'].includes(vNode.properties.style.color)\n    ) {\n      modifiedAttributes.color = fixupColorCode(vNode.properties.style.color);\n    }\n    if (\n      vNode.properties.style['background-color'] &&\n      !['transparent', 'auto'].includes(vNode.properties.style['background-color'])\n    ) {\n      modifiedAttributes.backgroundColor = fixupColorCode(\n        vNode.properties.style['background-color']\n      );\n    }\n    if (\n      vNode.properties.style['vertical-align'] &&\n      ['top', 'middle', 'bottom'].includes(vNode.properties.style['vertical-align'])\n    ) {\n      modifiedAttributes.verticalAlign = vNode.properties.style['vertical-align'];\n    }\n    if (\n      vNode.properties.style['text-align'] &&\n      ['left', 'right', 'center', 'justify'].includes(vNode.properties.style['text-align'])\n    ) {\n      modifiedAttributes.textAlign = vNode.properties.style['text-align'];\n    }\n    // FIXME: remove bold check when other font weights are handled.\n    if (vNode.properties.style['font-weight'] && vNode.properties.style['font-weight'] === 'bold') {\n      modifiedAttributes.strong = vNode.properties.style['font-weight'];\n    }\n    if (vNode.properties.style['font-size']) {\n      modifiedAttributes.fontSize = fixupFontSize(vNode.properties.style['font-size']);\n    }\n    if (vNode.properties.style['line-height']) {\n      modifiedAttributes.lineHeight = fixupLineHeight(\n        vNode.properties.style['line-height'],\n        vNode.properties.style['font-size']\n          ? fixupFontSize(vNode.properties.style['font-size'])\n          : null\n      );\n    }\n    if (vNode.properties.style.display) {\n      modifiedAttributes.display = vNode.properties.style.display;\n    }\n  }\n  if (isVNode(vNode) && vNode.tagName === 'blockquote') {\n    modifiedAttributes.indentation = { left: 284 };\n    modifiedAttributes.textAlign = 'justify';\n  } else if (isVNode(vNode) && vNode.tagName === 'code') {\n    modifiedAttributes.highlightColor = 'lightGray';\n  } else if (isVNode(vNode) && vNode.tagName === 'pre') {\n    modifiedAttributes.font = 'Courier';\n  }\n  const paragraphPropertiesFragment = buildParagraphProperties(modifiedAttributes);\n  paragraphFragment.import(paragraphPropertiesFragment);\n  if (isVNode(vNode) && vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    if (\n      [\n        'span',\n        'strong',\n        'b',\n        'em',\n        'i',\n        'u',\n        'ins',\n        'strike',\n        'del',\n        's',\n        'sub',\n        'sup',\n        'mark',\n        'a',\n        'code',\n        'pre',\n      ].includes(vNode.tagName)\n    ) {\n      const runOrHyperlinkFragments = buildRunOrHyperLink(\n        vNode,\n        modifiedAttributes,\n        docxDocumentInstance\n      );\n      if (Array.isArray(runOrHyperlinkFragments)) {\n        for (\n          let iteratorIndex = 0;\n          iteratorIndex < runOrHyperlinkFragments.length;\n          iteratorIndex++\n        ) {\n          const runOrHyperlinkFragment = runOrHyperlinkFragments[iteratorIndex];\n\n          paragraphFragment.import(runOrHyperlinkFragment);\n        }\n      } else {\n        paragraphFragment.import(runOrHyperlinkFragments);\n      }\n    } else if (vNode.tagName === 'blockquote') {\n      const runFragment = buildRun(vNode, attributes);\n      paragraphFragment.import(runFragment);\n    } else {\n      for (let index = 0; index < vNode.children.length; index++) {\n        const childVNode = vNode.children[index];\n        const runOrHyperlinkFragments = buildRunOrHyperLink(\n          childVNode,\n          modifiedAttributes,\n          docxDocumentInstance\n        );\n        if (Array.isArray(runOrHyperlinkFragments)) {\n          for (\n            let iteratorIndex = 0;\n            iteratorIndex < runOrHyperlinkFragments.length;\n            iteratorIndex++\n          ) {\n            const runOrHyperlinkFragment = runOrHyperlinkFragments[iteratorIndex];\n\n            paragraphFragment.import(runOrHyperlinkFragment);\n          }\n        } else {\n          paragraphFragment.import(runOrHyperlinkFragments);\n        }\n      }\n    }\n  } else {\n    // In case paragraphs has to be rendered where vText is present. Eg. table-cell\n    // Or in case the vNode is something like img\n    if (isVNode(vNode) && vNode.tagName === 'img') {\n      computeImageDimensions(vNode, modifiedAttributes);\n    }\n    const runFragments = buildRunOrRuns(vNode, modifiedAttributes);\n    if (Array.isArray(runFragments)) {\n      for (let index = 0; index < runFragments.length; index++) {\n        const runFragment = runFragments[index];\n\n        paragraphFragment.import(runFragment);\n      }\n    } else {\n      paragraphFragment.import(runFragments);\n    }\n  }\n  paragraphFragment.up();\n\n  return paragraphFragment;\n};\n\nconst buildGridSpanFragment = (spanValue) => {\n  const gridSpanFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'gridSpan')\n    .att('@w', 'val', spanValue)\n    .up();\n\n  return gridSpanFragment;\n};\n\nconst buildTableCellSpacing = (cellSpacing = 0) => {\n  const tableCellSpacingFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'tblCellSpacing')\n    .att('@w', 'w', cellSpacing)\n    .att('@w', 'type', 'dxa')\n    .up();\n\n  return tableCellSpacingFragment;\n};\n\nconst buildTableCellBorders = (tableCellBorder) => {\n  const tableCellBordersFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tcBorders');\n\n  const { color, stroke, ...borders } = tableCellBorder;\n  Object.keys(borders).forEach((border) => {\n    if (tableCellBorder[border]) {\n      const borderFragment = buildBorder(border, tableCellBorder[border], 0, color, stroke);\n      tableCellBordersFragment.import(borderFragment);\n    }\n  });\n\n  tableCellBordersFragment.up();\n\n  return tableCellBordersFragment;\n};\n\nconst buildTableCellProperties = (attributes) => {\n  const tableCellPropertiesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tcPr');\n  if (attributes && attributes.constructor === Object) {\n    Object.keys(attributes).forEach((key) => {\n      // eslint-disable-next-line default-case\n      switch (key) {\n        case 'backgroundColor':\n          const shadingFragment = buildShading(attributes[key]);\n          tableCellPropertiesFragment.import(shadingFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.backgroundColor;\n          break;\n        case 'verticalAlign':\n          const verticalAlignmentFragment = buildVerticalAlignment(attributes[key]);\n          tableCellPropertiesFragment.import(verticalAlignmentFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.verticalAlign;\n          break;\n        case 'colSpan':\n          const gridSpanFragment = buildGridSpanFragment(attributes[key]);\n          tableCellPropertiesFragment.import(gridSpanFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.colSpan;\n          break;\n        case 'tableCellBorder':\n          const tableCellBorderFragment = buildTableCellBorders(attributes[key]);\n          tableCellPropertiesFragment.import(tableCellBorderFragment);\n\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.tableCellBorder;\n          break;\n        case 'rowSpan':\n          const verticalMergeFragment = buildVerticalMerge(attributes[key]);\n          tableCellPropertiesFragment.import(verticalMergeFragment);\n\n          delete attributes.rowSpan;\n          break;\n      }\n    });\n  }\n  tableCellPropertiesFragment.up();\n\n  return tableCellPropertiesFragment;\n};\n\nconst fixupTableCellBorder = (vNode, attributes) => {\n  if (Object.prototype.hasOwnProperty.call(vNode.properties.style, 'border')) {\n    if (vNode.properties.style.border === 'none' || vNode.properties.style.border === 0) {\n      attributes.tableCellBorder = {};\n    } else {\n      // eslint-disable-next-line no-use-before-define\n      const [borderSize, borderStroke, borderColor] = cssBorderParser(\n        vNode.properties.style.border\n      );\n\n      attributes.tableCellBorder = {\n        top: borderSize,\n        left: borderSize,\n        bottom: borderSize,\n        right: borderSize,\n        color: borderColor,\n        stroke: borderStroke,\n      };\n    }\n  }\n  if (vNode.properties.style['border-top'] && vNode.properties.style['border-top'] === '0') {\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      top: 0,\n    };\n  } else if (vNode.properties.style['border-top'] && vNode.properties.style['border-top'] !== '0') {\n    // eslint-disable-next-line no-use-before-define\n    const [borderSize, borderStroke, borderColor] = cssBorderParser(\n      vNode.properties.style['border-top']\n    );\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      top: borderSize,\n      color: borderColor,\n      stroke: borderStroke,\n    };\n  }\n  if (vNode.properties.style['border-left'] && vNode.properties.style['border-left'] === '0') {\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      left: 0,\n    };\n  } else if (\n    vNode.properties.style['border-left'] &&\n    vNode.properties.style['border-left'] !== '0'\n  ) {\n    // eslint-disable-next-line no-use-before-define\n    const [borderSize, borderStroke, borderColor] = cssBorderParser(\n      vNode.properties.style['border-left']\n    );\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      left: borderSize,\n      color: borderColor,\n      stroke: borderStroke,\n    };\n  }\n  if (vNode.properties.style['border-bottom'] && vNode.properties.style['border-bottom'] === '0') {\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      bottom: 0,\n    };\n  } else if (\n    vNode.properties.style['border-bottom'] &&\n    vNode.properties.style['border-bottom'] !== '0'\n  ) {\n    // eslint-disable-next-line no-use-before-define\n    const [borderSize, borderStroke, borderColor] = cssBorderParser(\n      vNode.properties.style['border-bottom']\n    );\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      bottom: borderSize,\n      color: borderColor,\n      stroke: borderStroke,\n    };\n  }\n  if (vNode.properties.style['border-right'] && vNode.properties.style['border-right'] === '0') {\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      right: 0,\n    };\n  } else if (\n    vNode.properties.style['border-right'] &&\n    vNode.properties.style['border-right'] !== '0'\n  ) {\n    // eslint-disable-next-line no-use-before-define\n    const [borderSize, borderStroke, borderColor] = cssBorderParser(\n      vNode.properties.style['border-right']\n    );\n    attributes.tableCellBorder = {\n      ...attributes.tableCellBorder,\n      right: borderSize,\n      color: borderColor,\n      stroke: borderStroke,\n    };\n  }\n};\n\nconst buildTableCell = (vNode, attributes, rowSpanMap, columnIndex, docxDocumentInstance) => {\n  const tableCellFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tc');\n\n  const modifiedAttributes = { ...attributes };\n  if (isVNode(vNode) && vNode.properties) {\n    if (vNode.properties.rowSpan) {\n      rowSpanMap.set(columnIndex.index, { rowSpan: vNode.properties.rowSpan - 1, colSpan: 0 });\n      modifiedAttributes.rowSpan = 'restart';\n    } else {\n      const previousSpanObject = rowSpanMap.get(columnIndex.index);\n      rowSpanMap.set(\n        columnIndex.index,\n        // eslint-disable-next-line prefer-object-spread\n        Object.assign({}, previousSpanObject, {\n          rowSpan: 0,\n          colSpan: (previousSpanObject && previousSpanObject.colSpan) || 0,\n        })\n      );\n    }\n    if (\n      vNode.properties.colSpan ||\n      (vNode.properties.style && vNode.properties.style['column-span'])\n    ) {\n      modifiedAttributes.colSpan =\n        vNode.properties.colSpan ||\n        (vNode.properties.style && vNode.properties.style['column-span']);\n      const previousSpanObject = rowSpanMap.get(columnIndex.index);\n      rowSpanMap.set(\n        columnIndex.index,\n        // eslint-disable-next-line prefer-object-spread\n        Object.assign({}, previousSpanObject, {\n          colSpan: parseInt(modifiedAttributes.colSpan) || 0,\n        })\n      );\n      columnIndex.index += parseInt(modifiedAttributes.colSpan) - 1;\n    }\n    if (vNode.properties.style) {\n      if (\n        vNode.properties.style.color &&\n        !['transparent', 'auto'].includes(vNode.properties.style.color)\n      ) {\n        modifiedAttributes.color = fixupColorCode(vNode.properties.style.color);\n      }\n      if (\n        vNode.properties.style['background-color'] &&\n        !['transparent', 'auto'].includes(vNode.properties.style['background-color'])\n      ) {\n        modifiedAttributes.backgroundColor = fixupColorCode(\n          vNode.properties.style['background-color']\n        );\n      }\n      if (\n        vNode.properties.style['vertical-align'] &&\n        ['top', 'middle', 'bottom'].includes(vNode.properties.style['vertical-align'])\n      ) {\n        modifiedAttributes.verticalAlign = vNode.properties.style['vertical-align'];\n      }\n      fixupTableCellBorder(vNode, modifiedAttributes);\n    }\n  }\n  const tableCellPropertiesFragment = buildTableCellProperties(modifiedAttributes);\n  tableCellFragment.import(tableCellPropertiesFragment);\n  if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    for (let index = 0; index < vNode.children.length; index++) {\n      const childVNode = vNode.children[index];\n      if (isVNode(childVNode) && childVNode.tagName === 'img') {\n        const imageFragment = buildImage(\n          docxDocumentInstance,\n          childVNode,\n          modifiedAttributes.maximumWidth\n        );\n        if (imageFragment) {\n          tableCellFragment.import(imageFragment);\n        }\n      } else if (isVNode(childVNode) && childVNode.tagName === 'figure') {\n        if (\n          childVNode.children &&\n          Array.isArray(childVNode.children) &&\n          childVNode.children.length\n        ) {\n          // eslint-disable-next-line no-plusplus\n          for (let iteratorIndex = 0; iteratorIndex < childVNode.children.length; iteratorIndex++) {\n            const grandChildVNode = childVNode.children[iteratorIndex];\n            if (grandChildVNode.tagName === 'img') {\n              const imageFragment = buildImage(\n                docxDocumentInstance,\n                grandChildVNode,\n                modifiedAttributes.maximumWidth\n              );\n              if (imageFragment) {\n                tableCellFragment.import(imageFragment);\n              }\n            }\n          }\n        }\n      } else {\n        const paragraphFragment = buildParagraph(\n          childVNode,\n          modifiedAttributes,\n          docxDocumentInstance\n        );\n        tableCellFragment.import(paragraphFragment);\n      }\n    }\n  } else {\n    // TODO: Figure out why building with buildParagraph() isn't working\n    const paragraphFragment = fragment({\n      namespaceAlias: { w: namespaces.w },\n    })\n      .ele('@w', 'p')\n      .up();\n    tableCellFragment.import(paragraphFragment);\n  }\n  tableCellFragment.up();\n\n  return tableCellFragment;\n};\n\nconst buildRowSpanCell = (rowSpanMap, columnIndex, attributes) => {\n  const rowSpanCellFragments = [];\n  let spanObject = rowSpanMap.get(columnIndex.index);\n  while (spanObject && spanObject.rowSpan) {\n    const rowSpanCellFragment = fragment({\n      namespaceAlias: { w: namespaces.w },\n    }).ele('@w', 'tc');\n\n    const tableCellPropertiesFragment = buildTableCellProperties({\n      ...attributes,\n      rowSpan: 'continue',\n      colSpan: spanObject.colSpan ? spanObject.colSpan : 0,\n    });\n    rowSpanCellFragment.import(tableCellPropertiesFragment);\n\n    const paragraphFragment = fragment({\n      namespaceAlias: { w: namespaces.w },\n    })\n      .ele('@w', 'p')\n      .up();\n    rowSpanCellFragment.import(paragraphFragment);\n    rowSpanCellFragment.up();\n\n    rowSpanCellFragments.push(rowSpanCellFragment);\n\n    if (spanObject.rowSpan - 1 === 0) {\n      rowSpanMap.delete(columnIndex.index);\n    } else {\n      rowSpanMap.set(columnIndex.index, {\n        rowSpan: spanObject.rowSpan - 1,\n        colSpan: spanObject.colSpan || 0,\n      });\n    }\n    columnIndex.index += spanObject.colSpan || 1;\n    spanObject = rowSpanMap.get(columnIndex.index);\n  }\n\n  return rowSpanCellFragments;\n};\n\nconst buildTableRowProperties = (attributes) => {\n  const tableRowPropertiesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'trPr');\n  if (attributes && attributes.constructor === Object) {\n    Object.keys(attributes).forEach((key) => {\n      // eslint-disable-next-line default-case\n      switch (key) {\n        case 'tableRowHeight':\n          const tableRowHeightFragment = buildTableRowHeight(attributes[key]);\n          tableRowPropertiesFragment.import(tableRowHeightFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.tableRowHeight;\n          break;\n        case 'rowCantSplit':\n          if (attributes.rowCantSplit) {\n            const cantSplitFragment = fragment({\n              namespaceAlias: { w: namespaces.w },\n            })\n              .ele('@w', 'cantSplit')\n              .up();\n            tableRowPropertiesFragment.import(cantSplitFragment);\n            // Delete used property\n            // eslint-disable-next-line no-param-reassign\n            delete attributes.rowCantSplit;\n          }\n          break;\n      }\n    });\n  }\n  tableRowPropertiesFragment.up();\n  return tableRowPropertiesFragment;\n};\n\nconst buildTableRow = (vNode, attributes, rowSpanMap, docxDocumentInstance) => {\n  const tableRowFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tr');\n  const modifiedAttributes = { ...attributes };\n  if (isVNode(vNode) && vNode.properties) {\n    // FIXME: find a better way to get row height from cell style\n    if (\n      (vNode.properties.style && vNode.properties.style.height) ||\n      (vNode.children[0] &&\n        isVNode(vNode.children[0]) &&\n        vNode.children[0].properties.style &&\n        vNode.children[0].properties.style.height)\n    ) {\n      modifiedAttributes.tableRowHeight = fixupRowHeight(\n        (vNode.properties.style && vNode.properties.style.height) ||\n          (vNode.children[0] &&\n          isVNode(vNode.children[0]) &&\n          vNode.children[0].properties.style &&\n          vNode.children[0].properties.style.height\n            ? vNode.children[0].properties.style.height\n            : undefined)\n      );\n    }\n    if (vNode.properties.style) {\n      fixupTableCellBorder(vNode, modifiedAttributes);\n    }\n  }\n  const tableRowPropertiesFragment = buildTableRowProperties(modifiedAttributes);\n  tableRowFragment.import(tableRowPropertiesFragment);\n\n  const columnIndex = { index: 0 };\n\n  if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    const tableColumns = vNode.children.filter((childVNode) =>\n      ['td', 'th'].includes(childVNode.tagName)\n    );\n    const columnWidth = docxDocumentInstance.availableDocumentSpace / tableColumns.length;\n\n    for (let index = 0; index < vNode.children.length; index++) {\n      const childVNode = vNode.children[index];\n      if (['td', 'th'].includes(childVNode.tagName)) {\n        const rowSpanCellFragments = buildRowSpanCell(rowSpanMap, columnIndex, modifiedAttributes);\n        if (Array.isArray(rowSpanCellFragments)) {\n          for (\n            let iteratorIndex = 0;\n            iteratorIndex < rowSpanCellFragments.length;\n            iteratorIndex++\n          ) {\n            const rowSpanCellFragment = rowSpanCellFragments[iteratorIndex];\n\n            tableRowFragment.import(rowSpanCellFragment);\n          }\n        }\n        const tableCellFragment = buildTableCell(\n          childVNode,\n          { ...modifiedAttributes, maximumWidth: columnWidth },\n          rowSpanMap,\n          columnIndex,\n          docxDocumentInstance\n        );\n        columnIndex.index++;\n\n        tableRowFragment.import(tableCellFragment);\n      }\n    }\n  }\n  if (columnIndex.index < rowSpanMap.size) {\n    const rowSpanCellFragments = buildRowSpanCell(rowSpanMap, columnIndex, modifiedAttributes);\n    if (Array.isArray(rowSpanCellFragments)) {\n      for (let iteratorIndex = 0; iteratorIndex < rowSpanCellFragments.length; iteratorIndex++) {\n        const rowSpanCellFragment = rowSpanCellFragments[iteratorIndex];\n\n        tableRowFragment.import(rowSpanCellFragment);\n      }\n    }\n  }\n  tableRowFragment.up();\n\n  return tableRowFragment;\n};\n\nconst buildTableGridCol = (gridWidth) => {\n  const tableGridColFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'gridCol')\n    .att('@w', 'w', String(gridWidth));\n\n  return tableGridColFragment;\n};\n\nconst buildTableGrid = (vNode, attributes) => {\n  const tableGridFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tblGrid');\n  if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    const gridColumns = vNode.children.filter((childVNode) => childVNode.tagName === 'col');\n    const gridWidth = attributes.maximumWidth / gridColumns.length;\n\n    for (let index = 0; index < gridColumns.length; index++) {\n      const tableGridColFragment = buildTableGridCol(gridWidth);\n      tableGridFragment.import(tableGridColFragment);\n    }\n  }\n  tableGridFragment.up();\n\n  return tableGridFragment;\n};\n\nconst buildTableGridFromTableRow = (vNode, attributes) => {\n  const tableGridFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tblGrid');\n  if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    const numberOfGridColumns = vNode.children.reduce((accumulator, childVNode) => {\n      const colSpan =\n        childVNode.properties.colSpan ||\n        (childVNode.properties.style && childVNode.properties.style['column-span']);\n\n      return accumulator + (colSpan ? parseInt(colSpan) : 1);\n    }, 0);\n    const gridWidth = attributes.maximumWidth / numberOfGridColumns;\n\n    for (let index = 0; index < numberOfGridColumns; index++) {\n      const tableGridColFragment = buildTableGridCol(gridWidth);\n      tableGridFragment.import(tableGridColFragment);\n    }\n  }\n  tableGridFragment.up();\n\n  return tableGridFragment;\n};\n\nconst buildTableBorders = (tableBorder) => {\n  const tableBordersFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tblBorders');\n\n  const { color, stroke, ...borders } = tableBorder;\n\n  Object.keys(borders).forEach((border) => {\n    if (borders[border]) {\n      const borderFragment = buildBorder(border, borders[border], 0, color, stroke);\n      tableBordersFragment.import(borderFragment);\n    }\n  });\n\n  tableBordersFragment.up();\n\n  return tableBordersFragment;\n};\n\nconst buildTableWidth = (tableWidth) => {\n  const tableWidthFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', 'tblW')\n    .att('@w', 'type', 'dxa')\n    .att('@w', 'w', String(tableWidth))\n    .up();\n\n  return tableWidthFragment;\n};\n\nconst buildCellMargin = (side, margin) => {\n  const marginFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  })\n    .ele('@w', side)\n    .att('@w', 'type', 'dxa')\n    .att('@w', 'w', String(margin))\n    .up();\n\n  return marginFragment;\n};\n\nconst buildTableCellMargins = (margin) => {\n  const tableCellMarFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tblCellMar');\n\n  ['top', 'bottom'].forEach((side) => {\n    const marginFragment = buildCellMargin(side, margin / 2);\n    tableCellMarFragment.import(marginFragment);\n  });\n  ['left', 'right'].forEach((side) => {\n    const marginFragment = buildCellMargin(side, margin);\n    tableCellMarFragment.import(marginFragment);\n  });\n\n  return tableCellMarFragment;\n};\n\nconst buildTableProperties = (attributes) => {\n  const tablePropertiesFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tblPr');\n\n  if (attributes && attributes.constructor === Object) {\n    Object.keys(attributes).forEach((key) => {\n      // eslint-disable-next-line default-case\n      switch (key) {\n        case 'tableBorder':\n          const tableBordersFragment = buildTableBorders(attributes[key]);\n          tablePropertiesFragment.import(tableBordersFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.tableBorder;\n          break;\n        case 'tableCellSpacing':\n          const tableCellSpacingFragment = buildTableCellSpacing(attributes[key]);\n          tablePropertiesFragment.import(tableCellSpacingFragment);\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.tableCellSpacing;\n          break;\n        case 'width':\n          if (attributes[key]) {\n            const tableWidthFragment = buildTableWidth(attributes[key]);\n            tablePropertiesFragment.import(tableWidthFragment);\n          }\n          // Delete used property\n          // eslint-disable-next-line no-param-reassign\n          delete attributes.width;\n          break;\n      }\n    });\n  }\n  const tableCellMarginFragment = buildTableCellMargins(160);\n  tablePropertiesFragment.import(tableCellMarginFragment);\n\n  // by default, all tables are center aligned.\n  const alignmentFragment = buildHorizontalAlignment('center');\n  tablePropertiesFragment.import(alignmentFragment);\n\n  tablePropertiesFragment.up();\n\n  return tablePropertiesFragment;\n};\n\nconst cssBorderParser = (borderString) => {\n  let [size, stroke, color] = borderString.split(' ');\n\n  if (pointRegex.test(size)) {\n    const matchedParts = size.match(pointRegex);\n    // convert point to eighth of a point\n    size = pointToEIP(matchedParts[1]);\n  } else if (pixelRegex.test(size)) {\n    const matchedParts = size.match(pixelRegex);\n    // convert pixels to eighth of a point\n    size = pixelToEIP(matchedParts[1]);\n  }\n  stroke = stroke && ['dashed', 'dotted', 'double'].includes(stroke) ? stroke : 'single';\n\n  color = color && fixupColorCode(color).toUpperCase();\n\n  return [size, stroke, color];\n};\n\nconst buildTable = (vNode, attributes, docxDocumentInstance) => {\n  const tableFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'tbl');\n  const modifiedAttributes = { ...attributes };\n  if (isVNode(vNode) && vNode.properties) {\n    const tableAttributes = vNode.properties.attributes || {};\n    const tableStyles = vNode.properties.style || {};\n    const tableBorders = {};\n    const tableCellBorders = {};\n    let [borderSize, borderStrike, borderColor] = [2, 'single', '000000'];\n\n    // eslint-disable-next-line no-restricted-globals\n    if (!isNaN(tableAttributes.border)) {\n      borderSize = parseInt(tableAttributes.border, 10);\n    }\n\n    // css style overrides table border properties\n    if (tableStyles.border) {\n      const [cssSize, cssStroke, cssColor] = cssBorderParser(tableStyles.border);\n      borderSize = cssSize || borderSize;\n      borderColor = cssColor || borderColor;\n      borderStrike = cssStroke || borderStrike;\n    }\n\n    tableBorders.top = borderSize;\n    tableBorders.bottom = borderSize;\n    tableBorders.left = borderSize;\n    tableBorders.right = borderSize;\n    tableBorders.stroke = borderStrike;\n    tableBorders.color = borderColor;\n\n    if (tableStyles['border-collapse'] === 'collapse') {\n      tableBorders.insideV = borderSize;\n      tableBorders.insideH = borderSize;\n    } else {\n      tableBorders.insideV = 0;\n      tableBorders.insideH = 0;\n      tableCellBorders.top = 1;\n      tableCellBorders.bottom = 1;\n      tableCellBorders.left = 1;\n      tableCellBorders.right = 1;\n    }\n\n    modifiedAttributes.tableBorder = tableBorders;\n    modifiedAttributes.tableCellSpacing = 0;\n\n    if (Object.keys(tableCellBorders).length) {\n      modifiedAttributes.tableCellBorder = tableCellBorders;\n    }\n\n    let minimumWidth;\n    let maximumWidth;\n    let width;\n    // Calculate minimum width of table\n    if (pixelRegex.test(tableStyles['min-width'])) {\n      minimumWidth = pixelToTWIP(tableStyles['min-width'].match(pixelRegex)[1]);\n    } else if (percentageRegex.test(tableStyles['min-width'])) {\n      const percentageValue = tableStyles['min-width'].match(percentageRegex)[1];\n      minimumWidth = Math.round((percentageValue / 100) * attributes.maximumWidth);\n    }\n\n    // Calculate maximum width of table\n    if (pixelRegex.test(tableStyles['max-width'])) {\n      pixelRegex.lastIndex = 0;\n      maximumWidth = pixelToTWIP(tableStyles['max-width'].match(pixelRegex)[1]);\n    } else if (percentageRegex.test(tableStyles['max-width'])) {\n      percentageRegex.lastIndex = 0;\n      const percentageValue = tableStyles['max-width'].match(percentageRegex)[1];\n      maximumWidth = Math.round((percentageValue / 100) * attributes.maximumWidth);\n    }\n\n    // Calculate specified width of table\n    if (pixelRegex.test(tableStyles.width)) {\n      pixelRegex.lastIndex = 0;\n      width = pixelToTWIP(tableStyles.width.match(pixelRegex)[1]);\n    } else if (percentageRegex.test(tableStyles.width)) {\n      percentageRegex.lastIndex = 0;\n      const percentageValue = tableStyles.width.match(percentageRegex)[1];\n      width = Math.round((percentageValue / 100) * attributes.maximumWidth);\n    }\n\n    // If width isn't supplied, we should have min-width as the width.\n    if (width) {\n      modifiedAttributes.width = width;\n      if (maximumWidth) {\n        modifiedAttributes.width = Math.min(modifiedAttributes.width, maximumWidth);\n      }\n      if (minimumWidth) {\n        modifiedAttributes.width = Math.max(modifiedAttributes.width, minimumWidth);\n      }\n    } else if (minimumWidth) {\n      modifiedAttributes.width = minimumWidth;\n    }\n    if (modifiedAttributes.width) {\n      modifiedAttributes.width = Math.min(modifiedAttributes.width, attributes.maximumWidth);\n    }\n  }\n  const tablePropertiesFragment = buildTableProperties(modifiedAttributes);\n  tableFragment.import(tablePropertiesFragment);\n\n  const rowSpanMap = new Map();\n\n  if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    for (let index = 0; index < vNode.children.length; index++) {\n      const childVNode = vNode.children[index];\n      if (childVNode.tagName === 'colgroup') {\n        const tableGridFragment = buildTableGrid(childVNode, modifiedAttributes);\n        tableFragment.import(tableGridFragment);\n      } else if (childVNode.tagName === 'thead') {\n        for (let iteratorIndex = 0; iteratorIndex < childVNode.children.length; iteratorIndex++) {\n          const grandChildVNode = childVNode.children[iteratorIndex];\n          if (grandChildVNode.tagName === 'tr') {\n            if (iteratorIndex === 0) {\n              const tableGridFragment = buildTableGridFromTableRow(\n                grandChildVNode,\n                modifiedAttributes\n              );\n              tableFragment.import(tableGridFragment);\n            }\n            const tableRowFragment = buildTableRow(\n              grandChildVNode,\n              modifiedAttributes,\n              rowSpanMap,\n              docxDocumentInstance\n            );\n            tableFragment.import(tableRowFragment);\n          }\n        }\n      } else if (childVNode.tagName === 'tbody') {\n        for (let iteratorIndex = 0; iteratorIndex < childVNode.children.length; iteratorIndex++) {\n          const grandChildVNode = childVNode.children[iteratorIndex];\n          if (grandChildVNode.tagName === 'tr') {\n            if (iteratorIndex === 0) {\n              const tableGridFragment = buildTableGridFromTableRow(\n                grandChildVNode,\n                modifiedAttributes\n              );\n              tableFragment.import(tableGridFragment);\n            }\n            const tableRowFragment = buildTableRow(\n              grandChildVNode,\n              modifiedAttributes,\n              rowSpanMap,\n              docxDocumentInstance\n            );\n            tableFragment.import(tableRowFragment);\n          }\n        }\n      } else if (childVNode.tagName === 'tr') {\n        if (index === 0) {\n          const tableGridFragment = buildTableGridFromTableRow(childVNode, modifiedAttributes);\n          tableFragment.import(tableGridFragment);\n        }\n        const tableRowFragment = buildTableRow(\n          childVNode,\n          modifiedAttributes,\n          rowSpanMap,\n          docxDocumentInstance\n        );\n        tableFragment.import(tableRowFragment);\n      }\n    }\n  }\n  tableFragment.up();\n\n  return tableFragment;\n};\n\nconst buildPresetGeometry = () => {\n  const presetGeometryFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  })\n    .ele('@a', 'prstGeom')\n    .att('prst', 'rect')\n    .up();\n\n  return presetGeometryFragment;\n};\n\nconst buildExtents = ({ width, height }) => {\n  const extentsFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  })\n    .ele('@a', 'ext')\n    .att('cx', width)\n    .att('cy', height)\n    .up();\n\n  return extentsFragment;\n};\n\nconst buildOffset = () => {\n  const offsetFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  })\n    .ele('@a', 'off')\n    .att('x', '0')\n    .att('y', '0')\n    .up();\n\n  return offsetFragment;\n};\n\nconst buildGraphicFrameTransform = (attributes) => {\n  const graphicFrameTransformFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  }).ele('@a', 'xfrm');\n\n  const offsetFragment = buildOffset();\n  graphicFrameTransformFragment.import(offsetFragment);\n  const extentsFragment = buildExtents(attributes);\n  graphicFrameTransformFragment.import(extentsFragment);\n\n  graphicFrameTransformFragment.up();\n\n  return graphicFrameTransformFragment;\n};\n\nconst buildShapeProperties = (attributes) => {\n  const shapeProperties = fragment({\n    namespaceAlias: { pic: namespaces.pic },\n  }).ele('@pic', 'spPr');\n\n  const graphicFrameTransformFragment = buildGraphicFrameTransform(attributes);\n  shapeProperties.import(graphicFrameTransformFragment);\n  const presetGeometryFragment = buildPresetGeometry();\n  shapeProperties.import(presetGeometryFragment);\n\n  shapeProperties.up();\n\n  return shapeProperties;\n};\n\nconst buildFillRect = () => {\n  const fillRectFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  })\n    .ele('@a', 'fillRect')\n    .up();\n\n  return fillRectFragment;\n};\n\nconst buildStretch = () => {\n  const stretchFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  }).ele('@a', 'stretch');\n\n  const fillRectFragment = buildFillRect();\n  stretchFragment.import(fillRectFragment);\n\n  stretchFragment.up();\n\n  return stretchFragment;\n};\n\nconst buildSrcRectFragment = () => {\n  const srcRectFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  })\n    .ele('@a', 'srcRect')\n    .att('b', '0')\n    .att('l', '0')\n    .att('r', '0')\n    .att('t', '0')\n    .up();\n\n  return srcRectFragment;\n};\n\nconst buildBinaryLargeImageOrPicture = (relationshipId) => {\n  const binaryLargeImageOrPictureFragment = fragment({\n    namespaceAlias: { a: namespaces.a, r: namespaces.r },\n  })\n    .ele('@a', 'blip')\n    .att('@r', 'embed', `rId${relationshipId}`)\n    // FIXME: possible values 'email', 'none', 'print', 'hqprint', 'screen'\n    .att('cstate', 'print');\n\n  binaryLargeImageOrPictureFragment.up();\n\n  return binaryLargeImageOrPictureFragment;\n};\n\nconst buildBinaryLargeImageOrPictureFill = (relationshipId) => {\n  const binaryLargeImageOrPictureFillFragment = fragment({\n    namespaceAlias: { pic: namespaces.pic },\n  }).ele('@pic', 'blipFill');\n  const binaryLargeImageOrPictureFragment = buildBinaryLargeImageOrPicture(relationshipId);\n  binaryLargeImageOrPictureFillFragment.import(binaryLargeImageOrPictureFragment);\n  const srcRectFragment = buildSrcRectFragment();\n  binaryLargeImageOrPictureFillFragment.import(srcRectFragment);\n  const stretchFragment = buildStretch();\n  binaryLargeImageOrPictureFillFragment.import(stretchFragment);\n\n  binaryLargeImageOrPictureFillFragment.up();\n\n  return binaryLargeImageOrPictureFillFragment;\n};\n\nconst buildNonVisualPictureDrawingProperties = () => {\n  const nonVisualPictureDrawingPropertiesFragment = fragment({\n    namespaceAlias: { pic: namespaces.pic },\n  }).ele('@pic', 'cNvPicPr');\n\n  nonVisualPictureDrawingPropertiesFragment.up();\n\n  return nonVisualPictureDrawingPropertiesFragment;\n};\n\nconst buildNonVisualDrawingProperties = (\n  pictureId,\n  pictureNameWithExtension,\n  pictureDescription = ''\n) => {\n  const nonVisualDrawingPropertiesFragment = fragment({\n    namespaceAlias: { pic: namespaces.pic },\n  })\n    .ele('@pic', 'cNvPr')\n    .att('id', pictureId)\n    .att('name', pictureNameWithExtension)\n    .att('descr', pictureDescription);\n\n  nonVisualDrawingPropertiesFragment.up();\n\n  return nonVisualDrawingPropertiesFragment;\n};\n\nconst buildNonVisualPictureProperties = (\n  pictureId,\n  pictureNameWithExtension,\n  pictureDescription\n) => {\n  const nonVisualPicturePropertiesFragment = fragment({\n    namespaceAlias: { pic: namespaces.pic },\n  }).ele('@pic', 'nvPicPr');\n  // TODO: Handle picture attributes\n  const nonVisualDrawingPropertiesFragment = buildNonVisualDrawingProperties(\n    pictureId,\n    pictureNameWithExtension,\n    pictureDescription\n  );\n  nonVisualPicturePropertiesFragment.import(nonVisualDrawingPropertiesFragment);\n  const nonVisualPictureDrawingPropertiesFragment = buildNonVisualPictureDrawingProperties();\n  nonVisualPicturePropertiesFragment.import(nonVisualPictureDrawingPropertiesFragment);\n  nonVisualPicturePropertiesFragment.up();\n\n  return nonVisualPicturePropertiesFragment;\n};\n\nconst buildPicture = ({\n  id,\n  fileNameWithExtension,\n  description,\n  relationshipId,\n  width,\n  height,\n}) => {\n  const pictureFragment = fragment({\n    namespaceAlias: { pic: namespaces.pic },\n  }).ele('@pic', 'pic');\n  const nonVisualPicturePropertiesFragment = buildNonVisualPictureProperties(\n    id,\n    fileNameWithExtension,\n    description\n  );\n  pictureFragment.import(nonVisualPicturePropertiesFragment);\n  const binaryLargeImageOrPictureFill = buildBinaryLargeImageOrPictureFill(relationshipId);\n  pictureFragment.import(binaryLargeImageOrPictureFill);\n  const shapeProperties = buildShapeProperties({ width, height });\n  pictureFragment.import(shapeProperties);\n  pictureFragment.up();\n\n  return pictureFragment;\n};\n\nconst buildGraphicData = (graphicType, attributes) => {\n  const graphicDataFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  })\n    .ele('@a', 'graphicData')\n    .att('uri', 'http://schemas.openxmlformats.org/drawingml/2006/picture');\n  if (graphicType === 'picture') {\n    const pictureFragment = buildPicture(attributes);\n    graphicDataFragment.import(pictureFragment);\n  }\n  graphicDataFragment.up();\n\n  return graphicDataFragment;\n};\n\nconst buildGraphic = (graphicType, attributes) => {\n  const graphicFragment = fragment({\n    namespaceAlias: { a: namespaces.a },\n  }).ele('@a', 'graphic');\n  // TODO: Handle drawing type\n  const graphicDataFragment = buildGraphicData(graphicType, attributes);\n  graphicFragment.import(graphicDataFragment);\n  graphicFragment.up();\n\n  return graphicFragment;\n};\n\nconst buildDrawingObjectNonVisualProperties = (pictureId, pictureName) => {\n  const drawingObjectNonVisualPropertiesFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'docPr')\n    .att('id', pictureId)\n    .att('name', pictureName)\n    .up();\n\n  return drawingObjectNonVisualPropertiesFragment;\n};\n\nconst buildWrapSquare = () => {\n  const wrapSquareFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'wrapSquare')\n    .att('wrapText', 'bothSides')\n    .att('distB', '228600')\n    .att('distT', '228600')\n    .att('distL', '228600')\n    .att('distR', '228600')\n    .up();\n\n  return wrapSquareFragment;\n};\n\n// eslint-disable-next-line no-unused-vars\nconst buildWrapNone = () => {\n  const wrapNoneFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'wrapNone')\n    .up();\n\n  return wrapNoneFragment;\n};\n\nconst buildEffectExtentFragment = () => {\n  const effectExtentFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'effectExtent')\n    .att('b', '0')\n    .att('l', '0')\n    .att('r', '0')\n    .att('t', '0')\n    .up();\n\n  return effectExtentFragment;\n};\n\nconst buildExtent = ({ width, height }) => {\n  const extentFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'extent')\n    .att('cx', width)\n    .att('cy', height)\n    .up();\n\n  return extentFragment;\n};\n\nconst buildPositionV = () => {\n  const positionVFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'positionV')\n    .att('relativeFrom', 'paragraph')\n    .ele('@wp', 'posOffset')\n    .txt('19050')\n    .up()\n    .up();\n\n  return positionVFragment;\n};\n\nconst buildPositionH = () => {\n  const positionHFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'positionH')\n    .att('relativeFrom', 'column')\n    .ele('@wp', 'posOffset')\n    .txt('19050')\n    .up()\n    .up();\n\n  return positionHFragment;\n};\n\nconst buildSimplePos = () => {\n  const simplePosFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'simplePos')\n    .att('x', '0')\n    .att('y', '0')\n    .up();\n\n  return simplePosFragment;\n};\n\nconst buildAnchoredDrawing = (graphicType, attributes) => {\n  const anchoredDrawingFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'anchor')\n    .att('distB', '0')\n    .att('distL', '0')\n    .att('distR', '0')\n    .att('distT', '0')\n    .att('relativeHeight', '0')\n    .att('behindDoc', 'false')\n    .att('locked', 'true')\n    .att('layoutInCell', 'true')\n    .att('allowOverlap', 'false')\n    .att('simplePos', 'false');\n  // Even though simplePos isnt supported by Word 2007 simplePos is required.\n  const simplePosFragment = buildSimplePos();\n  anchoredDrawingFragment.import(simplePosFragment);\n  const positionHFragment = buildPositionH();\n  anchoredDrawingFragment.import(positionHFragment);\n  const positionVFragment = buildPositionV();\n  anchoredDrawingFragment.import(positionVFragment);\n  const extentFragment = buildExtent({ width: attributes.width, height: attributes.height });\n  anchoredDrawingFragment.import(extentFragment);\n  const effectExtentFragment = buildEffectExtentFragment();\n  anchoredDrawingFragment.import(effectExtentFragment);\n  const wrapSquareFragment = buildWrapSquare();\n  anchoredDrawingFragment.import(wrapSquareFragment);\n  const drawingObjectNonVisualPropertiesFragment = buildDrawingObjectNonVisualProperties(\n    attributes.id,\n    attributes.fileNameWithExtension\n  );\n  anchoredDrawingFragment.import(drawingObjectNonVisualPropertiesFragment);\n  const graphicFragment = buildGraphic(graphicType, attributes);\n  anchoredDrawingFragment.import(graphicFragment);\n\n  anchoredDrawingFragment.up();\n\n  return anchoredDrawingFragment;\n};\n\nconst buildInlineDrawing = (graphicType, attributes) => {\n  const inlineDrawingFragment = fragment({\n    namespaceAlias: { wp: namespaces.wp },\n  })\n    .ele('@wp', 'inline')\n    .att('distB', '0')\n    .att('distL', '0')\n    .att('distR', '0')\n    .att('distT', '0');\n\n  const extentFragment = buildExtent({ width: attributes.width, height: attributes.height });\n  inlineDrawingFragment.import(extentFragment);\n  const effectExtentFragment = buildEffectExtentFragment();\n  inlineDrawingFragment.import(effectExtentFragment);\n  const drawingObjectNonVisualPropertiesFragment = buildDrawingObjectNonVisualProperties(\n    attributes.id,\n    attributes.fileNameWithExtension\n  );\n  inlineDrawingFragment.import(drawingObjectNonVisualPropertiesFragment);\n  const graphicFragment = buildGraphic(graphicType, attributes);\n  inlineDrawingFragment.import(graphicFragment);\n\n  inlineDrawingFragment.up();\n\n  return inlineDrawingFragment;\n};\n\nconst buildDrawing = (inlineOrAnchored = false, graphicType, attributes) => {\n  const drawingFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  }).ele('@w', 'drawing');\n  const inlineOrAnchoredDrawingFragment = inlineOrAnchored\n    ? buildInlineDrawing(graphicType, attributes)\n    : buildAnchoredDrawing(graphicType, attributes);\n  drawingFragment.import(inlineOrAnchoredDrawingFragment);\n  drawingFragment.up();\n\n  return drawingFragment;\n};\n\nexport {\n  buildParagraph,\n  buildTable,\n  buildNumberingInstances,\n  buildLineBreak,\n  buildIndentation,\n  buildTextElement,\n  buildBold,\n  buildItalics,\n  buildUnderline,\n  buildDrawing,\n  fixupLineHeight,\n};\n","/* eslint-disable no-case-declarations */\nimport { fragment } from 'xmlbuilder2';\nimport VNode from 'virtual-dom/vnode/vnode';\nimport VText from 'virtual-dom/vnode/vtext';\nimport isVNode from 'virtual-dom/vnode/is-vnode';\nimport isVText from 'virtual-dom/vnode/is-vtext';\nimport * as HTMLToVDOM_ from 'html-to-vdom';\nimport escape from 'escape-html';\nimport sizeOf from 'image-size';\n\n// FIXME: remove the cyclic dependency\n// eslint-disable-next-line import/no-cycle\nimport * as xmlBuilder from './xml-builder';\nimport namespaces from './namespaces';\n\nconst HTMLToVDOM = HTMLToVDOM_;\nconst convertHTML = HTMLToVDOM({\n  VNode,\n  VText,\n});\n\n// eslint-disable-next-line consistent-return, no-shadow\nexport const buildImage = (docxDocumentInstance, vNode, maximumWidth = null) => {\n  let response = null;\n  try {\n    // libtidy encodes the image src\n    response = docxDocumentInstance.createMediaFile(decodeURIComponent(vNode.properties.src));\n  } catch (error) {\n    // NOOP\n  }\n  if (response) {\n    docxDocumentInstance.zip\n      .folder('word')\n      .folder('media')\n      .file(response.fileNameWithExtension, Buffer.from(response.fileContent, 'base64'), {\n        createFolders: false,\n      });\n\n    const documentRelsId = docxDocumentInstance.createDocumentRelationships(\n      docxDocumentInstance.relationshipFilename,\n      'image',\n      `media/${response.fileNameWithExtension}`,\n      'Internal'\n    );\n\n    const imageBuffer = Buffer.from(response.fileContent, 'base64');\n    const imageProperties = sizeOf(imageBuffer);\n\n    const imageFragment = xmlBuilder.buildParagraph(\n      vNode,\n      {\n        type: 'picture',\n        inlineOrAnchored: true,\n        relationshipId: documentRelsId,\n        ...response,\n        maximumWidth: maximumWidth || docxDocumentInstance.availableDocumentSpace,\n        originalWidth: imageProperties.width,\n        originalHeight: imageProperties.height,\n      },\n      docxDocumentInstance\n    );\n\n    return imageFragment;\n  }\n};\n\nexport const buildList = (vNode) => {\n  const listElements = [];\n\n  let vNodeObjects = [{ node: vNode, level: 0, type: vNode.tagName }];\n  while (vNodeObjects.length) {\n    const tempVNodeObject = vNodeObjects.shift();\n    if (\n      isVText(tempVNodeObject.node) ||\n      (isVNode(tempVNodeObject.node) && !['ul', 'ol', 'li'].includes(tempVNodeObject.node.tagName))\n    ) {\n      listElements.push({\n        node: tempVNodeObject.node,\n        level: tempVNodeObject.level,\n        type: tempVNodeObject.type,\n      });\n    }\n\n    if (\n      tempVNodeObject.node.children &&\n      tempVNodeObject.node.children.length &&\n      ['ul', 'ol', 'li'].includes(tempVNodeObject.node.tagName)\n    ) {\n      const tempVNodeObjects = tempVNodeObject.node.children.reduce((accumulator, childVNode) => {\n        if (['ul', 'ol'].includes(childVNode.tagName)) {\n          accumulator.push({\n            node: childVNode,\n            level: tempVNodeObject.level + 1,\n            type: childVNode.tagName,\n          });\n        } else {\n          // eslint-disable-next-line no-lonely-if\n          if (\n            accumulator.length > 0 &&\n            isVNode(accumulator[accumulator.length - 1].node) &&\n            accumulator[accumulator.length - 1].node.tagName.toLowerCase() === 'p'\n          ) {\n            accumulator[accumulator.length - 1].node.children.push(childVNode);\n          } else {\n            const paragraphVNode = new VNode(\n              'p',\n              null,\n              // eslint-disable-next-line no-nested-ternary\n              isVText(childVNode)\n                ? [childVNode]\n                : // eslint-disable-next-line no-nested-ternary\n                isVNode(childVNode)\n                ? childVNode.tagName.toLowerCase() === 'li'\n                  ? [...childVNode.children]\n                  : [childVNode]\n                : []\n            );\n            accumulator.push({\n              // eslint-disable-next-line prettier/prettier, no-nested-ternary\n              node: isVNode(childVNode)\n                ? // eslint-disable-next-line prettier/prettier, no-nested-ternary\n                  childVNode.tagName.toLowerCase() === 'li'\n                  ? childVNode\n                  : childVNode.tagName.toLowerCase() !== 'p'\n                  ? paragraphVNode\n                  : childVNode\n                : // eslint-disable-next-line prettier/prettier\n                  paragraphVNode,\n              level: tempVNodeObject.level,\n              type: tempVNodeObject.type,\n            });\n          }\n        }\n\n        return accumulator;\n      }, []);\n      vNodeObjects = tempVNodeObjects.concat(vNodeObjects);\n    }\n  }\n\n  return listElements;\n};\n\nfunction findXMLEquivalent(docxDocumentInstance, vNode, xmlFragment) {\n  if (\n    vNode.tagName === 'div' &&\n    (vNode.properties.attributes.class === 'page-break' ||\n      (vNode.properties.style && vNode.properties.style['page-break-after']))\n  ) {\n    const paragraphFragment = fragment({\n      namespaceAlias: { w: namespaces.w },\n    })\n      .ele('@w', 'p')\n      .ele('@w', 'r')\n      .ele('@w', 'br')\n      .att('@w', 'type', 'page')\n      .up()\n      .up()\n      .up();\n\n    xmlFragment.import(paragraphFragment);\n    return;\n  }\n\n  switch (vNode.tagName) {\n    case 'h1':\n    case 'h2':\n    case 'h3':\n    case 'h4':\n    case 'h5':\n    case 'h6':\n      const headingFragment = xmlBuilder.buildParagraph(\n        vNode,\n        {\n          paragraphStyle: `Heading${vNode.tagName[1]}`,\n        },\n        docxDocumentInstance\n      );\n      xmlFragment.import(headingFragment);\n      return;\n    case 'span':\n    case 'strong':\n    case 'b':\n    case 'em':\n    case 'i':\n    case 'u':\n    case 'ins':\n    case 'strike':\n    case 'del':\n    case 's':\n    case 'sub':\n    case 'sup':\n    case 'mark':\n    case 'p':\n    case 'a':\n    case 'blockquote':\n    case 'code':\n    case 'pre':\n      const paragraphFragment = xmlBuilder.buildParagraph(vNode, {}, docxDocumentInstance);\n      xmlFragment.import(paragraphFragment);\n      return;\n    case 'figure':\n      if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n        // eslint-disable-next-line no-plusplus\n        for (let index = 0; index < vNode.children.length; index++) {\n          const childVNode = vNode.children[index];\n          if (childVNode.tagName === 'table') {\n            const tableFragment = xmlBuilder.buildTable(\n              childVNode,\n              {\n                maximumWidth: docxDocumentInstance.availableDocumentSpace,\n                rowCantSplit: docxDocumentInstance.tableRowCantSplit,\n              },\n              docxDocumentInstance\n            );\n            xmlFragment.import(tableFragment);\n            // Adding empty paragraph for space after table\n            const emptyParagraphFragment = xmlBuilder.buildParagraph(null, {});\n            xmlFragment.import(emptyParagraphFragment);\n          } else if (childVNode.tagName === 'img') {\n            const imageFragment = buildImage(docxDocumentInstance, childVNode);\n            if (imageFragment) {\n              xmlFragment.import(imageFragment);\n            }\n          }\n        }\n      }\n      return;\n    case 'table':\n      const tableFragment = xmlBuilder.buildTable(\n        vNode,\n        {\n          maximumWidth: docxDocumentInstance.availableDocumentSpace,\n          rowCantSplit: docxDocumentInstance.tableRowCantSplit,\n        },\n        docxDocumentInstance\n      );\n      xmlFragment.import(tableFragment);\n      // Adding empty paragraph for space after table\n      const emptyParagraphFragment = xmlBuilder.buildParagraph(null, {});\n      xmlFragment.import(emptyParagraphFragment);\n      return;\n    case 'ol':\n    case 'ul':\n      const listElements = buildList(vNode);\n      const numberingId = docxDocumentInstance.createNumbering(listElements);\n      // eslint-disable-next-line no-plusplus\n      for (let index = 0; index < listElements.length; index++) {\n        const listElement = listElements[index];\n        // eslint-disable-next-line no-shadow\n        const paragraphFragment = xmlBuilder.buildParagraph(\n          listElement.node,\n          {\n            numbering: { levelId: listElement.level, numberingId },\n          },\n          docxDocumentInstance\n        );\n        xmlFragment.import(paragraphFragment);\n      }\n      return;\n    case 'img':\n      const imageFragment = buildImage(docxDocumentInstance, vNode);\n      if (imageFragment) {\n        xmlFragment.import(imageFragment);\n      }\n      return;\n    case 'br':\n      const linebreakFragment = xmlBuilder.buildParagraph(null, {});\n      xmlFragment.import(linebreakFragment);\n      return;\n    default:\n      break;\n  }\n  if (vNode.children && Array.isArray(vNode.children) && vNode.children.length) {\n    // eslint-disable-next-line no-plusplus\n    for (let index = 0; index < vNode.children.length; index++) {\n      const childVNode = vNode.children[index];\n      // eslint-disable-next-line no-use-before-define\n      convertVTreeToXML(docxDocumentInstance, childVNode, xmlFragment);\n    }\n  }\n}\n\n// eslint-disable-next-line consistent-return\nexport function convertVTreeToXML(docxDocumentInstance, vTree, xmlFragment) {\n  if (!vTree) {\n    // eslint-disable-next-line no-useless-return\n    return '';\n  }\n  if (Array.isArray(vTree) && vTree.length) {\n    // eslint-disable-next-line no-plusplus\n    for (let index = 0; index < vTree.length; index++) {\n      const vNode = vTree[index];\n      convertVTreeToXML(docxDocumentInstance, vNode, xmlFragment);\n    }\n  } else if (isVNode(vTree)) {\n    findXMLEquivalent(docxDocumentInstance, vTree, xmlFragment);\n  } else if (isVText(vTree)) {\n    xmlBuilder.buildTextElement(xmlFragment, escape(String(vTree.text)));\n  }\n  return xmlFragment;\n}\n\nfunction renderDocumentFile(docxDocumentInstance) {\n  const vTree = convertHTML(docxDocumentInstance.htmlString);\n\n  const xmlFragment = fragment({\n    namespaceAlias: { w: namespaces.w },\n  });\n\n  const populatedXmlFragment = convertVTreeToXML(docxDocumentInstance, vTree, xmlFragment);\n\n  return populatedXmlFragment;\n}\n\nexport default renderDocumentFile;\n","import { namespaces } from '../helpers';\n\nconst generateCoreXML = (\n  title = '',\n  subject = '',\n  creator = 'html-to-docx',\n  keywords = ['html-to-docx'],\n  description = '',\n  lastModifiedBy = 'html-to-docx',\n  revision = 1,\n  createdAt = new Date(),\n  modifiedAt = new Date()\n) => {\n  return `\n        <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n        <cp:coreProperties\n          xmlns:cp=\"${namespaces.coreProperties}\"\n          xmlns:dc=\"${namespaces.dc}\"\n          xmlns:dcterms=\"${namespaces.dcterms}\"\n          xmlns:dcmitype=\"${namespaces.dcmitype}\"\n          xmlns:xsi=\"${namespaces.xsi}\"\n          >\n            <dc:title>${title}</dc:title>\n            <dc:subject>${subject}</dc:subject>\n            <dc:creator>${creator}</dc:creator>\n            ${\n              keywords && Array.isArray(keywords)\n                ? `<cp:keywords>${keywords.join(', ')}</cp:keywords>`\n                : ''\n            }\n            <dc:description>${description}</dc:description>\n            <cp:lastModifiedBy>${lastModifiedBy}</cp:lastModifiedBy>\n            <cp:revision>${revision}</cp:revision>\n            <dcterms:created xsi:type=\"dcterms:W3CDTF\">${\n              createdAt instanceof Date ? createdAt.toISOString() : new Date().toISOString()\n            }</dcterms:created>\n            <dcterms:modified xsi:type=\"dcterms:W3CDTF\">${\n              modifiedAt instanceof Date ? modifiedAt.toISOString() : new Date().toISOString()\n            }</dcterms:modified>\n        </cp:coreProperties>\n    `;\n};\n\nexport default generateCoreXML;\n","import { namespaces } from '../helpers';\n\nconst documentRelsXML = `\n  <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n  <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n    <Relationship Id=\"rId1\" Type=\"${namespaces.numbering}\" Target=\"numbering.xml\"/>\n    <Relationship Id=\"rId2\" Type=\"${namespaces.styles}\" Target=\"styles.xml\"/>\n    <Relationship Id=\"rId3\" Type=\"${namespaces.settingsRelation}\" Target=\"settings.xml\"/>\n    <Relationship Id=\"rId4\" Type=\"${namespaces.webSettingsRelation}\" Target=\"webSettings.xml\"/>\n  </Relationships>\n`;\n\nexport default documentRelsXML;\n","import { namespaces } from '../helpers';\n\nconst relsXML = `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n        <Relationship Id=\"rId1\" Type=\"${namespaces.officeDocumentRelation}\" Target=\"word/document.xml\"/>\n        <Relationship Id=\"rId2\" Type=\"${namespaces.corePropertiesRelation}\" Target=\"docProps/core.xml\"/>\n    </Relationships>\n`;\n\nexport default relsXML;\n","import { namespaces } from '../helpers';\n\nconst fontTableXML = `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <w:fonts\n      xmlns:r=\"${namespaces.r}\"\n      xmlns:w=\"${namespaces.w}\"\n      >\n        <w:font w:name=\"Calibri\">\n            <w:panose1 w:val=\"020F0502020204030204\"/>\n            <w:charset w:val=\"00\"/>\n            <w:family w:val=\"swiss\"/>\n            <w:pitch w:val=\"variable\"/>\n            <w:sig w:usb0=\"E4002EFF\" w:usb1=\"C000247B\" w:usb2=\"00000009\" w:usb3=\"00000000\" w:csb0=\"000001FF\" w:csb1=\"00000000\"/>\n        </w:font>\n        <w:font w:name=\"Times New Roman\">\n            <w:panose1 w:val=\"02020603050405020304\"/>\n            <w:charset w:val=\"00\"/>\n            <w:family w:val=\"roman\"/>\n            <w:pitch w:val=\"variable\"/>\n            <w:sig w:usb0=\"E0002EFF\" w:usb1=\"C000785B\" w:usb2=\"00000009\" w:usb3=\"00000000\" w:csb0=\"000001FF\" w:csb1=\"00000000\"/>\n        </w:font>\n        <w:font w:name=\"Calibri Light\">\n            <w:panose1 w:val=\"020F0302020204030204\"/>\n            <w:charset w:val=\"00\"/>\n            <w:family w:val=\"swiss\"/>\n            <w:pitch w:val=\"variable\"/>\n            <w:sig w:usb0=\"E4002EFF\" w:usb1=\"C000247B\" w:usb2=\"00000009\" w:usb3=\"00000000\" w:csb0=\"000001FF\" w:csb1=\"00000000\"/>\n        </w:font>\n    </w:fonts>\n`;\n\nexport default fontTableXML;\n","import { namespaces } from '../helpers';\n\nconst settingsXML = `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <w:settings xmlns:w=\"${namespaces.w}\" xmlns:o=\"${namespaces.o}\" xmlns:r=\"${namespaces.r}\" xmlns:v=\"${namespaces.v}\" xmlns:w10=\"${namespaces.w10}\" xmlns:sl=\"${namespaces.sl}\">\n        <w:zoom w:percent=\"100\"/>\n        <w:defaultTabStop w:val=\"720\"/>\n        <w:decimalSymbol w:val=\".\"/>\n        <w:listSeparator w:val=\",\"/>\n    </w:settings>\n`;\n\nexport default settingsXML;\n","import { namespaces } from '../helpers';\n\nconst webSettingsXML = `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <w:webSettings xmlns:w=\"${namespaces.w}\" xmlns:r=\"${namespaces.r}\">\n    </w:webSettings>\n`;\n\nexport default webSettingsXML;\n","'use strict';\n\n// Found this seed-based random generator somewhere\n// Based on The Central Randomizer 1.3 (C) 1997 by Paul Houle (houle@msc.cornell.edu)\n\nvar seed = 1;\n\n/**\n * return a random number based on a seed\n * @param seed\n * @returns {number}\n */\nfunction getNextValue() {\n    seed = (seed * 9301 + 49297) % 233280;\n    return seed/(233280.0);\n}\n\nfunction setSeed(_seed_) {\n    seed = _seed_;\n}\n\nmodule.exports = {\n    nextValue: getNextValue,\n    seed: setSeed\n};\n","'use strict';\n\nvar randomFromSeed = require('./random/random-from-seed');\n\nvar ORIGINAL = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-';\nvar alphabet;\nvar previousSeed;\n\nvar shuffled;\n\nfunction reset() {\n    shuffled = false;\n}\n\nfunction setCharacters(_alphabet_) {\n    if (!_alphabet_) {\n        if (alphabet !== ORIGINAL) {\n            alphabet = ORIGINAL;\n            reset();\n        }\n        return;\n    }\n\n    if (_alphabet_ === alphabet) {\n        return;\n    }\n\n    if (_alphabet_.length !== ORIGINAL.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. You submitted ' + _alphabet_.length + ' characters: ' + _alphabet_);\n    }\n\n    var unique = _alphabet_.split('').filter(function(item, ind, arr){\n       return ind !== arr.lastIndexOf(item);\n    });\n\n    if (unique.length) {\n        throw new Error('Custom alphabet for shortid must be ' + ORIGINAL.length + ' unique characters. These characters were not unique: ' + unique.join(', '));\n    }\n\n    alphabet = _alphabet_;\n    reset();\n}\n\nfunction characters(_alphabet_) {\n    setCharacters(_alphabet_);\n    return alphabet;\n}\n\nfunction setSeed(seed) {\n    randomFromSeed.seed(seed);\n    if (previousSeed !== seed) {\n        reset();\n        previousSeed = seed;\n    }\n}\n\nfunction shuffle() {\n    if (!alphabet) {\n        setCharacters(ORIGINAL);\n    }\n\n    var sourceArray = alphabet.split('');\n    var targetArray = [];\n    var r = randomFromSeed.nextValue();\n    var characterIndex;\n\n    while (sourceArray.length > 0) {\n        r = randomFromSeed.nextValue();\n        characterIndex = Math.floor(r * sourceArray.length);\n        targetArray.push(sourceArray.splice(characterIndex, 1)[0]);\n    }\n    return targetArray.join('');\n}\n\nfunction getShuffled() {\n    if (shuffled) {\n        return shuffled;\n    }\n    shuffled = shuffle();\n    return shuffled;\n}\n\n/**\n * lookup shuffled letter\n * @param index\n * @returns {string}\n */\nfunction lookup(index) {\n    var alphabetShuffled = getShuffled();\n    return alphabetShuffled[index];\n}\n\nfunction get () {\n  return alphabet || ORIGINAL;\n}\n\nmodule.exports = {\n    get: get,\n    characters: characters,\n    seed: setSeed,\n    lookup: lookup,\n    shuffled: getShuffled\n};\n","'use strict';\n\nvar crypto = typeof window === 'object' && (window.crypto || window.msCrypto); // IE 11 uses window.msCrypto\n\nvar randomByte;\n\nif (!crypto || !crypto.getRandomValues) {\n    randomByte = function(size) {\n        var bytes = [];\n        for (var i = 0; i < size; i++) {\n            bytes.push(Math.floor(Math.random() * 256));\n        }\n        return bytes;\n    };\n} else {\n    randomByte = function(size) {\n        return crypto.getRandomValues(new Uint8Array(size));\n    };\n}\n\nmodule.exports = randomByte;\n","// This file replaces `format.js` in bundlers like webpack or Rollup,\n// according to `browser` config in `package.json`.\n\nmodule.exports = function (random, alphabet, size) {\n  // We cant use bytes bigger than the alphabet. To make bytes values closer\n  // to the alphabet, we apply bitmask on them. We look for the closest\n  // `2 ** x - 1` number, which will be bigger than alphabet size. If we have\n  // 30 symbols in the alphabet, we will take 31 (00011111).\n  // We do not use faster Math.clz32, because it is not available in browsers.\n  var mask = (2 << Math.log(alphabet.length - 1) / Math.LN2) - 1\n  // Bitmask is not a perfect solution (in our example it will pass 31 bytes,\n  // which is bigger than the alphabet). As a result, we will need more bytes,\n  // than ID size, because we will refuse bytes bigger than the alphabet.\n\n  // Every hardware random generator call is costly,\n  // because we need to wait for entropy collection. This is why often it will\n  // be faster to ask for few extra bytes in advance, to avoid additional calls.\n\n  // Here we calculate how many random bytes should we call in advance.\n  // It depends on ID length, mask / alphabet size and magic number 1.6\n  // (which was selected according benchmarks).\n\n  // -~f => Math.ceil(f) if n is float number\n  // -~i => i + 1 if n is integer number\n  var step = -~(1.6 * mask * size / alphabet.length)\n  var id = ''\n\n  while (true) {\n    var bytes = random(step)\n    // Compact alternative for `for (var i = 0; i < step; i++)`\n    var i = step\n    while (i--) {\n      // If random byte is bigger than alphabet even after bitmask,\n      // we refuse it by `|| ''`.\n      id += alphabet[bytes[i] & mask] || ''\n      // More compact than `id.length + 1 === size`\n      if (id.length === +size) return id\n    }\n  }\n}\n","'use strict';\n\nvar alphabet = require('./alphabet');\nvar random = require('./random/random-byte');\nvar format = require('nanoid/format');\n\nfunction generate(number) {\n    var loopCounter = 0;\n    var done;\n\n    var str = '';\n\n    while (!done) {\n        str = str + format(random, alphabet.get(), 1);\n        done = number < (Math.pow(16, loopCounter + 1 ) );\n        loopCounter++;\n    }\n    return str;\n}\n\nmodule.exports = generate;\n","'use strict';\n\nvar generate = require('./generate');\nvar alphabet = require('./alphabet');\n\n// Ignore all milliseconds before a certain time to reduce the size of the date entropy without sacrificing uniqueness.\n// This number should be updated every year or so to keep the generated id short.\n// To regenerate `new Date() - 0` and bump the version. Always bump the version!\nvar REDUCE_TIME = 1567752802062;\n\n// don't change unless we change the algos or REDUCE_TIME\n// must be an integer and less than 16\nvar version = 7;\n\n// Counter is used when shortid is called multiple times in one second.\nvar counter;\n\n// Remember the last time shortid was called in case counter is needed.\nvar previousSeconds;\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction build(clusterWorkerId) {\n    var str = '';\n\n    var seconds = Math.floor((Date.now() - REDUCE_TIME) * 0.001);\n\n    if (seconds === previousSeconds) {\n        counter++;\n    } else {\n        counter = 0;\n        previousSeconds = seconds;\n    }\n\n    str = str + generate(version);\n    str = str + generate(clusterWorkerId);\n    if (counter > 0) {\n        str = str + generate(counter);\n    }\n    str = str + generate(seconds);\n    return str;\n}\n\nmodule.exports = build;\n","'use strict';\nvar alphabet = require('./alphabet');\n\nfunction isShortId(id) {\n    if (!id || typeof id !== 'string' || id.length < 6 ) {\n        return false;\n    }\n\n    var nonAlphabetic = new RegExp('[^' +\n      alphabet.get().replace(/[|\\\\{}()[\\]^$+*?.-]/g, '\\\\$&') +\n    ']');\n    return !nonAlphabetic.test(id);\n}\n\nmodule.exports = isShortId;\n","'use strict';\n\nvar alphabet = require('./alphabet');\nvar build = require('./build');\nvar isValid = require('./is-valid');\n\n// if you are using cluster or multiple servers use this to make each instance\n// has a unique value for worker\n// Note: I don't know if this is automatically set when using third\n// party cluster solutions such as pm2.\nvar clusterWorkerId = require('./util/cluster-worker-id') || 0;\n\n/**\n * Set the seed.\n * Highly recommended if you don't want people to try to figure out your id schema.\n * exposed as shortid.seed(int)\n * @param seed Integer value to seed the random alphabet.  ALWAYS USE THE SAME SEED or you might get overlaps.\n */\nfunction seed(seedValue) {\n    alphabet.seed(seedValue);\n    return module.exports;\n}\n\n/**\n * Set the cluster worker or machine id\n * exposed as shortid.worker(int)\n * @param workerId worker must be positive integer.  Number less than 16 is recommended.\n * returns shortid module so it can be chained.\n */\nfunction worker(workerId) {\n    clusterWorkerId = workerId;\n    return module.exports;\n}\n\n/**\n *\n * sets new characters to use in the alphabet\n * returns the shuffled alphabet\n */\nfunction characters(newCharacters) {\n    if (newCharacters !== undefined) {\n        alphabet.characters(newCharacters);\n    }\n\n    return alphabet.shuffled();\n}\n\n/**\n * Generate unique id\n * Returns string id\n */\nfunction generate() {\n  return build(clusterWorkerId);\n}\n\n// Export all other functions as properties of the generate function\nmodule.exports = generate;\nmodule.exports.generate = generate;\nmodule.exports.seed = seed;\nmodule.exports.worker = worker;\nmodule.exports.characters = characters;\nmodule.exports.isValid = isValid;\n","'use strict';\nmodule.exports = require('./lib/index');\n","import { namespaces } from '../src/helpers';\n\nconst generateDocumentTemplate = (width, height, orientation, margins) => {\n  return `\n  <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <w:document\n        xmlns:a=\"${namespaces.a}\"\n        xmlns:cdr=\"${namespaces.cdr}\"\n        xmlns:o=\"${namespaces.o}\"\n        xmlns:pic=\"${namespaces.pic}\"\n        xmlns:r=\"${namespaces.r}\"\n        xmlns:v=\"${namespaces.v}\"\n        xmlns:ve=\"${namespaces.ve}\"\n        xmlns:vt=\"${namespaces.vt}\"\n        xmlns:w=\"${namespaces.w}\"\n        xmlns:w10=\"${namespaces.w10}\"\n        xmlns:wp=\"${namespaces.wp}\"\n        xmlns:wne=\"${namespaces.wne}\"\n        >\n        <w:body>\n            <w:sectPr>\n                <w:pgSz w:w=\"${width}\" w:h=\"${height}\" w:orient=\"${orientation}\" />\n                <w:pgMar w:top=\"${margins.top}\"\n                        w:right=\"${margins.right}\"\n                        w:bottom=\"${margins.bottom}\"\n                        w:left=\"${margins.left}\"\n                        w:header=\"${margins.header}\"\n                        w:footer=\"${margins.footer}\"\n                        w:gutter=\"${margins.gutter}\"/>\n            </w:sectPr>\n        </w:body>\n    </w:document>\n  `;\n};\n\nexport default generateDocumentTemplate;\n","import { create, fragment } from 'xmlbuilder2';\nimport * as shortid from 'shortid';\n\nimport {\n  generateCoreXML,\n  generateStylesXML,\n  generateNumberingXMLTemplate,\n  generateThemeXML,\n  documentRelsXML as documentRelsXMLString,\n  settingsXML as settingsXMLString,\n  webSettingsXML as webSettingsXMLString,\n  contentTypesXML as contentTypesXMLString,\n  fontTableXML as fontTableXMLString,\n  genericRelsXML as genericRelsXMLString,\n} from './schemas';\nimport { convertVTreeToXML, namespaces } from './helpers';\nimport generateDocumentTemplate from '../template/document.template';\n\nconst landscapeMargins = {\n  top: 1800,\n  right: 1440,\n  bottom: 1800,\n  left: 1440,\n  header: 720,\n  footer: 720,\n  gutter: 0,\n};\n\nconst portraitMargins = {\n  top: 1440,\n  right: 1800,\n  bottom: 1440,\n  left: 1800,\n  header: 720,\n  footer: 720,\n  gutter: 0,\n};\n\nclass DocxDocument {\n  constructor({\n    zip,\n    htmlString,\n    orientation,\n    margins,\n    title,\n    subject,\n    creator,\n    keywords,\n    description,\n    lastModifiedBy,\n    revision,\n    createdAt,\n    modifiedAt,\n    headerType,\n    header,\n    footerType,\n    footer,\n    font,\n    fontSize,\n    complexScriptFontSize,\n    table,\n    pageNumber,\n    skipFirstHeaderFooter,\n    lineNumber,\n    lineNumberOptions,\n  }) {\n    this.zip = zip;\n    this.htmlString = htmlString;\n    this.orientation = orientation;\n    this.width = orientation === 'landscape' ? 15840 : 12240;\n    this.height = orientation === 'landscape' ? 12240 : 15840;\n    this.margins =\n      // eslint-disable-next-line no-nested-ternary\n      margins && Object.keys(margins).length\n        ? margins\n        : orientation === 'landscape'\n        ? landscapeMargins\n        : portraitMargins;\n    this.availableDocumentSpace = this.width - this.margins.left - this.margins.right;\n    this.title = title || '';\n    this.subject = subject || '';\n    this.creator = creator || 'html-to-docx';\n    this.keywords = keywords || ['html-to-docx'];\n    this.description = description || '';\n    this.lastModifiedBy = lastModifiedBy || 'html-to-docx';\n    this.revision = revision || 1;\n    this.createdAt = createdAt || new Date();\n    this.modifiedAt = modifiedAt || new Date();\n    this.headerType = headerType || 'default';\n    this.header = header || false;\n    this.footerType = footerType || 'default';\n    this.footer = footer || false;\n    this.font = font || 'Times New Roman';\n    this.fontSize = fontSize || 22;\n    this.complexScriptFontSize = complexScriptFontSize || 22;\n    this.tableRowCantSplit = (table && table.row && table.row.cantSplit) || false;\n    this.pageNumber = pageNumber || false;\n    this.skipFirstHeaderFooter = skipFirstHeaderFooter || false;\n    this.lineNumber = lineNumber ? lineNumberOptions : null;\n\n    this.lastNumberingId = 0;\n    this.lastMediaId = 0;\n    this.lastHeaderId = 0;\n    this.lastFooterId = 0;\n    this.stylesObjects = [];\n    this.numberingObjects = [];\n    this.relationshipFilename = 'document';\n    this.relationships = [{ fileName: 'document', lastRelsId: 4, rels: [] }];\n    this.mediaFiles = [];\n    this.headerObjects = [];\n    this.footerObjects = [];\n    this.documentXML = null;\n\n    this.generateContentTypesXML = this.generateContentTypesXML.bind(this);\n    this.generateCoreXML = this.generateCoreXML.bind(this);\n    this.generateDocumentXML = this.generateDocumentXML.bind(this);\n    this.generateSettingsXML = this.generateSettingsXML.bind(this);\n    this.generateWebSettingsXML = this.generateWebSettingsXML.bind(this);\n    this.generateStylesXML = this.generateStylesXML.bind(this);\n    this.generateFontTableXML = this.generateFontTableXML.bind(this);\n    this.generateThemeXML = this.generateThemeXML.bind(this);\n    this.generateNumberingXML = this.generateNumberingXML.bind(this);\n    this.generateRelsXML = this.generateRelsXML.bind(this);\n    this.createMediaFile = this.createMediaFile.bind(this);\n    this.createDocumentRelationships = this.createDocumentRelationships.bind(this);\n    this.generateHeaderXML = this.generateHeaderXML.bind(this);\n    this.generateFooterXML = this.generateFooterXML.bind(this);\n  }\n\n  generateContentTypesXML() {\n    const contentTypesXML = create({ encoding: 'UTF-8', standalone: true }, contentTypesXMLString);\n\n    if (this.headerObjects && Array.isArray(this.headerObjects) && this.headerObjects.length) {\n      this.headerObjects.forEach(\n        // eslint-disable-next-line array-callback-return\n        ({ headerId }) => {\n          const contentTypesFragment = fragment({\n            defaultNamespace: {\n              ele: 'http://schemas.openxmlformats.org/package/2006/content-types',\n            },\n          })\n            .ele('Override')\n            .att('PartName', `/word/header${headerId}.xml`)\n            .att(\n              'ContentType',\n              'application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml'\n            )\n            .up();\n          contentTypesXML.root().import(contentTypesFragment);\n        }\n      );\n    }\n    if (this.footerObjects && Array.isArray(this.footerObjects) && this.footerObjects.length) {\n      this.footerObjects.forEach(\n        // eslint-disable-next-line array-callback-return\n        ({ footerId }) => {\n          const contentTypesFragment = fragment({\n            defaultNamespace: {\n              ele: 'http://schemas.openxmlformats.org/package/2006/content-types',\n            },\n          })\n            .ele('Override')\n            .att('PartName', `/word/footer${footerId}.xml`)\n            .att(\n              'ContentType',\n              'application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml'\n            )\n            .up();\n          contentTypesXML.root().import(contentTypesFragment);\n        }\n      );\n    }\n\n    return contentTypesXML.toString({ prettyPrint: true });\n  }\n\n  generateCoreXML() {\n    const coreXML = create(\n      { encoding: 'UTF-8', standalone: true },\n      generateCoreXML(\n        this.title,\n        this.subject,\n        this.creator,\n        this.keywords,\n        this.description,\n        this.lastModifiedBy,\n        this.revision,\n        this.createdAt,\n        this.modifiedAt\n      )\n    );\n\n    return coreXML.toString({ prettyPrint: true });\n  }\n\n  generateDocumentXML() {\n    const documentXML = create(\n      { encoding: 'UTF-8', standalone: true },\n      generateDocumentTemplate(this.width, this.height, this.orientation, this.margins)\n    );\n    documentXML.root().first().import(this.documentXML);\n\n    if (\n      this.header &&\n      this.headerObjects &&\n      Array.isArray(this.headerObjects) &&\n      this.headerObjects.length\n    ) {\n      const headerXmlFragment = fragment();\n\n      this.headerObjects.forEach(\n        // eslint-disable-next-line array-callback-return\n        ({ relationshipId, type }) => {\n          const headerFragment = fragment({\n            namespaceAlias: {\n              w: namespaces.w,\n              r: namespaces.r,\n            },\n          })\n            .ele('@w', 'headerReference')\n            .att('@r', 'id', `rId${relationshipId}`)\n            .att('@w', 'type', type)\n            .up();\n          headerXmlFragment.import(headerFragment);\n        }\n      );\n\n      documentXML.root().first().first().import(headerXmlFragment);\n    }\n    if (\n      this.footer &&\n      this.footerObjects &&\n      Array.isArray(this.footerObjects) &&\n      this.footerObjects.length\n    ) {\n      const footerXmlFragment = fragment();\n\n      this.footerObjects.forEach(\n        // eslint-disable-next-line array-callback-return\n        ({ relationshipId, type }) => {\n          const footerFragment = fragment({\n            namespaceAlias: {\n              w: namespaces.w,\n              r: namespaces.r,\n            },\n          })\n            .ele('@w', 'footerReference')\n            .att('@r', 'id', `rId${relationshipId}`)\n            .att('@w', 'type', type)\n            .up();\n          footerXmlFragment.import(footerFragment);\n        }\n      );\n\n      documentXML.root().first().first().import(footerXmlFragment);\n    }\n    if ((this.header || this.footer) && this.skipFirstHeaderFooter) {\n      const titlePageFragment = fragment({\n        namespaceAlias: {\n          w: namespaces.w,\n        },\n      }).ele('@w', 'titlePg');\n\n      documentXML.root().first().first().import(titlePageFragment);\n    }\n    if (this.lineNumber) {\n      const { countBy, start, restart } = this.lineNumber;\n      const lineNumberFragment = fragment({\n        namespaceAlias: {\n          w: namespaces.w,\n        },\n      })\n        .ele('@w', 'lnNumType')\n        .att('@w', 'countBy', countBy)\n        .att('@w', 'start', start)\n        .att('@w', 'restart', restart);\n      documentXML.root().first().first().import(lineNumberFragment);\n    }\n\n    return documentXML.toString({ prettyPrint: true });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  generateSettingsXML() {\n    const settingsXML = create({ encoding: 'UTF-8', standalone: true }, settingsXMLString);\n\n    return settingsXML.toString({ prettyPrint: true });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  generateWebSettingsXML() {\n    const webSettingsXML = create({ encoding: 'UTF-8', standalone: true }, webSettingsXMLString);\n\n    return webSettingsXML.toString({ prettyPrint: true });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  generateStylesXML() {\n    const stylesXML = create(\n      { encoding: 'UTF-8', standalone: true },\n      generateStylesXML(this.font, this.fontSize, this.complexScriptFontSize)\n    );\n\n    return stylesXML.toString({ prettyPrint: true });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  generateFontTableXML() {\n    const fontTableXML = create({ encoding: 'UTF-8', standalone: true }, fontTableXMLString);\n\n    return fontTableXML.toString({ prettyPrint: true });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  generateThemeXML() {\n    const themeXml = create({ encoding: 'UTF-8', standalone: true }, generateThemeXML(this.font));\n\n    return themeXml.toString({ prettyPrint: true });\n  }\n\n  generateNumberingXML() {\n    const numberingXML = create(\n      { encoding: 'UTF-8', standalone: true },\n      generateNumberingXMLTemplate()\n    );\n\n    const abstractNumberingFragments = fragment();\n    const numberingFragments = fragment();\n\n    this.numberingObjects.forEach(\n      // eslint-disable-next-line array-callback-return\n      ({ numberingId, listElements }) => {\n        const abstractNumberingFragment = fragment({\n          namespaceAlias: { w: namespaces.w },\n        })\n          .ele('@w', 'abstractNum')\n          .att('@w', 'abstractNumId', String(numberingId))\n          .ele('@w', 'multiLevelType')\n          .att('@w', 'val', 'hybridMultilevel')\n          .up();\n\n        listElements\n          .filter((value, index, self) => {\n            return self.findIndex((v) => v.level === value.level) === index;\n          })\n          .forEach(({ level, type }) => {\n            const levelFragment = fragment({\n              namespaceAlias: { w: namespaces.w },\n            })\n              .ele('@w', 'lvl')\n              .att('@w', 'ilvl', level)\n              .ele('@w', 'start')\n              .att('@w', 'val', '1')\n              .up()\n              .ele('@w', 'numFmt')\n              .att('@w', 'val', type === 'ol' ? 'decimal' : 'bullet')\n              .up()\n              .ele('@w', 'lvlText')\n              .att('@w', 'val', type === 'ol' ? `%${level + 1}` : '')\n              .up()\n              .ele('@w', 'lvlJc')\n              .att('@w', 'val', 'left')\n              .up()\n              .ele('@w', 'pPr')\n              .ele('@w', 'tabs')\n              .ele('@w', 'tab')\n              .att('@w', 'val', 'num')\n              .att('@w', 'pos', (level + 1) * 720)\n              .up()\n              .up()\n              .ele('@w', 'ind')\n              .att('@w', 'left', (level + 1) * 720)\n              .att('@w', 'hanging', 360)\n              .up()\n              .up()\n              .up();\n\n            if (type === 'ul') {\n              const runPropertiesFragment = fragment({\n                namespaceAlias: { w: namespaces.w },\n              })\n                .ele('@w', 'rPr')\n                .ele('@w', 'rFonts')\n                .att('@w', 'ascii', 'Wingdings')\n                .att('@w', 'hAnsi', 'Wingdings')\n                .att('@w', 'hint', 'default')\n                .up()\n                .up();\n\n              levelFragment.last().import(runPropertiesFragment);\n            }\n\n            abstractNumberingFragment.import(levelFragment);\n          });\n\n        abstractNumberingFragment.up();\n\n        const numberingFragment = fragment({\n          namespaceAlias: { w: namespaces.w },\n        })\n          .ele('@w', 'num')\n          .att('@w', 'numId', String(numberingId))\n          .ele('@w', 'abstractNumId')\n          .att('@w', 'val', String(numberingId))\n          .up()\n          .up();\n\n        abstractNumberingFragments.import(abstractNumberingFragment);\n        numberingFragments.import(numberingFragment);\n      }\n    );\n\n    numberingXML.root().import(abstractNumberingFragments);\n    numberingXML.root().import(numberingFragments);\n\n    return numberingXML.toString({ prettyPrint: true });\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  appendRelationships(xmlFragment, relationships) {\n    relationships.forEach(\n      // eslint-disable-next-line array-callback-return\n      ({ relationshipId, type, target, targetMode }) => {\n        const relationshipFragment = fragment({\n          defaultNamespace: { ele: 'http://schemas.openxmlformats.org/package/2006/relationships' },\n        })\n          .ele('Relationship')\n          .att('Id', `rId${relationshipId}`)\n          .att('Type', type)\n          .att('Target', target)\n          .att('TargetMode', targetMode)\n          .up();\n\n        xmlFragment.import(relationshipFragment);\n      }\n    );\n  }\n\n  generateRelsXML() {\n    const relationshipXMLStrings = this.relationships.map(({ fileName, rels }) => {\n      let xmlFragment;\n      if (fileName === 'document') {\n        xmlFragment = create({ encoding: 'UTF-8', standalone: true }, documentRelsXMLString);\n      } else {\n        xmlFragment = create({ encoding: 'UTF-8', standalone: true }, genericRelsXMLString);\n      }\n      this.appendRelationships(xmlFragment.root(), rels);\n\n      return {\n        fileName,\n        xmlString: xmlFragment.toString({ prettyPrint: true }),\n      };\n    });\n\n    return relationshipXMLStrings;\n  }\n\n  createNumbering(listElements) {\n    this.lastNumberingId += 1;\n    this.numberingObjects.push({ numberingId: this.lastNumberingId, listElements });\n\n    return this.lastNumberingId;\n  }\n\n  createMediaFile(base64String) {\n    // eslint-disable-next-line no-useless-escape\n    const matches = base64String.match(/^data:([A-Za-z-+\\/]+);base64,(.+)$/);\n    if (matches.length !== 3) {\n      throw new Error('Invalid base64 string');\n    }\n\n    const base64FileContent = matches[2];\n    // matches array contains file type in base64 format - image/jpeg and base64 stringified data\n    const fileExtension =\n      matches[1].match(/\\/(.*?)$/)[1] === 'octet-stream' ? 'png' : matches[1].match(/\\/(.*?)$/)[1];\n\n    const fileNameWithExtension = `image-${shortid.generate()}.${fileExtension}`;\n\n    this.lastMediaId += 1;\n\n    return { id: this.lastMediaId, fileContent: base64FileContent, fileNameWithExtension };\n  }\n\n  createDocumentRelationships(fileName = 'document', type, target, targetMode = 'External') {\n    let relationshipObject = this.relationships.find(\n      (relationship) => relationship.fileName === fileName\n    );\n    let lastRelsId = 1;\n    if (relationshipObject) {\n      lastRelsId = relationshipObject.lastRelsId + 1;\n      relationshipObject.lastRelsId = lastRelsId;\n    } else {\n      relationshipObject = { fileName, lastRelsId, rels: [] };\n      this.relationships.push(relationshipObject);\n    }\n    let relationshipType;\n    switch (type) {\n      case 'hyperlink':\n        relationshipType = namespaces.hyperlinks;\n        break;\n      case 'image':\n        relationshipType = namespaces.images;\n        break;\n      case 'header':\n        relationshipType = namespaces.headers;\n        break;\n      case 'footer':\n        relationshipType = namespaces.footers;\n        break;\n      case 'theme':\n        relationshipType = namespaces.themes;\n        break;\n      default:\n        break;\n    }\n\n    relationshipObject.rels.push({\n      relationshipId: lastRelsId,\n      type: relationshipType,\n      target,\n      targetMode,\n    });\n\n    return lastRelsId;\n  }\n\n  generateHeaderXML(vTree) {\n    const headerXML = create({\n      encoding: 'UTF-8',\n      standalone: true,\n      namespaceAlias: {\n        w: namespaces.w,\n        ve: namespaces.ve,\n        o: namespaces.o,\n        r: namespaces.r,\n        v: namespaces.v,\n        wp: namespaces.wp,\n        w10: namespaces.w10,\n      },\n    }).ele('@w', 'hdr');\n\n    const XMLFragment = fragment();\n    convertVTreeToXML(this, vTree, XMLFragment);\n    headerXML.root().import(XMLFragment);\n\n    this.lastHeaderId += 1;\n\n    return { headerId: this.lastHeaderId, headerXML };\n  }\n\n  generateFooterXML(vTree) {\n    const footerXML = create({\n      encoding: 'UTF-8',\n      standalone: true,\n      namespaceAlias: {\n        w: namespaces.w,\n        ve: namespaces.ve,\n        o: namespaces.o,\n        r: namespaces.r,\n        v: namespaces.v,\n        wp: namespaces.wp,\n        w10: namespaces.w10,\n      },\n    }).ele('@w', 'ftr');\n\n    const XMLFragment = fragment();\n    convertVTreeToXML(this, vTree, XMLFragment);\n    if (XMLFragment.first().node.tagName === 'p' && this.pageNumber) {\n      const fieldSimpleFragment = fragment({\n        namespaceAlias: {\n          w: namespaces.w,\n        },\n      })\n        .ele('@w', 'fldSimple')\n        .att('@w', 'instr', 'PAGE')\n        .ele('@w', 'r')\n        .up()\n        .up();\n      XMLFragment.first().import(fieldSimpleFragment);\n    }\n    footerXML.root().import(XMLFragment);\n\n    this.lastFooterId += 1;\n\n    return { footerId: this.lastFooterId, footerXML };\n  }\n}\n\nexport default DocxDocument;\n","const contentTypesXML = `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">\n        <Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />\n        <Default Extension=\"jpeg\" ContentType=\"image/jpeg\"/>\n        <Default Extension=\"png\" ContentType=\"image/png\"/>\n        <Default Extension=\"xml\" ContentType=\"application/xml\"/>\n        <Override PartName=\"/_rels/.rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>\n        <Override PartName=\"/word/_rels/document.xml.rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>\n        <Override PartName=\"/word/document.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\"/>\n        <Override PartName=\"/word/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml\"/>\n        <Override PartName=\"/word/numbering.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml\"/>\n        <Override PartName=\"/word/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/>\n        <Override PartName=\"/word/fontTable.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml\"/>\n        <Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/>\n        <Override PartName=\"/word/settings.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml\"/>\n        <Override PartName=\"/word/webSettings.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml\"/>\n    </Types>\n`;\n\nexport default contentTypesXML;\n","import { namespaces } from '../helpers';\n\nconst generateStylesXML = (font = 'Times New Roman', fontSize = 22, complexScriptFontSize = 22) => {\n  return `\n  <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n  <w:styles xmlns:w=\"${namespaces.w}\" xmlns:r=\"${namespaces.r}\">\n\t<w:docDefaults>\n\t  <w:rPrDefault>\n\t\t<w:rPr>\n\t\t  <w:rFonts w:ascii=\"${font}\" w:eastAsiaTheme=\"minorHAnsi\" w:hAnsiTheme=\"minorHAnsi\" w:cstheme=\"minorBidi\" />\n\t\t  <w:sz w:val=\"${fontSize}\" />\n\t\t  <w:szCs w:val=\"${complexScriptFontSize}\" />\n\t\t  <w:lang w:val=\"en-US\" w:eastAsia=\"en-US\" w:bidi=\"ar-SA\" />\n\t\t</w:rPr>\n\t  </w:rPrDefault>\n\t  <w:pPrDefault>\n\t\t<w:pPr>\n\t\t  <w:spacing w:after=\"120\" w:line=\"240\" w:lineRule=\"atLeast\" />\n\t\t</w:pPr>\n\t  </w:pPrDefault>\n\t</w:docDefaults>\n\t<w:style w:type=\"character\" w:styleId=\"Hyperlink\">\n\t  <w:name w:val=\"Hyperlink\" />\n\t  <w:rPr>\n\t\t<w:color w:val=\"0000FF\" />\n\t\t<w:u w:val=\"single\" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type=\"paragraph\" w:styleId=\"Heading1\">\n\t  <w:name w:val=\"heading 1\" />\n\t  <w:basedOn w:val=\"Normal\" />\n\t  <w:next w:val=\"Normal\" />\n\t  <w:uiPriority w:val=\"9\" />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before=\"480\" />\n\t\t<w:outlineLvl w:val=\"0\" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val=\"48\" />\n\t\t<w:szCs w:val=\"48\" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type=\"paragraph\" w:styleId=\"Heading2\">\n\t  <w:name w:val=\"heading 2\" />\n\t  <w:basedOn w:val=\"Normal\" />\n\t  <w:next w:val=\"Normal\" />\n\t  <w:uiPriority w:val=\"9\" />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before=\"360\" w:after=\"80\" />\n\t\t<w:outlineLvl w:val=\"1\" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val=\"36\" />\n\t\t<w:szCs w:val=\"36\" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type=\"paragraph\" w:styleId=\"Heading3\">\n\t  <w:name w:val=\"heading 3\" />\n\t  <w:basedOn w:val=\"Normal\" />\n\t  <w:next w:val=\"Normal\" />\n\t  <w:uiPriority w:val=\"9\" />\n\t  <w:semiHidden />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before=\"280\" w:after=\"80\" />\n\t\t<w:outlineLvl w:val=\"2\" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val=\"28\" />\n\t\t<w:szCs w:val=\"28\" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type=\"paragraph\" w:styleId=\"Heading4\">\n\t  <w:name w:val=\"heading 4\" />\n\t  <w:basedOn w:val=\"Normal\" />\n\t  <w:next w:val=\"Normal\" />\n\t  <w:uiPriority w:val=\"9\" />\n\t  <w:semiHidden />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before=\"240\" w:after=\"40\" />\n\t\t<w:outlineLvl w:val=\"3\" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val=\"24\" />\n\t\t<w:szCs w:val=\"24\" />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type=\"paragraph\" w:styleId=\"Heading5\">\n\t  <w:name w:val=\"heading 5\" />\n\t  <w:basedOn w:val=\"Normal\" />\n\t  <w:next w:val=\"Normal\" />\n\t  <w:uiPriority w:val=\"9\" />\n\t  <w:semiHidden />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before=\"220\" w:after=\"40\" />\n\t\t<w:outlineLvl w:val=\"4\" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t  </w:rPr>\n\t</w:style>\n\t<w:style w:type=\"paragraph\" w:styleId=\"Heading6\">\n\t  <w:name w:val=\"heading 6\" />\n\t  <w:basedOn w:val=\"Normal\" />\n\t  <w:next w:val=\"Normal\" />\n\t  <w:uiPriority w:val=\"9\" />\n\t  <w:semiHidden />\n\t  <w:unhideWhenUsed />\n\t  <w:qFormat />\n\t  <w:pPr>\n\t\t<w:keepNext />\n\t\t<w:keepLines />\n\t\t<w:spacing w:before=\"200\" w:after=\"40\" />\n\t\t<w:outlineLvl w:val=\"5\" />\n\t  </w:pPr>\n\t  <w:rPr>\n\t\t<w:b />\n\t\t<w:sz w:val=\"20\" />\n\t\t<w:szCs w:val=\"20\" />\n\t  </w:rPr>\n\t</w:style>\n  </w:styles>\n  `;\n};\n\nexport default generateStylesXML;\n","const generateThemeXML = (font = 'Times New Roman') => `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">\n    <a:themeElements>\n      <a:clrScheme name=\"Office\">\n        <a:dk1>\n          <a:sysClr val=\"windowText\" lastClr=\"000000\"/>\n        </a:dk1>\n        <a:lt1>\n          <a:sysClr val=\"window\" lastClr=\"FFFFFF\"/>\n        </a:lt1>\n        <a:dk2>\n          <a:srgbClr val=\"44546A\"/>\n        </a:dk2>\n        <a:lt2>\n          <a:srgbClr val=\"E7E6E6\"/>\n        </a:lt2>\n        <a:accent1>\n          <a:srgbClr val=\"4472C4\"/>\n        </a:accent1>\n        <a:accent2>\n          <a:srgbClr val=\"ED7D31\"/>\n        </a:accent2>\n        <a:accent3>\n          <a:srgbClr val=\"A5A5A5\"/>\n        </a:accent3>\n        <a:accent4>\n          <a:srgbClr val=\"FFC000\"/>\n        </a:accent4>\n        <a:accent5>\n          <a:srgbClr val=\"5B9BD5\"/>\n        </a:accent5>\n        <a:accent6>\n          <a:srgbClr val=\"70AD47\"/>\n        </a:accent6>\n        <a:hlink>\n          <a:srgbClr val=\"0563C1\"/>\n        </a:hlink>\n        <a:folHlink>\n          <a:srgbClr val=\"954F72\"/>\n        </a:folHlink>\n      </a:clrScheme>\n      <a:fontScheme name=\"Office\">\n        <a:majorFont>\n          <a:latin typeface=\"${font}\"/>\n          <a:ea typeface=\"${font}\"/>\n          <a:cs typeface=\"\"/>\n        </a:majorFont>\n        <a:minorFont>\n          <a:latin typeface=\"${font}\"/>\n          <a:ea typeface=\"${font}\"/>\n          <a:cs typeface=\"\"/>\n        </a:minorFont>\n      </a:fontScheme>\n      <a:fmtScheme name=\"Office\">\n        <a:fillStyleLst>\n          <a:solidFill>\n            <a:schemeClr val=\"phClr\"/>\n          </a:solidFill>\n          <a:gradFill rotWithShape=\"1\">\n            <a:gsLst>\n              <a:gs pos=\"0\">\n                <a:schemeClr val=\"phClr\">\n                  <a:lumMod val=\"110000\"/>\n                  <a:satMod val=\"105000\"/>\n                  <a:tint val=\"67000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"50000\">\n                <a:schemeClr val=\"phClr\">\n                  <a:lumMod val=\"105000\"/>\n                  <a:satMod val=\"103000\"/>\n                  <a:tint val=\"73000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"100000\">\n                <a:schemeClr val=\"phClr\">\n                  <a:lumMod val=\"105000\"/>\n                  <a:satMod val=\"109000\"/>\n                  <a:tint val=\"81000\"/>\n                </a:schemeClr>\n              </a:gs>\n            </a:gsLst>\n            <a:lin ang=\"5400000\" scaled=\"0\"/>\n          </a:gradFill>\n          <a:gradFill rotWithShape=\"1\">\n            <a:gsLst>\n              <a:gs pos=\"0\">\n                <a:schemeClr val=\"phClr\">\n                  <a:satMod val=\"103000\"/>\n                  <a:lumMod val=\"102000\"/>\n                  <a:tint val=\"94000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"50000\">\n                <a:schemeClr val=\"phClr\">\n                  <a:satMod val=\"110000\"/>\n                  <a:lumMod val=\"100000\"/>\n                  <a:shade val=\"100000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"100000\">\n                <a:schemeClr val=\"phClr\">\n                  <a:lumMod val=\"99000\"/>\n                  <a:satMod val=\"120000\"/>\n                  <a:shade val=\"78000\"/>\n                </a:schemeClr>\n              </a:gs>\n            </a:gsLst>\n            <a:lin ang=\"5400000\" scaled=\"0\"/>\n          </a:gradFill>\n        </a:fillStyleLst>\n        <a:lnStyleLst>\n          <a:ln w=\"6350\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n              <a:schemeClr val=\"phClr\"/>\n            </a:solidFill>\n            <a:prstDash val=\"solid\"/>\n            <a:miter lim=\"800000\"/>\n          </a:ln>\n          <a:ln w=\"12700\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n              <a:schemeClr val=\"phClr\"/>\n            </a:solidFill>\n            <a:prstDash val=\"solid\"/>\n            <a:miter lim=\"800000\"/>\n          </a:ln>\n          <a:ln w=\"19050\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">\n            <a:solidFill>\n              <a:schemeClr val=\"phClr\"/>\n            </a:solidFill>\n            <a:prstDash val=\"solid\"/>\n            <a:miter lim=\"800000\"/>\n          </a:ln>\n        </a:lnStyleLst>\n        <a:effectStyleLst>\n          <a:effectStyle>\n            <a:effectLst/>\n          </a:effectStyle>\n          <a:effectStyle>\n            <a:effectLst/>\n          </a:effectStyle>\n          <a:effectStyle>\n            <a:effectLst>\n              <a:outerShdw blurRad=\"57150\" dist=\"19050\" dir=\"5400000\" algn=\"ctr\" rotWithShape=\"0\">\n                <a:srgbClr val=\"000000\">\n                  <a:alpha val=\"63000\"/>\n                </a:srgbClr>\n              </a:outerShdw>\n            </a:effectLst>\n          </a:effectStyle>\n        </a:effectStyleLst>\n        <a:bgFillStyleLst>\n          <a:solidFill>\n            <a:schemeClr val=\"phClr\"/>\n          </a:solidFill>\n          <a:solidFill>\n            <a:schemeClr val=\"phClr\">\n              <a:tint val=\"95000\"/>\n              <a:satMod val=\"170000\"/>\n            </a:schemeClr>\n          </a:solidFill>\n          <a:gradFill rotWithShape=\"1\">\n            <a:gsLst>\n              <a:gs pos=\"0\">\n                <a:schemeClr val=\"phClr\">\n                  <a:tint val=\"93000\"/>\n                  <a:satMod val=\"150000\"/>\n                  <a:shade val=\"98000\"/>\n                  <a:lumMod val=\"102000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"50000\">\n                <a:schemeClr val=\"phClr\">\n                  <a:tint val=\"98000\"/>\n                  <a:satMod val=\"130000\"/>\n                  <a:shade val=\"90000\"/>\n                  <a:lumMod val=\"103000\"/>\n                </a:schemeClr>\n              </a:gs>\n              <a:gs pos=\"100000\">\n                <a:schemeClr val=\"phClr\">\n                  <a:shade val=\"63000\"/>\n                  <a:satMod val=\"120000\"/>\n                </a:schemeClr>\n              </a:gs>\n            </a:gsLst>\n            <a:lin ang=\"5400000\" scaled=\"0\"/>\n          </a:gradFill>\n        </a:bgFillStyleLst>\n      </a:fmtScheme>\n    </a:themeElements>\n  </a:theme>\n`;\n\nexport default generateThemeXML;\n","import { namespaces } from '../helpers';\n\nconst generateNumberingXMLTemplate = () => {\n  return `\n        <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n        <w:numbering\n        xmlns:w=\"${namespaces.w}\"\n        xmlns:ve=\"${namespaces.ve}\"\n        xmlns:o=\"${namespaces.o}\"\n        xmlns:r=\"${namespaces.r}\"\n        xmlns:v=\"${namespaces.v}\"\n        xmlns:wp=\"${namespaces.wp}\"\n        xmlns:w10=\"${namespaces.w10}\"\n        xmlns:wne=\"${namespaces.wne}\">\n        </w:numbering>\n    `;\n};\n\nexport default generateNumberingXMLTemplate;\n","const genericRelsXML = `\n    <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\n    <Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n    </Relationships>\n`;\n\nexport default genericRelsXML;\n","import { create } from 'xmlbuilder2';\nimport VNode from 'virtual-dom/vnode/vnode';\nimport VText from 'virtual-dom/vnode/vtext';\nimport * as HTMLToVDOM_ from 'html-to-vdom';\n\nimport { relsXML } from './schemas';\nimport DocxDocument from './docx-document';\nimport { renderDocumentFile } from './helpers';\nimport {\n  pixelRegex,\n  pixelToTWIP,\n  cmRegex,\n  cmToTWIP,\n  inchRegex,\n  inchToTWIP,\n  pointRegex,\n  pointToHIP,\n} from './utils/unit-conversion';\n\nconst HTMLToVDOM = HTMLToVDOM_;\n\nconst convertHTML = HTMLToVDOM({\n  VNode,\n  VText,\n});\n\nconst defaultDocumentOptions = {\n  orientation: 'portrait',\n  margins: {\n    top: 1440,\n    right: 1800,\n    bottom: 1440,\n    left: 1800,\n    header: 720,\n    footer: 720,\n    gutter: 0,\n  },\n  title: '',\n  subject: '',\n  creator: 'html-to-docx',\n  keywords: ['html-to-docx'],\n  description: '',\n  lastModifiedBy: 'html-to-docx',\n  revision: 1,\n  createdAt: new Date(),\n  modifiedAt: new Date(),\n  headerType: 'default',\n  header: false,\n  footerType: 'default',\n  footer: false,\n  font: 'Times New Roman',\n  fontSize: 22,\n  complexScriptFontSize: 22,\n  table: {\n    row: {\n      cantSplit: false,\n    },\n  },\n  pageNumber: false,\n  skipFirstHeaderFooter: false,\n  lineNumber: false,\n  lineNumberOptions: {\n    countBy: 1,\n    start: 0,\n    restart: 'continuous',\n  },\n};\n\nconst mergeOptions = (options, patch) => ({ ...options, ...patch });\n\nconst fixupFontSize = (fontSize) => {\n  let normalizedFontSize;\n  if (pointRegex.test(fontSize)) {\n    const matchedParts = fontSize.match(pointRegex);\n\n    normalizedFontSize = pointToHIP(matchedParts[1]);\n  } else if (fontSize) {\n    // assuming it is already in HIP\n    normalizedFontSize = fontSize;\n  } else {\n    normalizedFontSize = null;\n  }\n\n  return normalizedFontSize;\n};\n\nconst fixupMargins = (margins) => {\n  let normalizedMargins = {};\n  if (typeof margins === 'object' && margins !== null) {\n    Object.keys(margins).forEach((key) => {\n      if (pixelRegex.test(margins[key])) {\n        const matchedParts = margins[key].match(pixelRegex);\n        normalizedMargins[key] = pixelToTWIP(matchedParts[1]);\n      } else if (cmRegex.test(margins[key])) {\n        const matchedParts = margins[key].match(cmRegex);\n        normalizedMargins[key] = cmToTWIP(matchedParts[1]);\n      } else if (inchRegex.test(margins[key])) {\n        const matchedParts = margins[key].match(inchRegex);\n        normalizedMargins[key] = inchToTWIP(matchedParts[1]);\n      } else if (margins[key]) {\n        normalizedMargins[key] = margins[key];\n      } else {\n        // incase value is something like 0\n        normalizedMargins[key] = defaultDocumentOptions.margins[key];\n      }\n    });\n  } else {\n    // eslint-disable-next-line no-param-reassign\n    normalizedMargins = null;\n  }\n\n  return normalizedMargins;\n};\n\nconst normalizeDocumentOptions = (documentOptions) => {\n  const normalizedDocumentOptions = { ...documentOptions };\n  Object.keys(documentOptions).forEach((key) => {\n    // eslint-disable-next-line default-case\n    switch (key) {\n      case 'margins':\n        normalizedDocumentOptions.margins = fixupMargins(documentOptions[key]);\n        break;\n      case 'fontSize':\n      case 'complexScriptFontSize':\n        normalizedDocumentOptions[key] = fixupFontSize(documentOptions[key]);\n        break;\n    }\n  });\n\n  return normalizedDocumentOptions;\n};\n\n// Ref: https://en.wikipedia.org/wiki/Office_Open_XML_file_formats\n// http://officeopenxml.com/anatomyofOOXML.php\n// eslint-disable-next-line import/prefer-default-export\nexport function addFilesToContainer(\n  zip,\n  htmlString,\n  suppliedDocumentOptions,\n  headerHTMLString,\n  footerHTMLString\n) {\n  const normalizedDocumentOptions = normalizeDocumentOptions(suppliedDocumentOptions);\n  const documentOptions = mergeOptions(defaultDocumentOptions, normalizedDocumentOptions);\n\n  if (documentOptions.header && !headerHTMLString) {\n    // eslint-disable-next-line no-param-reassign\n    headerHTMLString = '<p></p>';\n  }\n  if (documentOptions.footer && !footerHTMLString) {\n    // eslint-disable-next-line no-param-reassign\n    footerHTMLString = '<p></p>';\n  }\n\n  const docxDocument = new DocxDocument({ zip, htmlString, ...documentOptions });\n  // Conversion to Word XML happens here\n  docxDocument.documentXML = renderDocumentFile(docxDocument);\n\n  zip\n    .folder('_rels')\n    .file(\n      '.rels',\n      create({ encoding: 'UTF-8', standalone: true }, relsXML).toString({ prettyPrint: true }),\n      { createFolders: false }\n    );\n\n  zip.folder('docProps').file('core.xml', docxDocument.generateCoreXML(), {\n    createFolders: false,\n  });\n\n  if (docxDocument.header && headerHTMLString) {\n    const vTree = convertHTML(headerHTMLString);\n\n    docxDocument.relationshipFilename = 'header1';\n    const { headerId, headerXML } = docxDocument.generateHeaderXML(vTree);\n    docxDocument.relationshipFilename = 'document';\n\n    const relationshipId = docxDocument.createDocumentRelationships(\n      docxDocument.relationshipFilename,\n      'header',\n      `header${headerId}.xml`,\n      'Internal'\n    );\n\n    zip.folder('word').file(`header${headerId}.xml`, headerXML.toString({ prettyPrint: true }), {\n      createFolders: false,\n    });\n\n    docxDocument.headerObjects.push({ headerId, relationshipId, type: docxDocument.headerType });\n  }\n  if (docxDocument.footer && footerHTMLString) {\n    const vTree = convertHTML(footerHTMLString);\n\n    docxDocument.relationshipFilename = 'footer1';\n    const { footerId, footerXML } = docxDocument.generateFooterXML(vTree);\n    docxDocument.relationshipFilename = 'document';\n\n    const relationshipId = docxDocument.createDocumentRelationships(\n      docxDocument.relationshipFilename,\n      'footer',\n      `footer${footerId}.xml`,\n      'Internal'\n    );\n\n    zip.folder('word').file(`footer${footerId}.xml`, footerXML.toString({ prettyPrint: true }), {\n      createFolders: false,\n    });\n\n    docxDocument.footerObjects.push({ footerId, relationshipId, type: docxDocument.footerType });\n  }\n\n  docxDocument.createDocumentRelationships(\n    docxDocument.relationshipFilename,\n    'theme',\n    'theme/theme1.xml',\n    'Internal'\n  );\n  zip.folder('word').folder('theme').file('theme1.xml', docxDocument.generateThemeXML(), {\n    createFolders: false,\n  });\n\n  zip\n    .folder('word')\n    .file('document.xml', docxDocument.generateDocumentXML(), {\n      createFolders: false,\n    })\n    .file('fontTable.xml', docxDocument.generateFontTableXML(), {\n      createFolders: false,\n    })\n    .file('styles.xml', docxDocument.generateStylesXML(), {\n      createFolders: false,\n    })\n    .file('numbering.xml', docxDocument.generateNumberingXML(), {\n      createFolders: false,\n    })\n    .file('settings.xml', docxDocument.generateSettingsXML(), {\n      createFolders: false,\n    })\n    .file('webSettings.xml', docxDocument.generateWebSettingsXML(), {\n      createFolders: false,\n    });\n\n  const relationshipXMLs = docxDocument.generateRelsXML();\n  if (relationshipXMLs && Array.isArray(relationshipXMLs)) {\n    relationshipXMLs.forEach(({ fileName, xmlString }) => {\n      zip.folder('word').folder('_rels').file(`${fileName}.xml.rels`, xmlString, {\n        createFolders: false,\n      });\n    });\n  }\n\n  zip.file('[Content_Types].xml', docxDocument.generateContentTypesXML(), { createFolders: false });\n\n  return zip;\n}\n","/* eslint-disable no-useless-escape */\n/* eslint-disable no-param-reassign */\nimport JSZip from 'jszip';\nimport { addFilesToContainer } from './src/html-to-docx';\n\nconst minifyHTMLString = (htmlString) => {\n  if (typeof htmlString === 'string' || htmlString instanceof String) {\n    try {\n      const minifiedHTMLString = htmlString\n        .replace(/\\n/g, ' ')\n        .replace(/\\r/g, ' ')\n        .replace(/\\r\\n/g, ' ')\n        .replace(/[\\t]+\\</g, '<')\n        .replace(/\\>[\\t ]+\\</g, '><')\n        .replace(/\\>[\\t ]+$/g, '>');\n\n      return minifiedHTMLString;\n    } catch (error) {\n      return null;\n    }\n  } else {\n    return null;\n  }\n};\n\nasync function generateContainer(\n  htmlString,\n  headerHTMLString,\n  documentOptions = {},\n  footerHTMLString\n) {\n  const zip = new JSZip();\n\n  let contentHTML = htmlString;\n  let headerHTML = headerHTMLString;\n  let footerHTML = footerHTMLString;\n  if (htmlString) {\n    contentHTML = minifyHTMLString(contentHTML);\n  }\n  if (headerHTMLString) {\n    headerHTML = minifyHTMLString(headerHTML);\n  }\n  if (footerHTMLString) {\n    footerHTML = minifyHTMLString(footerHTML);\n  }\n\n  addFilesToContainer(zip, contentHTML, documentOptions, headerHTML, footerHTML);\n\n  const buffer = await zip.generateAsync({ type: 'arraybuffer' });\n  if (Object.prototype.hasOwnProperty.call(global, 'Blob')) {\n    // eslint-disable-next-line no-undef\n    return new Blob([buffer], {\n      type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n    });\n  }\n  if (Object.prototype.hasOwnProperty.call(global, 'Buffer')) {\n    return Buffer.from(new Uint8Array(buffer));\n  }\n  throw new Error(\n    'Add blob support using a polyfill eg https://github.com/bjornstar/blob-polyfill'\n  );\n}\n\nexport default generateContainer;\n"],"names":["x","type","version","w","t","hook","hasOwnProperty","unhook","VirtualNode","noProperties","noChildren","tagName","properties","children","key","namespace","this","String","undefined","hooks","count","length","descendants","hasWidgets","hasThunks","descendantHooks","propName","property","isVHook","i","child","isVNode","isWidget","destroy","isThunk","prototype","VirtualText","text","normalizeArray","parts","allowAboveRoot","up","last","splice","unshift","splitPathRe","splitPath","filename","exec","slice","resolve","resolvedPath","resolvedAbsolute","arguments","path","TypeError","charAt","filter","split","p","join","normalize","isPathAbsolute","isAbsolute","trailingSlash","substr","extname","basename","ext","f","dirname","result","root","dir","sep","delimiter","relative","from","to","trim","arr","start","end","fromParts","toParts","Math","min","samePartsLength","outputParts","push","concat","paths","Array","call","index","xs","res","str","len","Object","create","module","ctor","superCtor","super_","constructor","value","enumerable","writable","configurable","TempCtor","EventHandlers","EventEmitter","init","$getMaxListeners","that","_maxListeners","defaultMaxListeners","emitNone","handler","isFn","self","listeners","arrayClone","emitOne","arg1","emitTwo","arg2","emitThree","arg3","emitMany","args","apply","_addListener","target","listener","prepend","m","events","existing","e","_events","newListener","emit","_eventsCount","warned","Error","name","emitter","console","warn","log","_onceWrap","fired","g","removeListener","listenerCount","evlistener","copy","usingDomains","domain","active","getPrototypeOf","setMaxListeners","n","isNaN","getMaxListeners","er","doError","error","err","context","domainEmitter","domainThrown","addListener","on","prependListener","once","prependOnceListener","list","position","originalListener","k","pop","spliceOne","removeAllListeners","keys","ret","unwrapListeners","eventNames","Reflect","ownKeys","require$$0","Queue","options","concurrency","Infinity","timeout","autostart","results","pending","session","running","jobs","timers","inherits","forEach","method","begin","reverse","clearTimers","timeoutId","clearTimeout","callOnErrorOrEnd","cb","onerror","onend","done","methodResult","defineProperty","get","job","shift","didTimeout","resultIndex","setTimeout","next","promise","then","catch","stop","exports","validate","buffer","toString","calculate","height","abs","readInt32LE","width","readUInt32LE","getSizeFromOffset","offset","readUInt8","getImageSize","imageIndex","readUInt16LE","[object Object]","nbImages","imageSize","imgs","images","ico_1","ICO","gifRegexp","signature","test","ICON_TYPE_SIZE","ICON","ICN#","icm#","icm4","icm8","ics#","ics4","ics8","is32","s8mk","icp4","icl4","icl8","il32","l8mk","icp5","ic11","ich4","ich8","ih32","h8mk","icp6","ic12","it32","t8mk","ic07","ic08","ic13","ic09","ic14","ic10","readImageHeader","imageOffset","imageLengthOffset","readUInt32BE","size","bufferLength","fileLength","imageHeader","BoxTypes","parseIHDR","box","signatureLength","ftypeBoxStart","ftypBoxLength","readUInt16BE","unit","calculateRREQLength","bits","isBigEndian","isEXIF","extractSize","validateExifBlock","exifBlock","byteAlign","EXIF_HEADER_BYTES","idfDirectoryEntries","readUInt_1","readUInt","directoryEntryNumber","block","extractOrientation","validateBuffer","orientation","chunkName","PNMTypes","P1","P2","P3","P4","P5","P6","P7","PF","Signatures","handlers","default","lines","dimensions","line","parseInt","pam","charCodeAt","toLowerCase","includes","svgReg","extractorRegExps","viewbox","units","cm","em","ex","mm","pc","pt","parseLength","round","parseFloat","parseViewbox","bounds","match","attrs","parseAttributes","calculateByDimensions","ratio","floor","calculateByViewbox","readValue","low","nextTag","signatures","filepath","determineEndianness","tags","temp","code","extractTags","ifdOffset","bufferSize","fileSize","fs","statSync","endBuffer","Buffer","alloc","descriptor","openSync","readSync","readIFD","riffHeader","webpHeader","vp8Header","chunkHeader","extendedHeader","validEnd","readUIntLE","calculateExtended","readInt16LE","calculateLossy","calculateLossless","bmp","bmp_1","BMP","cur","cur_1","CUR","dds","dds_1","DDS","gif","gif_1","GIF","icns","icns_1","ICNS","ico","j2c","j2c_1","J2C","jp2","jp2_1","JP2","jpg","jpg_1","JPG","ktx","ktx_1","KTX","png","png_1","PNG","pnm","pnm_1","PNM","psd","psd_1","PSD","svg","svg_1","SVG","tiff","tiff_1","TIFF","webp","webp_1","WEBP","types_1","typeHandlers","firstBytes","56","66","68","71","73","77","82","105","137","255","byte","find","FileHandle","fd","Promise","reject","fstat","stats","read","close","open","flags","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","rejected","queue","queue_1","lookup","detector_1","detector","input","callback","isBuffer","fstatSync","closeSync","syncFileToBuffer","handle","promises","stat","asyncFileToBuffer","process","nextTick","c","namespaces","rgbRegex","hslRegex","hexRegex","hex3Regex","rgbToHex","red","green","blue","map","pixelRegex","percentageRegex","pointRegex","cmRegex","inchRegex","pixelToEMU","pixelValue","EMUToTWIP","EMUValue","pointToTWIP","pointValue","pointToHIP","pixelToTWIP","pixelToHIP","TWIPValue","inchToTWIP","inchValue","inchToPoint","pixelToPoint","HIPValue","pointToEIP","PointValue","fixupColorCode","colorCodeString","colorNames","matchedParts","hue","saturation","luminosity","hue2rgb","q","hex","hslToHex","hex3ToHex","buildRunFontFragment","fontName","fragment","namespaceAlias","ele","att","buildShading","colorCode","buildHighlight","color","buildVertAlign","buildBold","buildItalics","buildUnderline","buildBorder","borderSide","borderSize","borderSpacing","borderColor","borderStroke","buildTextElement","txt","buildRunProperties","attributes","runPropertiesFragment","boldFragment","import","italicsFragment","underlineFragment","colorFragment","shadingFragment","fontSizeFragment","fontSize","hyperlinkStyleFragment","buildRunStyleFragment","highlightFragment","runFontFragment","buildTextFormatting","vNode","buildRun","runFragment","textArray","vNodes","tempVNode","isVText","formattingFragment","combinedString","VText","textFragment","inlineOrAnchored","otherAttributes","imageFragment","buildDrawing","lineBreakFragment","buildLineBreak","fixupLineHeight","lineHeight","fixupFontSize","fontSizeString","buildRunOrRuns","runFragments","childVNode","modifiedAttributes","style","backgroundColor","buildRunOrHyperLink","docxDocumentInstance","relationshipId","createDocumentRelationships","relationshipFilename","href","hyperlinkFragment","r","hyperlink","isArray","buildHorizontalAlignment","horizontalAlignment","buildParagraphProperties","paragraphPropertiesFragment","levelId","numberingId","numberingPropertiesFragment","buildNumberingProperties","numbering","horizontalAlignmentFragment","textAlign","display","paragraphBorderFragment","bordersObject","top","spacing","left","bottom","right","borderName","borderFragment","buildParagraphBorder","pStyleFragment","buildPStyle","paragraphStyle","indentationFragment","buildIndentation","indentation","spacingFragment","lineSpacing","beforeSpacing","afterSpacing","buildSpacing","computeImageDimensions","maximumWidth","originalWidth","originalHeight","aspectRatio","maximumWidthInEMU","modifiedHeight","modifiedWidth","originalWidthInEMU","originalHeightInEMU","percentageValue","buildParagraph","paragraphFragment","verticalAlign","strong","highlightColor","font","runOrHyperlinkFragments","iteratorIndex","runOrHyperlinkFragment","buildTableCellProperties","tableCellPropertiesFragment","verticalAlignmentFragment","verticalAlignment","buildVerticalAlignment","gridSpanFragment","spanValue","colSpan","tableCellBorderFragment","tableCellBorder","tableCellBordersFragment","stroke","borders","border","buildTableCellBorders","verticalMergeFragment","verticalMerge","buildVerticalMerge","rowSpan","fixupTableCellBorder","cssBorderParser","buildTableCell","rowSpanMap","columnIndex","tableCellFragment","set","previousSpanObject","assign","buildImage","grandChildVNode","buildRowSpanCell","rowSpanCellFragments","spanObject","rowSpanCellFragment","delete","buildTableRowProperties","tableRowPropertiesFragment","tableRowHeightFragment","tableRowHeight","rowCantSplit","cantSplitFragment","buildTableRow","tableRowFragment","rowHeightString","fixupRowHeight","tableColumns","columnWidth","availableDocumentSpace","buildTableGridCol","gridWidth","buildTableGrid","tableGridFragment","gridColumns","tableGridColFragment","buildTableGridFromTableRow","numberOfGridColumns","reduce","accumulator","buildCellMargin","side","margin","buildTableProperties","tablePropertiesFragment","tableBordersFragment","tableBorder","buildTableBorders","tableCellSpacingFragment","cellSpacing","buildTableCellSpacing","tableCellSpacing","tableWidthFragment","tableWidth","tableCellMarginFragment","tableCellMarFragment","marginFragment","buildTableCellMargins","alignmentFragment","borderString","toUpperCase","buildTable","tableFragment","tableAttributes","tableStyles","tableBorders","tableCellBorders","minimumWidth","borderStrike","cssSize","cssStroke","cssColor","insideV","insideH","lastIndex","max","Map","buildGraphicFrameTransform","graphicFrameTransformFragment","a","offsetFragment","extentsFragment","buildExtents","buildShapeProperties","shapeProperties","pic","presetGeometryFragment","buildStretch","stretchFragment","fillRectFragment","buildBinaryLargeImageOrPictureFill","binaryLargeImageOrPictureFillFragment","binaryLargeImageOrPictureFragment","buildBinaryLargeImageOrPicture","srcRectFragment","buildNonVisualPictureProperties","pictureId","pictureNameWithExtension","pictureDescription","nonVisualPicturePropertiesFragment","nonVisualDrawingPropertiesFragment","buildNonVisualDrawingProperties","nonVisualPictureDrawingPropertiesFragment","buildNonVisualPictureDrawingProperties","buildGraphicData","graphicType","graphicDataFragment","pictureFragment","id","fileNameWithExtension","description","binaryLargeImageOrPictureFill","buildPicture","buildGraphic","graphicFragment","buildDrawingObjectNonVisualProperties","pictureName","wp","buildEffectExtentFragment","buildExtent","buildAnchoredDrawing","anchoredDrawingFragment","simplePosFragment","positionHFragment","positionVFragment","extentFragment","effectExtentFragment","wrapSquareFragment","drawingObjectNonVisualPropertiesFragment","drawingFragment","inlineOrAnchoredDrawingFragment","inlineDrawingFragment","buildInlineDrawing","convertHTML","HTMLToVDOM_","VNode","response","createMediaFile","decodeURIComponent","src","zip","folder","file","fileContent","createFolders","documentRelsId","imageBuffer","imageProperties","sizeOf","xmlBuilder.buildParagraph","findXMLEquivalent","xmlFragment","class","headingFragment","xmlBuilder.buildTable","tableRowCantSplit","emptyParagraphFragment","listElements","vNodeObjects","node","level","tempVNodeObject","paragraphVNode","buildList","createNumbering","listElement","linebreakFragment","convertVTreeToXML","vTree","xmlBuilder.buildTextElement","escape","documentRelsXML","relsXML","fontTableXML","settingsXML","webSettingsXML","seed","alphabet","previousSeed","shuffled","nextValue","_seed_","ORIGINAL","reset","setCharacters","_alphabet_","unique","item","ind","lastIndexOf","getShuffled","characterIndex","sourceArray","targetArray","randomFromSeed","shuffle","characters","crypto","window","msCrypto","getRandomValues","Uint8Array","bytes","random","mask","LN2","counter","previousSeconds","number","loopCounter","format","pow","clusterWorkerId","seconds","Date","now","generate","RegExp","replace","build","seedValue","workerId","newCharacters","isValid","landscapeMargins","header","footer","gutter","portraitMargins","DocxDocument","htmlString","margins","title","subject","creator","keywords","lastModifiedBy","revision","createdAt","modifiedAt","headerType","footerType","complexScriptFontSize","table","pageNumber","skipFirstHeaderFooter","lineNumber","lineNumberOptions","row","cantSplit","lastNumberingId","lastMediaId","lastHeaderId","lastFooterId","stylesObjects","numberingObjects","relationships","fileName","lastRelsId","rels","mediaFiles","headerObjects","footerObjects","documentXML","generateContentTypesXML","bind","generateCoreXML","generateDocumentXML","generateSettingsXML","generateWebSettingsXML","generateStylesXML","generateFontTableXML","generateThemeXML","generateNumberingXML","generateRelsXML","generateHeaderXML","generateFooterXML","contentTypesXML","encoding","standalone","headerId","contentTypesFragment","defaultNamespace","footerId","prettyPrint","toISOString","first","headerXmlFragment","headerFragment","footerXmlFragment","footerFragment","titlePageFragment","countBy","restart","lineNumberFragment","settingsXMLString","webSettingsXMLString","fontTableXMLString","numberingXML","abstractNumberingFragments","numberingFragments","abstractNumberingFragment","findIndex","v","levelFragment","numberingFragment","targetMode","relationshipFragment","documentRelsXMLString","appendRelationships","xmlString","base64String","matches","base64FileContent","fileExtension","shortid.generate","relationshipType","relationshipObject","relationship","headerXML","ve","o","w10","XMLFragment","footerXML","fieldSimpleFragment","defaultDocumentOptions","fixupMargins","normalizedMargins","cmValue","cmToInch","normalizeDocumentOptions","documentOptions","normalizedDocumentOptions","normalizedFontSize","addFilesToContainer","suppliedDocumentOptions","headerHTMLString","footerHTMLString","patch","docxDocument","relationshipXMLs","minifyHTMLString","async","JSZip","contentHTML","headerHTML","footerHTML","generateAsync","global","Blob"],"mappings":"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"}